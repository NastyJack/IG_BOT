!function(){var e,t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequired439,s=t("4FqfW"),a=(e=s())&&e.__esModule?e.default:e,n=t("2kp5t"),o=t("4pwCs"),i=t("6UyrO"),r=t("nIfN7"),l=t("7Mfds"),c=t("6DHKG"),d=t("XcRe2"),u=t("hQmIV"),h=t("6ExGy"),m=t("47HXs"),g=t("1QaVb"),p=t("5kIzC"),f=t("qnXVN"),C=t("uqDnl"),v=t("6oOtY"),b=t("6PPN4"),k=t("3YoTT"),w=t("6zDjW"),S=t("4PGYP"),_=t("Saatc"),y=t("2JplJ"),T=t("520kD"),E=t("3wQfI"),P=t("1rJgl"),A=t("2lIMO"),I=t("hUK5n"),x=t("5NrOn"),D=t("4ZA4S"),G=t("1aIyT"),F=t("1xehS"),O=t("3cqbl"),B=t("3lnaG"),U=t("lPVHz"),L=t("5SoTn"),M=t("7rAex"),R=t("3HMDR"),N=t("7b7Bi"),z=t("7xzSo"),H=t("4RYcH"),V=t("1g0wW"),W=t("23BIq"),$=t("23fUW"),q=t("2zvjG"),j=t("4NLO5"),Y=t("1X6VZ"),K=t("6vp85"),Z=t("5Y5vM"),J=t("5LHf1"),Q=t("5ZuLE"),X=t("7dHHw"),ee=t("1GjA3"),te=t("6o3Qu"),se=t("5HXaP"),ae=t("dfuZm"),ne=t("367Kq"),oe=t("2cWJK"),ie=t("6xgmF"),re=t("5zaO9"),le=t("6lSP7"),ce=t("5hlU5"),de=t("lUxTC");s(),n(),o(),i(),r(),l(),c(),d(),u(),h(),m(),g(),p(),f(),m(),C(),v(),b();class ue extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onAccountClick=()=>{v().iframeBus.send("ig.ajax-go","/inssistapp")},this._onRateYesClick=e=>{chrome.tabs.create({url:f().common.reviewsUrl}),m().gaController.sendEvent("user","rate-us:yes-click"),this._acknowledgeAndHide(e)},this._onRateNoClick=e=>{m().gaController.sendEvent("user","rate-us:no-click"),this._acknowledgeAndHide(e)},this._onOkClick=e=>{m().gaController.sendEvent("user","rate-us:ok-click"),this._acknowledgeAndHide(e)},this._onCloseClick=e=>{m().gaController.sendEvent("user","rate-us:close-click"),this._acknowledgeAndHide(e)},t}render(){return Glamor.createElement(p().default.SnackbarItem,{id:"rate-us-mediator",show:this.props.show},Glamor.createElement(p().default.RateUsStars,{texts:{subcontent:Glamor.createElement("div",null,"Found a bug? You can DM us at ",Glamor.createElement("a",{onClick:this._onAccountClick},"@inssistapp")," or email at ",Glamor.createElement("a",{href:"mailto:inssist@slashed.io"},"inssist@slashed.io")," and we will try to help.")},onRateYesClick:this._onRateYesClick,onRateNoClick:this._onRateNoClick,onOkClick:this._onOkClick,onCloseClick:this._onCloseClick}))}_acknowledgeAndHide(e){m().gaController.sendEvent("user",`rate-us:${e}-stars`),C().transaction((t=>{t.rateUs.shown=!1,t.rateUs.rate=e,t.acknowledged.rateUs=Date.now()}))}}var he=C().influx((e=>({show:e.rateUs.shown&&!b().stateProxy.isAcknowledged("rateUs")})))(ue);v(),k(),w(),C(),b();var me={init:function(){if(b().stateProxy.isAcknowledged("rateUs"))return;pe(30),v().iframeBus.on("ig.media-open",ge),v().iframeBus.on("ig.submit-post",ge),v().iframeBus.on("ig.submit-story",ge)},showRateUs:function(){pe(5)}};function ge(){pe(5)}async function pe(e){if(b().stateProxy.isAcknowledged("followUs"))return;const t=C().model.state;(Date.now()-t.installedAt)/w().DAY<e||(v().iframeBus.off("ig.media-open",ge),v().iframeBus.off("ig.submit-post",ge),v().iframeBus.off("ig.submit-story",ge),await k().default(7*w().SECOND),C().transaction((e=>{e.rateUs.shown=!0})))}S(),v(),k(),v(),m(),C();var fe={init:function(){v().iframeBus.on("ig.show-igtv-popup",Ce),v().iframeBus.on("ig.post-igtv",ve),v().iframeBus.on("ig.igtv-posted",be)},showPopup:Ce,closePopup:function(){m().gaController.sendEvent("user","igtv-upload:click-close"),C().transaction((e=>{e.igtvUpload.shown=!1}))}};function Ce(){m().gaController.sendEvent("user","igtv-upload:shown"),C().transaction((e=>{e.igtvUpload.shown=!0}))}function ve(){m().gaController.sendEvent("user","igtv-upload:click-post")}async function be(){v().iframeBus.send("ig.go-to-igtv-tab"),await k().default(1e3),C().transaction((e=>{e.igtvUpload.shown=!0}))}g(),p();var ke={createName:function(e,t){return`${e}|${JSON.stringify(t)}`},getName:we,getParams:function(){return function(e){try{return JSON.parse(e)}catch(e){return null}}(window.self.name.split("|")[1])||{}},isIframe:function(e=null){return window.self!==parent&&(!e||we()===e)}};function we(){return window.self.name.split("|")[0]||null}_(),S(),y(),T();var Se={init:async function(){S().chromeBus.on("fusion.reload-popup",(()=>{location.reload()})),S().chromeBus.send("fusion.check-new-version");const e=await y().default(chrome.tabs.getCurrent);S().chromeBus.send("fusion.popup-tab-id",e.id)},getConfig:T().default};g(),p(),S();class _e extends g().default.Component{constructor(e){super(e),this._onUpdateClick=()=>{this.setState({updating:!0}),S().chromeBus.send("fusion.update-now-click")},this.state={show:!1,updating:!1}}componentDidMount(){S().chromeBus.on("fusion.new-version-available",(()=>{this.setState({show:!0})}))}render(){return Glamor.createElement(p().default.SnackbarItem,{id:"fusion-new-version-card-mediator",show:this.state.show},Glamor.createElement(p().default.ActionCard,{image:"new-version-icon.png:40:40",content:"A new product version is available. Click the button to update and reload INSSIST.",markerColor:g().default.color.error,actions:[Glamor.createElement(g().default.LinkButton,{small:!0,label:this.state.updating?"UPDATING...":"UPDATE NOW",disabled:this.state.updating,onClick:this._onUpdateClick})]}))}}const ye={iframe:{width:"100%",height:"100%",border:"none"}};class Te extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onClose=()=>{fe.closePopup()},t}render(){const e=ke.createName("inssist-igtv",{theme:this.state.theme,fusionConfig:Se.getConfig(),isElectron:!!window.electron}),t=!1!==_().env.features.iframes?"https://www.instagram.com/tv/upload/":null;return Glamor.createElement(p().default.IgtvPopup,{onClose:this._onClose},Glamor.createElement("iframe",{css:ye.iframe,name:e,src:t}))}}var Ee=g().default.theme.ThemeAware(Te);E(),P(),A(),I(),x(),w(),_(),D(),v(),b(),m(),C(),G(),F(),p(),O(),k(),A(),B(),U(),w(),_(),C(),D(),S(),m(),G(),L();const{hasEngagementData:Pe,calcEngagement:Ae,calcRate:Ie}=p().default.tagUtils;var xe={fetchTagFromIg:Ge,fetchTagsFromRedis:Fe,fetchLadder:async function e(t){const s=e;s.cache||(s.cache={});const a=C().model.state,n=a.authStatus.userId;if(!n)return{};const o=L().default.getAccountStats(),i=Ae(o),r=A().default(`${De.apiUrl}/ladder/calculate`,{id:n,engagement:i,tags:t.join(",")});if(s.cache[r])return s.cache[r];const l=await Fe(t),c=[];for(const e of t){if(l[e])continue;const t=await Ge(e);t&&c.push(t)}_().env.is.production&&(async()=>{for(const e in l)await Ge(e)})();const d={low:[],medium:[],high:[],vhigh:[],nodata:[],relevant:[]};try{const e=await D().fetcher.fetchJson(r,{method:"POST"});d.low.push(...e.low||[]),d.medium.push(...e.medium||[]),d.high.push(...e.high||[]),d.vhigh.push(...e.vhigh||[]),d.nodata.push(...e.nodata||[])}catch(e){return console.error("failed to fetch ladder",e),d}{const e=[];for(const t of Object.values(l))e.push(t.relevantTags);for(const t of c)e.push(t.relevantTags);d.relevant=[].concat(...d.low).concat(...d.medium).concat(...d.high).concat(...d.vhigh)}for(const e in d)d[e]=d[e].map(G().decompressTag);const u=a.tagAssist.ladderConfig.tiers,h=[...Object.values(l),...c];for(const e of h){let t;if(Pe(e)){const s=Ae(e),a=Ie(s,i);t=a<u.low?d.low:a<u.medium?d.medium:a<u.high?d.high:d.vhigh}else t=d.nodata;t.find((t=>t.name===e.name))||t.push(e)}const m=new Set(t);for(const e in d){const t=d[e];if("nodata"===e){d[e]=t.sort(((e,t)=>m.has(e.name)?-1:m.has(t.name)?1:null));continue}const s={};for(const e of t){const t=e.relevantTags.slice(0,50);for(const e of t)s[e]=(s[e]||0)+1}d[e]=t.sort(((e,t)=>{if(m.has(e.name))return-1;if(m.has(t.name))return 1;const a=s[e.name],n=s[t.name];return a||n?a?n?n-a:-1:1:null}))}for(const e in d)"nodata"!==e&&(d[e]=d[e].filter(Pe));return d.relevant=d.relevant.slice(0,120).map((e=>({name:e.name}))),s.cache[r]=d,U().default("tag-assist.reset-ladder-cache",{delay:20*w().MINUTE},(()=>{delete s.cache[r]})),d}};const De=_().env.options.tagAssist;async function Ge(e){const t=Ge;t.initialized&&(t.initialized=!0,t.incognito=!0,t.lastRunOn=null);const s=Date.now();if(t.lastRunOn&&!t.incognito){const e=s-t.lastRunOn,a=2*w().SECOND;e<a&&await k().default(a-e)}t.lastRunOn=s,e=e.toLowerCase();const a=await S().chromeBus.send("ig-api.fetch-tag",e,{incognito:t.incognito});if(a.result){const e={...a.result,name:a.result.name.toLowerCase(),lastScanOn:Date.now(),relevantTags:a.result.relevantTags.map((e=>e.toLowerCase())).slice(0,De.maxRelevantTagsToKeep)};return S().chromeBus.send("tag-assist.tag-fetched-from-ig",e),e}if(t.incognito)return t.incognito=!1,Ge(e);const n=O().default((()=>JSON.stringify(a.error)),"unknown");return m().gaController.sendEvent("user","tag-assist:fetch-tag-from-ig-error",n),console.error("failed to fetch tags from ig",a.error),null}async function Fe(e){if(0===(e=B().default(e).map((e=>e.toLowerCase()))).length)return{};const t=C().model.state.authStatus.userId;if(!t)return{};let s;try{const a=A().default(De.apiUrl,{id:t,tags:e.join(",")});s=await D().fetcher.fetchJson(a,{credentials:"omit"})}catch(e){return console.error("failed to fetch tags from redis",e),{}}const a={};for(const e in s.tags){const t=G().decompressTag(`${e}:${s.tags[e]}`);t.name=t.name.toLowerCase(),t.relevantTags=t.relevantTags.map((e=>e.toLowerCase())).slice(0,De.maxRelevantTagsToKeep),a[e]=t}return Object.keys(a).forEach((e=>{Pe(a[e])||delete a[e]})),a}const Oe=I().default();var Be={init:async function(){(function(){const e=C().model.state.tagAssist.collectionsTagData;for(const t in e){const s=G().decompressTag(e[t]);F().default.tagData[t]=s}})(),async function(){const e=C().model.state,t=Date.now(),s=e.tagAssist.ladderConfig.lastUpdateOn;if(t-s<1*w().HOUR)return;const a=C().model.state.authStatus.userId;if(!a)return;let n;try{const e=A().default(`${Ue.apiUrl}/ladder/get-config`,{id:a}),t=await D().fetcher.fetchJson(e);n=t.ladderConfig||null}catch(e){console.error("failed to fetch ladder config",e)}if(!n)return;C().transaction((e=>{e.tagAssist.ladderConfig={lastUpdateOn:Date.now(),...n}}))}(),v().iframeBus.on("tag-assist.ig-creation-session-start",(()=>{C().transaction((e=>{e.tagAssist.igSelectedTags=[]}))})),Le({_captionChange_:"tag-assist.ig-caption-change",_sessionStart_:"tag-assist.ig-creation-session-start",_sessionEnd_:"tag-assist.ig-creation-session-end",_setCaption_:"tag-assist.ig-set-caption",_selectedTags_:"igSelectedTags"}),Le({_captionChange_:"tag-assist.fcs-caption-change",_sessionStart_:"tag-assist.fcs-composer-opened",_sessionEnd_:"tag-assist.fcs-composer-closed",_setCaption_:"tag-assist.fcs-set-caption",_selectedTags_:"fcsSelectedTags"}),Oe((()=>{C().transaction((e=>{for(const t in e.tagAssist.collectionsTagData){const s=F().default.tagData[t];s&&(e.tagAssist.collectionsTagData[t]=G().compressTag(s))}}))})),C().model.observe((e=>e.schedule.navigation.isOpen),(e=>{e||C().transaction((e=>{e.schedule.showTagAssist=!1}))})),await async function(){await new Promise((e=>{C().model.state.tagAssist.collections.length>0?e():v().iframeBus.on("ig.ready",(async()=>{const t=await v().iframeBus.send("tag-assist.read-collections-from-ls");C().transaction((e=>{e.tagAssist.collections=t})),e()}))}))}(),Me()},search:async function e({sendGaEvent:t=!0}={}){const s=e,a=E().generate();s.searchId=a;const n=C().model.state.tagAssist.query.trim().toLowerCase();if(C().transaction((e=>{e.tagAssist.ladderLoadingTags=[]})),!n)return void C().transaction((e=>{e.tagAssist.searching=!1,e.tagAssist.ladder=null}));t&&m().gaController.sendEvent("user","tag-assist:search-perform");const o=G().extractTags(n).slice(0,Ue.maxTagsToQuery),i=await xe.fetchLadder(o);if(s.searchId!==a)return;const r={};for(const e in i){const t=i[e];for(const e of t){!!e.lastScanOn&&(r[e.name]=e)}}Object.assign(F().default.tagData,r),Ne(),C().transaction((e=>{e.tagAssist.searching=!1,e.tagAssist.ladderLoadingTags=[],e.tagAssist.ladder={};for(const t in i){const s=i[t];e.tagAssist.ladder[t]=s.map((e=>e.name))}0===i[e.tagAssist.selectedGroupId].length&&(e.tagAssist.selectedGroupId="medium")}))},getTagData:function(){return F().default.tagData},onTagDataUpdate:Oe,registerUsage:function(){if(b().stateProxy.hasProPaid())return void m().gaController.sendEvent("user","pro-paid-usage:tag-assist");C().transaction((e=>{const t=Math.floor(Date.now()/w().DAY);e.tagAssist.lastDayUsedOn?e.tagAssist.lastDayUsedOn!==t&&(e.billing.trial.tagAssist+=1,e.tagAssist.lastDayUsedOn=t):e.tagAssist.lastDayUsedOn=t}))},selectTags:function(e,t=null){const s="sidebar"===t?"sidebarSelectedTags":"schedule"===t?"fcsSelectedTags":"igSelectedTags";C().transaction((t=>{t.tagAssist[s]=[...t.tagAssist[s],...e].filter(P().default)}))},unselectTags:function(e,t=null){const s="sidebar"===t?"sidebarSelectedTags":"schedule"===t?"fcsSelectedTags":"igSelectedTags";C().transaction((t=>{t.tagAssist[s]=t.tagAssist[s].filter((t=>!e.includes(t)))}))},toggleTag:function(e,t=null){const s="sidebar"===t?"sidebarSelectedTags":"schedule"===t?"fcsSelectedTags":"igSelectedTags";C().transaction((t=>{t.tagAssist[s].includes(e)?t.tagAssist[s]=t.tagAssist[s].filter((t=>t!==e)):t.tagAssist[s].push(e)}))},copyTags:function(e){const t=e.map((e=>`#${e}`)).join(" ");navigator.clipboard.writeText(t)},checkTags:async function e(t){const s=e,a=E().generate();s.execId=a,C().transaction((e=>{e.tagAssist.ladderLoadingTags=e.tagAssist.ladderLoadingTags.concat(t).filter((e=>!F().default.tagData[e])).filter(P().default)}));const n=await xe.fetchTagsFromRedis(t);if(Object.assign(F().default.tagData,n),Ne(),s.execId!==a)return;C().transaction((e=>{e.tagAssist.ladderLoadingTags=e.tagAssist.ladderLoadingTags.filter((e=>!F().default.tagData[e]))}));const o=async()=>{if(s.execId!==a)return;const e=C().model.state.tagAssist.ladderLoadingTags[0];if(!e)return;const t=await xe.fetchTagFromIg(e);t&&(F().default.tagData[e]=t,Ne()),C().transaction((t=>{t.tagAssist.ladderLoadingTags=t.tagAssist.ladderLoadingTags.filter((t=>t!==e))})),o()};o()},refreshTag:async function(e){C().transaction((t=>{t.tagAssist.ladderLoadingTags.push(e)})),delete F().default.tagData[e],Ne();const t=await xe.fetchTagFromIg(e);F().default.tagData[t.name]=t,Ne(),C().transaction((t=>{x().default(t.tagAssist.ladderLoadingTags,e)}))},stopTags:function(e){C().transaction((t=>{t.tagAssist.ladderLoadingTags=t.tagAssist.ladderLoadingTags.filter((t=>!e.includes(t)))}))},stopAllTags:function(){C().transaction((e=>{e.tagAssist.ladderLoadingTags=[]}))},saveCollectionsToLs:function(){const e=C().model.state.tagAssist.collections;v().iframeBus.send("tag-assist.save-collections-to-ls",e)},checkCollectionTags:Re,updateCollectionsTagData:Me};const Ue=_().env.options.tagAssist;function Le({_captionChange_:e,_sessionStart_:t,_sessionEnd_:s,_setCaption_:a,_selectedTags_:n}){let o="",i=!0;v().iframeBus.on(e,(e=>{i&&(o=e,C().transaction((e=>{e.tagAssist[n]=G().extractTags(o,!0)})))})),v().iframeBus.on(t,(()=>{let e;const t=C().model.observe((e=>e.tagAssist[n].join("-")),(async()=>{const t=C().model.state,s=G().extractTags(o,!0),r=t.tagAssist[n],l=r.filter((e=>!s.includes(e))),c=s.filter((e=>!r.includes(e)));for(const e of c)o=o.replace(new RegExp(`\\s#${e}([^\\p{L}\\d_])`,"gui"),"$1").replace(new RegExp(`^#${e}([^\\p{L}\\d_])`,"gui"),"$1").replace(new RegExp(`#${e}\\s`,"gui"),"").replace(new RegExp(`\\s#${e}$`,"gui"),"").replace(new RegExp(`#${e}$`,"gui"),"");for(const e of l)o?o+=` #${e}`:o=`#${e}`;clearTimeout(e),i=!1,await v().iframeBus.send(a,o),e=setTimeout((()=>{i=!0}))}),!1);v().iframeBus.on(s,(()=>{t&&t()}))}))}async function Me(){const e=C().model.state.tagAssist.collections.map((e=>e.tags)).flat();C().transaction((t=>{const s=Date.now(),a=t.tagAssist.collectionsTagData,n=Object.keys(a).filter((t=>{if(!e.includes(t))return!0;const n=G().decompressTag(a[t]);return s-n.lastScanOn>Ue.collectionsTagDataTtl}));for(const e of n)delete a[e]}));Re(e.filter((e=>!C().model.state.tagAssist.collectionsTagData[e])).slice(0,80))}async function Re(e,{useRedis:t=!0}={}){C().transaction((t=>{t.tagAssist.collectionsLoadingTags=t.tagAssist.collectionsLoadingTags.concat(e).filter(P().default)}));let s={};t&&(s=await xe.fetchTagsFromRedis(e),C().transaction((e=>{for(const t in s){const a=s[t];e.tagAssist.collectionsTagData[t]=G().compressTag(a)}e.tagAssist.collectionsLoadingTags=e.tagAssist.collectionsLoadingTags.filter((e=>!s[e]))}))),e=e.filter((e=>!s[e])).slice(0,30),C().transaction((t=>{t.tagAssist.collectionsLoadingTags=e}));for(const t of e){const e=await xe.fetchTagFromIg(t);C().transaction((s=>{e&&(s.tagAssist.collectionsTagData[t]=G().compressTag(e)),s.tagAssist.collectionsLoadingTags=s.tagAssist.collectionsLoadingTags.filter((e=>e!==t))}))}}function Ne(){Oe(F().default.tagData)}g(),p(),b(),m(),C(),_(),M(),C(),R(),v(),m(),u(),N();const ze={pricingRequested:!1,apiSender:new(M().Sender)({urlPrefix:_().env.options.apiUrl}),defaultCountry:"United States",statesOfAmerica:["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],fsamLink:null,fsamLinkRequestedAt:-1,init:function(){this.capturePageEvents(),this.sendGaEventsWhenPurchasing()},openBilling:function(e=null){C().transaction((t=>{t.sidebar.isOpen=!0,t.sidebar.selectedTabId="tab-billing",t.billing.navigation.isBodyOpen=!0,t.tagAssist.shown=!1,t.coverAssist.shown=!1,e&&(t.billing.recentFeature=e)}))},capturePageEvents:function(){v().iframeBus.on("fspring.close",this.closeFSpringPopup),v().iframeBus.on("fspring.subscription-success",(()=>{chrome.runtime.sendMessage({name:"fspring.subscription-success"})})),v().iframeBus.on("fspring.subscription-failure",(()=>{chrome.runtime.sendMessage({name:"fspring.subscription-failure"})}))},closeFSpringPopup:function(){C().transaction((e=>{e.billing.purchasingPlan=null}))},sendGaEventsWhenPurchasing:function(){C().model.observe((e=>e.billing.purchasingPlan),(e=>{if(!e)return;const t=C().model.state.billing.recentFeature||"none";m().gaController.sendEvent("user",`upgrade:from-${t}-${e.id}`)}))},updatePricing:async function(){var e,t,s;if(this.pricingRequested)return;const a=await R().igApi.fetchLoginActivity();let n=this.defaultCountry;if((null===(e=a.result)||void 0===e||null===(t=e.data)||void 0===t||null===(s=t.sessions)||void 0===s?void 0:s.length)>0){n=((a.result.data.sessions.find((e=>(e.location||"").split(", ").length>1))||a.result.data.sessions[0]).location||"").split(", "),n=n[n.length-1],""===!n?n=null:this.statesOfAmerica.includes(n)&&(n=this.defaultCountry)}const o="/fspring/pricing",i=n!==this.defaultCountry?`United States,${n}`:this.defaultCountry,r=Object.keys(_().env.options.billingPlans).join(","),l=await this.apiSender.send(o,{query:{countryNames:i,productIds:r}});if(l&&"ok"===l.status){this.pricingRequested=!0;const{countries:e,pricing:t}=l,s=n?e[n]:null;C().transaction((e=>{e.billing.countryIso=s,e.billing.pricing=t}))}else{const e=l.error;"TypeError"===e.name&&"Failed to fetch"===e.message||u().sentryController.sendError(`Unexpected API error at ${o}`,"error",{error:e},{actor:"auth"})}},onFsamClick:function(){let e=`https://${_().env.options.storefront}/account`;const t=Date.now();this.fsamLink=t-this.fsamLinkRequestedAt<828e5?this.fsamLink:null;(this.fsamLink?Promise.resolve():N().billingConnector.accountManagementUrl(null,C().model.state.billing.account.token).then((e=>{this.fsamLink=e.url,this.fsamLinkRequestedAt=t}))).then((()=>{this.fsamLink&&(e=`${this.fsamLink}#/subscriptions`),chrome.tabs.create({url:e,active:!0})})).catch((()=>{chrome.tabs.create({url:e,active:!0})}))}};function He(){return(He=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}g(),p(),f(),m(),C(),o(),g(),p(),C(),b(),N();let Ve=-1,We=-1;const $e=e=>null==e,qe=(e,t=null)=>null!=e?e:t;g().default.Image.registerImages({"billing-form-mediator.inssist":"inssist-mini.png:24:24"});const je={selectedPlan:{maxWidth:240,...g().default.absolute("0 0 . . 1"),...g().default.shadow.sh6,paddingTop:g().default.space.g5,paddingBottom:g().default.space.g3,backgroundColor:g().default.color.bgLight2,borderRadius:8}};class Ye extends g().default.Component{static getDerivedStateFromProps(e,t){const s=e.billing.snapshot||{},a={panel:qe(s.panel),accountScreen:qe(s.accountScreen,null),accountForm:qe(s.accountForm,{email:"",password:"",firstName:"",lastName:"",errors:{email:!1,password:!1,firstName:!1,lastName:!1}}),statusText:qe(s.statusText),statusButtons:qe(s.statusButtons),confirmationCodeText:qe(s.confirmationCodeText),confirmationCodeError:qe(s.confirmationCodeError,!1),passwordResetValue:qe(s.passwordResetValue),passwordResetCodeText:qe(s.passwordResetCodeText),passwordResetCodeError:qe(s.passwordResetCodeError,!1),loading:qe(s.loading,!1)};if(!t.isAccountFormTouched){if(e.authStatus.email&&(a.accountForm.email||(a.accountForm.email=e.authStatus.email)),e.authStatus.fullName){const t=e.authStatus.fullName.split(" "),s=t.shift(),n=t.join(" ");!a.accountForm.firstName&&s&&(a.accountForm.firstName=s),!a.accountForm.lastName&&n&&(a.accountForm.lastName=n)}a.accountForm.password=""}return a}constructor(e){super(e),Ke.call(this),this.state={}}render(){return Glamor.createElement(p().default.BillingForm,{disabled:this.state.loading},this.renderContent())}renderContent(){const{email:e}=this.props.billing.account,{accountScreen:t,accountForm:s,confirmationCodeText:a,passwordResetValue:n,passwordResetCodeText:o}=this.state;if("auth"===t)return Glamor.createElement(g().default.Fragment,null,Glamor.createElement(p().default.BillingFSpringAuthSection,He({},s,{onChange:this._onAccountFormChange,onCancelClick:this._onGoToStorefrontClick,onNextClick:this._onNextClick,disableInputs:!$e(a),hideActions:!$e(a)})),this._renderCodeSection(),this._renderStatusSection(),this._renderSelectedPlanSection());if("login"===t)return Glamor.createElement(g().default.Fragment,null,Glamor.createElement(p().default.BillingFSpringLoginSection,He({},s,{onChange:this._onAccountFormChange,onCancelClick:this._onGoToStorefrontClick,onIForgotPasswordClick:this._onIForgotPasswordClick,onLoginClick:this._onLoginClick,disableInputs:!$e(a),hideActions:!$e(a)})),this._renderCodeSection(),this._renderStatusSection(),this._renderSelectedPlanSection());if("create-account"===t)return Glamor.createElement(g().default.Fragment,null,Glamor.createElement(p().default.BillingFSpringCreateAccountSection,He({},s,{onChange:this._onAccountFormChange,onCancelClick:this._onGoToStorefrontClick,onCreateAccountClick:this._onCreateAccountClick,disableInputs:!$e(a),hideActions:!$e(a)})),this._renderCodeSection(),this._renderStatusSection(),this._renderSelectedPlanSection());if("reset"===t){const e=!$e(o);return Glamor.createElement(g().default.Fragment,null,Glamor.createElement(p().default.BillingFSpringResetSection,He({},s,{newPassword:n,onNewPasswordChange:!e&&this._onNewPasswordChange,onResetPasswordClick:!e&&this._onResetPasswordClick})),this._renderResetCodeSection(),this._renderStatusSection())}return"reset-confirm"===t?Glamor.createElement(p().default.BillingFSpringResetConfirmSection,{onOkClick:this._onResetPasswordAcknowledgeClick}):"logout-confirm"===t?Glamor.createElement(p().default.BillingFSpringLogoutConfirmSection,{onOkClick:this._onLogoutAcknowledgeClick}):"delete-confirm"===t?Glamor.createElement(p().default.BillingFSpringDeleteConfirmSection,{onOkClick:this._onDeleteAcknowledgeClick}):"manage-account"===t?Glamor.createElement(p().default.BillingFSpringManageAccountSection,He({email:e},this._subscriptions(),{onDeleteClick:this._onDeleteClick,onDeleteCancelClick:this._onDeleteCancelClick})):"delete"===t?Glamor.createElement(p().default.BillingFSpringManageAccountSection,He({email:e},this._subscriptions(),{onDeleteConfirmClick:this._onDeleteConfirmClick,onDeleteCancelClick:this._onDeleteCancelClick})):null}_renderCodeSection(){const{accountScreen:e,accountForm:t,confirmationCodeText:s,confirmationCodeError:a}=this.state;if($e(s))return null;let n=null;const{firstName:o,lastName:i,email:r}=t;"create-account"===e&&o&&i&&(n=g().default.emailTypoChecker.check({firstName:o,lastName:i,email:r}));const l=Glamor.createElement("p",null,"Please confirm your email address by entering a code we sent to you from ",Glamor.createElement("strong",null,"no-reply@inssist.com"),"."),c=n?Glamor.createElement("div",{css:g().default.row},Glamor.createElement("div",{style:{fontSize:21}},"🧐"),Glamor.createElement(g().default.Spacer,{width:"g0h"}),Glamor.createElement("div",{css:g().default.column},Glamor.createElement("p",null,"The email address you entered appears to have a typo. Did you mean to enter ",Glamor.createElement("strong",null,n)," email address instead?"),Glamor.createElement(g().default.Spacer,{height:"g0h"}),Glamor.createElement("div",null,"If you made a typo, simply click Cancel."),Glamor.createElement(g().default.Spacer,{height:"g0h"}))):Glamor.createElement("p",null,"If you have not received a code, please check the spam folder, email address or send a new code.");return Glamor.createElement(g().default.Fragment,null,Glamor.createElement(g().default.Spacer,{height:"g3"}),Glamor.createElement(p().default.BillingCodeSection,{value:s,text:Glamor.createElement(g().default.Fragment,null,l,Glamor.createElement(g().default.Spacer,{height:"g1"}),c),hasError:a,onChange:this._onConfirmationCodeChange}),Glamor.createElement(g().default.Spacer,{height:"g3"}),Glamor.createElement("div",{css:g().default.row},Glamor.createElement(g().default.ActionButton,{label:"CONFIRM EMAIL",shadow:g().default.color.linkShadow,onClick:this._onConfirmEmailClick}),Glamor.createElement(g().default.Spacer,{width:"g3"}),Glamor.createElement(g().default.LinkButton,{label:"CANCEL",cancel:!0,onClick:this._onCancelConfirmEmailClick})))}_renderResetCodeSection(){const{passwordResetCodeText:e,passwordResetCodeError:t}=this.state;return $e(e)?null:Glamor.createElement(g().default.Fragment,null,Glamor.createElement(p().default.BillingCodeSection,{value:e,text:"We’ve sent a verification code to your email address. Please enter it below:",hasError:t,onChange:this._onPasswordResetCodeChange}),Glamor.createElement(g().default.Spacer,{height:"g3"}),Glamor.createElement("div",{css:g().default.row},Glamor.createElement(g().default.ActionButton,{label:"CONFIRM RESET",shadow:g().default.color.linkShadow,onClick:this._onConfirmPasswordResetClick}),Glamor.createElement(g().default.Spacer,{width:"g3"}),Glamor.createElement(g().default.LinkButton,{label:"CANCEL",cancel:!0,onClick:this._onCancelPasswordResetClick})),Glamor.createElement(g().default.Spacer,{height:"g3"}))}_renderSelectedPlanSection(){const{selectedPlan:e}=this.props.billing;if(!e)return null;const t=this.props.authStatus.username,s="inssist-pro-monthly"===e.id?["Best for Casual use","Unlimited accounts","Paid monthly, cancel any time"]:"inssist-pro-lifetime"===e.id?["Best for Creatives",Glamor.createElement("div",null,"Activates for this account, ",Glamor.createElement("strong",null,"@",t)),"Paid once"]:"inssist-pro-infinite"===e.id?["Best for Businesses","Unlimited accounts","Paid once"]:null;return Glamor.createElement("div",{css:[g().default.column,je.selectedPlan]},Glamor.createElement(p().default.BillingPlanRenderer,He({},e,{benefits:s,padding:g().default.padding("0 20 0 50"),onChangePlanClick:this._onChangePlanClick})))}_renderStatusSection(){const{statusText:e}=this.state;if(!$e(e))return Glamor.createElement(g().default.Fragment,null,Glamor.createElement(g().default.Spacer,{height:"g3"}),Glamor.createElement(p().default.BillingStatusSection,{text:e,buttons:this._enrichStatusButtons()}))}_subscriptions(){const{subscriptions:e}=this.props.billing;if(!e)return null;const t=[];return e["inssist-pro-monthly"]&&"active"===e["inssist-pro-monthly"].state&&t.push({label:"INSSIST PRO",icon:"billing-form-mediator.inssist"}),0===t.length?null:{subscriptions:t,onFsamClick:this._onFsamClick}}_showVerificationCodeSnackbar(e){setTimeout((()=>C().transaction((t=>{t.billing.verificationCodeEmail=e}))),1500)}_hideVerificationCodeSnackbar(){setTimeout((()=>C().transaction((e=>{e.billing.verificationCodeEmail=null}))),1500)}_enrichStatusButtons(){return this.state.statusButtons&&0!==this.state.statusButtons.length?this.state.statusButtons.map((e=>{const t={...e};return"CREATE NEW ACCOUNT"===e.label&&(t.onClick=this._onGoToCreateAccountScreen),"SEND A NEW CODE"===e.label&&(t.onClick=this._onResendCodeClick),"I FORGOT MY PASSWORD"===e.label&&(t.onClick=this._onIForgotPasswordClick),"LOGIN INSTEAD"===e.label&&(t.onClick=this._onGoToLoginScreen),t})):null}_reset(e,t){t=t||{form:!0,errors:!0,status:!0,code:!0,password:!0,loading:!0};const{form:s,errors:a,status:n,code:o,password:i,loading:r}=t;s&&(this.setState({isAccountFormTouched:!1}),e.accountForm.email="",e.accountForm.password="",e.accountForm.firstName="",e.accountForm.lastName=""),a&&(e.accountForm.errors.email=!1,e.accountForm.errors.password=!1,e.accountForm.errors.firstName=!1,e.accountForm.errors.lastName=!1),n&&(e.statusText=null,e.statusButtons=null),o&&(e.confirmationCodeText=null,e.confirmationCodeError=!1),i&&(e.passwordResetValue=null,e.passwordResetCodeText=null,e.passwordResetCodeError=!1),r&&(e.loading=!1)}getSnapshot(){return o().default.cloneDeep(this.state)}applySnapshot(e){this.setState(e),C().transaction((t=>{t.billing.snapshot=e}))}updateSnapshot(e){const t=this.getSnapshot(),s=e(t);return this.applySnapshot(t),s}}var Ke=function(){this._onFsamClick=()=>{ze.onFsamClick()},this._onChangePlanClick=()=>{C().transaction((e=>{e.billing.selectedPlan=null,e.billing.snapshot.panel="storefront",e.billing.snapshot.accountScreen=null}))},this._onLogoutAcknowledgeClick=()=>{this.updateSnapshot((e=>{e.panel="storefront",e.accountScreen=null}))},this._onDeleteClick=()=>{this.updateSnapshot((e=>{e.accountScreen="delete"}))},this._onCancelClick=()=>{this.updateSnapshot((e=>{e.panel="storefront",e.accountScreen=null}))},this._onDeleteConfirmClick=()=>{N().billingConnector.deleteAccount(this,this.props.billing.account.token).then((()=>{this.updateSnapshot((e=>{this._reset(e,{status:!0,form:!0,code:!0,password:!0}),e.accountScreen="delete-confirm"})),C().transaction((e=>{e.billing.account={email:null,token:null}}))})).catch((e=>{this.updateSnapshot((t=>{"unauthorized"===e.status&&(this._reset(t,{form:!0,status:!0,code:!0,password:!0,loading:!0}),t.accountScreen=null,t.statusButtons=null,t.statusText="Oops... Your session has expired, please log back in to delete your account.",C().transaction((e=>{e.billing.account={email:null,token:null},e.billing.snapshot=t})))}))}))},this._onDeleteAcknowledgeClick=()=>{this.updateSnapshot((e=>{e.panel="storefront",e.accountScreen=null}))},this._onDeleteCancelClick=()=>{this.updateSnapshot((e=>{e.panel="storefront",e.accountScreen=null}))},this._onAccountFormChange=e=>{this.setState({isAccountFormTouched:!0}),this.updateSnapshot((t=>{this._reset(t,{status:!0,code:!0,loading:!0}),e.email!==t.accountForm.email&&(t.accountForm.email=e.email,t.accountForm.errors.email=!1),e.firstName!==t.accountForm.firstName&&(t.accountForm.firstName=e.firstName,t.accountForm.errors.firstName=!1),e.lastName!==t.accountForm.lastName&&(t.accountForm.lastName=e.lastName,t.accountForm.errors.lastName=!1),e.password!==t.accountForm.password&&(t.accountForm.password=e.password,t.accountForm.errors.password=!1)}))},this._onGoToStorefrontClick=()=>{this.updateSnapshot((e=>{this._reset(e,{status:!0,form:!0,errors:!0,code:!0,loading:!0}),e.panel="storefront"}))},this._onIForgotPasswordClick=()=>{this.updateSnapshot((e=>{this._reset(e,{status:!0,errors:!0,code:!0,loading:!0}),e.accountScreen="reset",e.passwordResetValue="",e.passwordResetCodeText=null}))},this._onGoToCreateAccountScreen=()=>{this.updateSnapshot((e=>{this._reset(e,{status:!0,errors:!0,code:!0,loading:!0}),e.accountScreen="create-account"}))},this._onGoToLoginScreen=()=>{this.updateSnapshot((e=>{this._reset(e,{status:!0,errors:!0,code:!0,loading:!0}),e.accountScreen="login"}))},this._onNextClick=()=>{const{email:e}=this.state.accountForm;this.updateSnapshot((t=>(t.accountForm.errors={email:e.length<1,password:!1},t.accountForm.errors.email?(t.statusText="Email is required to store your purchases and reuse them across multiple devices.",!0):(t.statusText=null,!1))))||N().billingConnector.isTaken(this,e).then((e=>{e.taken?C().transaction((e=>{e.billing.snapshot.accountScreen="login"})):C().transaction((e=>{e.billing.snapshot.accountScreen="create-account"}))})).catch((e=>{console.log(e),this.updateSnapshot((t=>{"bad-query"===e.status&&(t.accountForm.errors.email=!0)}))}))},this._onLoginClick=()=>{const{email:e,password:t}=this.state.accountForm;this.updateSnapshot((s=>(s.accountForm.errors={email:e.length<1,password:t.length<4},s.accountForm.errors.email||s.accountForm.errors.password?(s.statusText="Email and password required to sign in to Inssist account. If you do not have an Inssist account, create one instead.",!0):(s.statusText=null,!1))))||N().billingConnector.login(this,e,t).then((t=>{this.updateSnapshot((e=>{this._reset(e,{status:!0,form:!0,code:!0,password:!0}),"reset"===e.accountScreen?e.accountScreen="reset-confirm":e.panel="storefront"})),C().transaction((s=>{s.billing.account={email:e,token:t.token},s.billing.selectedPlan&&(s.billing.purchasingPlan=s.billing.selectedPlan,s.billing.selectedPlan=null)}))})).catch((e=>{this.updateSnapshot((t=>{"bad-query"===e.status?t.accountForm.errors.email=!0:"email-is-not-verified"===e.status&&(t.confirmationCodeText="")}))}))},this._onCreateAccountClick=()=>{const{email:e,password:t,firstName:s,lastName:a}=this.state.accountForm;if(this.updateSnapshot((n=>(n.accountForm.errors={},e.length<1&&(n.accountForm.errors.email=!0),t.length<4&&(n.accountForm.errors.password=!0),s.length<1&&(n.accountForm.errors.firstName=!0),a.length<1&&(n.accountForm.errors.lastName=!0),n.confirmationCodeText=null,n.statusText=n.accountForm.errors.email||n.accountForm.errors.password||n.accountForm.errors.firstName||n.accountForm.errors.lastName?"Please fill in remaining fields to create an Inssist account. First Name and Last Name are required by FastSpring.":null,Boolean(n.statusText)))))return;const n=b().stateProxy.allUsernames();N().billingConnector.register(this,e,t,s,a,n).then((()=>{this._showVerificationCodeSnackbar(e),C().transaction((e=>{e.billing.recordedUsernames=(e=>Array.from(new Set(e)))([...e.billing.recordedUsernames,...n])})),this.updateSnapshot((e=>{this._reset(e,{status:!0,code:!0}),e.confirmationCodeText=""})),C().transaction((t=>{t.billing.account={email:e}}))})).catch((e=>{this.updateSnapshot((t=>{("bad-query"===e.status||"email-already-in-use"===e.status)&&(t.accountForm.errors.email=!0)}))}))},this._onConfirmEmailClick=()=>{if(this.updateSnapshot((e=>{const{confirmationCodeText:t}=e;return 0===t.length||5!==t.length?(e.confirmationCodeError=!0,e.statusText="Verification code does not match our records. Please check your inbox for the code we sent.",e.statusButtons=[{label:"SEND A NEW CODE"}],!0):(this._reset(e,{status:!0}),!1)})))return;const e=this.state.accountForm.email,t=this.state.confirmationCodeText;N().billingConnector.verifyEmail(this,e,t).then((()=>{this._hideVerificationCodeSnackbar(),this._onLoginClick()})).catch((e=>{this.updateSnapshot((t=>{"bad-query"===e.status?t.accountForm.errors.email=!0:"account-not-found"===e.status?(t.statusButtons=null,t.statusText="No account found for the given email address. Please correct email address or create a new account instead."):"email-already-verified"===e.status?(t.confirmationCodeText=null,t.statusText="This email address has been verified. Please login instead."):"otp-does-not-match"===e.status&&(t.confirmationCodeError=!0,t.statusButtons=[{label:"SEND A NEW CODE"}])}))}))},this._onResendCodeClick=()=>{const{email:e,password:t}=this.state.accountForm;this.updateSnapshot((e=>{this._reset(e,{status:!0,code:!0,loading:!0}),e.confirmationCodeText="";const t=Date.now();return Math.round((Ve+3e4-t)/1e3)>0&&(e.statusText="The last code was sent less than a minute ago. Please wait some time before requesting a new one.",e.statusButtons=[{label:"SEND A NEW CODE"}],!0)}))||(Ve=Date.now(),N().billingConnector.resendOtp(this,e,t).then((()=>{this._showVerificationCodeSnackbar(e),this.updateSnapshot((e=>{e.statusText="We sent you a new email verification code. Please check your inbox for messages from no-reply@inssist.com.",e.statusButtons=[{label:"SEND A NEW CODE"}]}))})).catch((e=>{this.updateSnapshot((t=>{"account-not-found"===e.status?t.statusText="No account found for the given email address. Please update email address or create a new account instead.":"account-is-not-active"===e.status?t.statusText="This account has been disabled. Please create a new account instead.":"email-already-verified"===e.status&&(t.confirmationCodeText=null,t.statusText="This email address has already been verified. Please login instead.")}))})))},this._onResetPasswordClick=e=>{if(!e)return void this.updateSnapshot((e=>{this._reset(e,{status:!0,code:!0,loading:!0,password:!0}),e.panel="storefront",e.accountScreen=null}));if(this.updateSnapshot((e=>{this._reset(e,{status:!0,code:!0});const t=Date.now();return Math.round((We+3e4-t)/1e3)>0&&(e.statusText="The last code was sent less than a minute ago. Please wait some time before requesting a new one.",this.applySnapshot(e),!0)})))return;const t=this.state.accountForm.email;We=Date.now(),N().billingConnector.recoverPassword(this,t).then((()=>{this._showVerificationCodeSnackbar(t),this.updateSnapshot((e=>{e.passwordResetCodeText=""}))})).catch((e=>{this.updateSnapshot((t=>{"account-not-found"===e.status&&(t.statusButtons=null,t.statusText="No account found for the given email address. Please correct email address or create a new account instead.")}))}))},this._onConfirmPasswordResetClick=()=>{if(this.updateSnapshot((e=>{const{passwordResetCodeText:t}=e;return 0===t.length||5!==t.length?(e.passwordResetCodeError=!0,e.statusText="Verification code does not match our records. Please check your inbox for the code we sent.",!0):(this._reset(e,{status:!0}),!1)})))return;const e=this.state.accountForm.email,t=this.state.passwordResetCodeText,s=this.state.passwordResetValue;N().billingConnector.changePassword(this,e,t,s).then((()=>{this._hideVerificationCodeSnackbar(),this.setState({isAccountFormTouched:!0}),this.updateSnapshot((e=>{e.accountForm.password=s})),this._onLoginClick()})).catch((e=>{this.updateSnapshot((t=>{"bad-query"===e.status?t.accountForm.errors.email=!0:"account-not-found"===e.status?(t.statusButtons=null,t.statusText="No account found for the given email address. Please correct email address or create a new account instead."):"account-is-not-active"===e.status&&(t.statusText="This account has been disabled. Please create a new account instead.")}))}))},this._onConfirmationCodeChange=e=>{this.updateSnapshot((t=>{this._reset(t,{status:!0,loading:!0}),t.confirmationCodeText=e,t.confirmationCodeError=!1}))},this._onCancelConfirmEmailClick=()=>{this._hideVerificationCodeSnackbar(),this.updateSnapshot((e=>{this._reset(e,{status:!0,code:!0,loading:!0})}))},this._onPasswordResetCodeChange=e=>{this.updateSnapshot((t=>{this._reset(t,{status:!0,loading:!0}),t.passwordResetCodeText=e,t.passwordResetCodeError=!1}))},this._onNewPasswordChange=e=>{this.updateSnapshot((t=>{this._reset(t,{status:!0,code:!0,loading:!0}),t.passwordResetValue=e,t.passwordResetCodeText=null}))},this._onCancelPasswordResetClick=()=>{this._hideVerificationCodeSnackbar(),this.updateSnapshot((e=>{this._reset(e,{status:!0,code:!0,password:!0,loading:!0}),e.panel="storefront",e.accountScreen=null}))},this._onResetPasswordAcknowledgeClick=()=>{this.updateSnapshot((e=>{this._reset(e,{status:!0,code:!0,password:!0,loading:!0}),e.panel="storefront",e.accountScreen=null}))}},Ze=C().influx((e=>({billing:e.billing,authStatus:e.authStatus,hasPro:b().stateProxy.hasPro(),hasProPaid:b().stateProxy.hasProPaid(),hasProPromocode:b().stateProxy.hasProPromocode()})))(Ye);g(),b(),C();const Je={root:{...g().default.padding("g1h 0 0 0"),borderTop:g().default.border.dark},title:{...g().default.text.bleakSemiBold,maxWidth:120,minWidth:120,opacity:.6,textAlign:"right",marginRight:g().default.space.g5},stat:{minWidth:100,paddingRight:g().default.space.g3},statValue:{fontFamily:"var(--font-primary)",fontSize:"24px",fontWeight:"500",lineHeight:"28px",color:"var(--color-primary)"},statLabel:{...g().default.text.bleak,fontSize:10}};class Qe extends g().default.Component{constructor(e){super(e),this.mounted=!1}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const{dmsSent:e,postsPublished:t,postsScheduled:s,insightsCreated:a}=this.props,{nFollowers:n,uFollowers:o}=this.state;return e||t||s||a||n||o?Glamor.createElement("div",{css:[g().default.row,Je.root]},Glamor.createElement("div",{css:Je.title},"Some of your stats with Inssist:"),this._renderStat("DMs Sent",e),this._renderStat("Published Posts",t),this._renderStat("Scheduled Posts",s),this._renderStat("Insights",a),this._renderStat("Unfollowers",o),this._renderStat("New Followers",n,"+")):null}_renderStat(e,t,s){return t?Glamor.createElement("div",{css:[g().default.column,Je.stat]},Glamor.createElement("div",{css:Je.statValue},s,t||0),Glamor.createElement("div",{css:Je.statLabel},e)):null}}var Xe=C().influx((e=>({hasPro:b().stateProxy.hasPro(),userId:e.authStatus.userId,dmsSent:e.billing.trial.dmsSent,postsPublished:e.billing.trial.postsPublished+e.billing.trial.storiesPublished,insightsCreated:e.billing.trial.insights||0,postsScheduled:e.billing.trial.schedule||0})))(Qe);g(),p(),z(),C(),_(),b(),m();const et={fsamLink:g().default.clickable};class tt extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onLoginClick=()=>{C().transaction((e=>{e.billing.snapshot.panel="form",e.billing.snapshot.accountScreen="login"}))},this._onLogoutClick=()=>{C().transaction((e=>{e.billing.snapshot.panel="form",e.billing.snapshot.accountScreen="logout-confirm",e.billing.account.email=null,e.billing.account.token=null}))},this._onManageAccountClick=()=>{C().transaction((e=>{e.billing.snapshot.panel="form",e.billing.snapshot.accountScreen="manage-account"}))},this._onFsamClick=()=>{ze.onFsamClick()},this._onActionClick=e=>{m().gaController.sendEvent("user",`billing:storefront-plan-click-${e.id}`),chrome.runtime.sendMessage({name:"update-fspring-status"},(()=>{setTimeout((()=>{var t,s;const{billing:a}=this.props;"active"===(null===(t=a.subscriptions)||void 0===t||null===(s=t["inssist-pro-monthly"])||void 0===s?void 0:s.state)||b().stateProxy.hasProPaid("inssist-pro-infinite")||"inssist-pro-lifetime"===e.id&&b().stateProxy.hasProPaid("inssist-pro-lifetime")||this._kickOffPurchaseFlow(e)}),250)}))},this._kickOffPurchaseFlow=e=>{var t;(null===(t=this.props.billing.purchasingPlan)||void 0===t?void 0:t.id)===e.id?C().transaction((e=>{e.billing.purchasingPlan=null})):b().stateProxy.isLoggedIn()?C().transaction((t=>{t.billing.purchasingPlan={id:e.id}})):C().transaction((t=>{t.billing.selectedPlan={id:e.id,type:e.type,icon:e.icon,label:e.label,period:e.period,price:e.price},t.billing.snapshot.panel="form",t.billing.snapshot.accountScreen="auth"}))},t}componentDidMount(){this._updatePricing()}async _updatePricing(){ze.updatePricing()}render(){const e=this._constructPlans(),t=this._constructStatus(),s=this._constructCurrencies(),a=this._constructActions();return Glamor.createElement(p().default.BillingStorefront,{title:this._renderTitle(),plans:e,status:t,currencies:s,onCurrencyChange:this._onCurrencyChange,actions:a})}_renderTitle(){return Glamor.createElement("div",null,"Unlock all features with a ",Glamor.createElement("strong",null,"PRO Subscription")," or a ",Glamor.createElement("strong",null,"Life-Time Deal"),Glamor.createElement("br",null))}_constructStatus(){const{hasProPromocode:e,hasProPaid:t,authStatus:s}=this.props;if(e){return{title:"PROMOCODE ACTIVATED",text:`A promocode has been activated for your Instagram @${(null==s?void 0:s.username)||"account"} 🤗. Enjoy all features!`,ok:!0}}return t?{title:"PRO ACTIVATED 🏅",text:Glamor.createElement("div",null,"All advanced features unlocked! You can manage your orders at ",Glamor.createElement("a",{style:et.fsamLink,onClick:this._onFsamClick},"FastSpring Account Portal")),ok:!0}:null}_constructCurrencies(){const{billing:e}=this.props;if(!e.countryIso||"US"===e.countryIso)return null;const t="default"===e.snapshot.checkoutCurrency?"US":this.props.billing.countryIso;return"US"!==t&&"USD"===this._getPriceCurrency("inssist-pro-monthly",t)&&this._getPriceValue("inssist-pro-monthly",t)>this._getPriceValue("inssist-pro-monthly","US")&&"USD"===this._getPriceCurrency("inssist-pro-lifetime",t)&&this._getPriceValue("inssist-pro-lifetime",t)>this._getPriceValue("inssist-pro-lifetime","US")&&"USD"===this._getPriceCurrency("inssist-pro-infinite",t)&&this._getPriceValue("inssist-pro-infinite",t)>this._getPriceValue("inssist-pro-infinite","US")?null:[{label:"Pay in: Local Currency",selected:"US"!==t,checkoutCurrency:"local",countryIso:t},{label:"Pay in: USD",selected:"US"===t,checkoutCurrency:"default",countryIso:t}]}_onCurrencyChange(e){C().transaction((t=>{t.billing.snapshot.checkoutCurrency=e.checkoutCurrency}))}_constructActions(){const{billing:e}=this.props;return e.account.token?{content:e.account.email?Glamor.createElement("div",null,Glamor.createElement("strong",null,e.account.email)):Glamor.createElement("div",null,"You are signed in to Inssist"),buttons:[{label:"MANAGE ACCOUNT",onClick:this._onManageAccountClick},{label:"LOGOUT",onClick:this._onLogoutClick}],color:g().default.color.positive}:{content:Glamor.createElement("div",null,"Already have an account?"),buttons:[{label:"LOGIN TO RECOVER PRO",onClick:this._onLoginClick}],color:g().default.color.iconPassive}}_getPrice(e,t){const{billing:s}=this.props;if(!e)return null;t||(t="US");const a=(e,t,s)=>e&&e[t]?e[t][s]?{...e[t][s],countryIso:s}:e[t].pricing&&e[t].pricing[s]?{...e[t].pricing[s],countryIso:s}:null:null;return(e=>{if(!e)return null;const t=z().utils.getIntegralNumberPart(e.price),s=100*z().utils.getFractalNumberPart(e.price);return{currency:e.currency,integral:t,fractal:0===s?null:s}})(a(s.pricing,e,t)||a(s.pricing,e,"US")||a(_().env.options.billingPlans,e,t)||a(_().env.options.billingPlans,e,"US"))}_getPriceValue(e,t){const s=this._getPrice(e,t);return s?s.integral+s.fractal/100:null}_getPriceCurrency(e,t){const s=this._getPrice(e,t);return s?s.currency:null}_constructPlans(){var e,t,s,a,n;const{billing:o,authStatus:i}=this.props,r="default"===o.snapshot.checkoutCurrency?"US":o.countryIso,l=b().stateProxy.hasProPaid("inssist-pro-monthly"),c=b().stateProxy.hasProPaid("inssist-pro-lifetime"),d=b().stateProxy.hasProPaid("inssist-pro-infinite"),u="active"===(null===(e=o.subscriptions)||void 0===e||null===(t=e["inssist-pro-monthly"])||void 0===t?void 0:t.state),h=i.username;return[{id:"inssist-pro-monthly",type:"subscription",price:this._getPrice("inssist-pro-monthly",r),period:"/ month",isSelected:l,icon:{name:"billing-storefront.sub"},label:"MONTHLY",benefits:["Best for Casual use","Unlimited accounts",Glamor.createElement("span",null,"Paid monthly,",Glamor.createElement("br",null),"cancel any time")],action:{label:l?u?"SUBSCRIBED":"CANCELED":"SUBSCRIBE",disabled:l||d,progress:"inssist-pro-monthly"===(null===(s=o.purchasingPlan)||void 0===s?void 0:s.id),tooltip:l&&!u?"You have canceled PRO subscription and it will deactivate automatically at the end of the billing period.":null,onClick:this._onActionClick},disabled:!1},{id:"inssist-pro-lifetime",type:"product-username",price:this._getPrice("inssist-pro-lifetime",r),period:"/ account",badge:"POPULAR",isSelected:c,icon:{name:"billing-storefront.person"},label:"LIFETIME",benefits:["Best for Creatives",Glamor.createElement("div",{css:g().default.relative()},Glamor.createElement("div",{css:g().default.absolute("1 . . -20")},Glamor.createElement(g().default.InfoCircle,{mini:!0,tooltip:{text:["Lifetime plan is purchased once per Instagram account and will remain active for that Instagram account. It can not be transferred or reused with a different Instagram account.","If you rename your Instagram account, the Lifetime plan will switch to the new name automatically.","If you'd like to activate Lifetime plan for a different Instagram account, please switch over to that account in Inssist or Instagram before making the purchase."]}})),"Activates for this account, ",Glamor.createElement("strong",null,"@",h)),"Paid once"],action:{label:c?"PURCHASED":"PURCHASE",disabled:c||d||u,progress:"inssist-pro-lifetime"===(null===(a=o.purchasingPlan)||void 0===a?void 0:a.id),tooltip:u?"Please cancel MONTHLY subscription before purchasing LIFETIME plan.":null,onClick:this._onActionClick},disabled:!h},{id:"inssist-pro-infinite",type:"product",price:this._getPrice("inssist-pro-infinite",r),isUnlimited:!0,isSelected:d,icon:{name:"billing-storefront.ouroboros"},label:"INFINITE",benefits:["Best for Businesses","Unlimited accounts","Paid once"],action:{label:d?"PURCHASED":"PURCHASE",disabled:d||u,progress:"inssist-pro-infinite"===(null===(n=o.purchasingPlan)||void 0===n?void 0:n.id),tooltip:u?"Please cancel MONTHLY subscription before purchasing INFINITE plan.":null,onClick:this._onActionClick},disabled:!1}]}}var st=C().influx((e=>({billing:e.billing,authStatus:e.authStatus,hasProPromocode:b().stateProxy.hasProPromocode(),hasProPaid:b().stateProxy.hasProPaid()})))(tt);g(),p(),_();class at extends g().default.Component{render(){const e=_().env.options.billingProFeaturesTable;return Glamor.createElement(p().default.BillingFeaturesTable,{features:e})}}g(),C(),_(),b();const nt={permissionPrompt:{...g().default.absolute("0 0 0 0 1"),...g().default.column,...g().default.justifyContent.center,...g().default.alignItems.center,...g().default.noDataGradient},permissionText:{...g().default.column,...g().default.alignItems.center,maxWidth:300,backgroundColor:g().default.color.bgLight1,border:g().default.border.light,textAlign:"center",...g().default.borderRadius.r4,...g().default.padding("g3 g3 g3 g3")},fsForm:e=>({...g().default.absolute("0 0 0 0 1"),...g().default.transition.slow,opacity:e.loaded?1:0})};g().default.SvgIcon.registerSvgIcons(['<symbol id="billing-checkout-mediator.unlock" viewBox="0 0 50 49.999"><g transform="translate(0 -0.003)"><g transform="translate(41.21 11.82)"><path d="M430.624,121.817a1.468,1.468,0,0,0-1.966-.655l-5.859,2.93a1.465,1.465,0,1,0,1.31,2.621l5.859-2.93A1.465,1.465,0,0,0,430.624,121.817Z" transform="translate(-421.989 -121.008)" fill="#74be86"/></g><g transform="translate(41.21 26.467)"><path d="M429.969,274.082l-5.859-2.93a1.465,1.465,0,0,0-1.31,2.621l5.859,2.93a1.465,1.465,0,0,0,1.31-2.621Z" transform="translate(-421.989 -270.997)" fill="#74be86"/></g><g transform="translate(0 0.003)"><path d="M33.691,23.636H11.719V16.116a7.324,7.324,0,0,1,14.648,0v2.93a1.464,1.464,0,0,0,1.465,1.465h5.859a1.464,1.464,0,0,0,1.465-1.465v-2.93a16.113,16.113,0,1,0-32.226,0v7.789A4.388,4.388,0,0,0,0,28.03V45.608A4.4,4.4,0,0,0,4.394,50h29.3a4.4,4.4,0,0,0,4.394-4.394V28.03A4.4,4.4,0,0,0,33.691,23.636ZM20.508,38.014v4.664a1.465,1.465,0,1,1-2.93,0V38.014a4.394,4.394,0,1,1,2.93,0Z" transform="translate(0 -0.003)" fill="#74be86"/></g><g transform="translate(41.21 20.608)"><path d="M429.319,211H423.46a1.465,1.465,0,0,0,0,2.93h5.859a1.465,1.465,0,0,0,0-2.93Z" transform="translate(-421.995 -211)" fill="#74be86"/></g></g></symbol>']);class ot extends g().default.Component{constructor(e){super(e),this._onLoad=()=>{this.setState({loaded:!0})},this._onCloseClick=()=>{C().transaction((e=>{e.billing.purchasingPlan=null}))},this.state={granted:null}}render(){const{purchasingPlan:e}=this.props.billing;if(!e)return null;if(null===this.state.granted)return chrome.permissions.contains({origins:["*://*.onfastspring.com/*"]},(e=>{this.setState({granted:e})})),null;if(!this.state.granted)return chrome.permissions.request({origins:["*://*.onfastspring.com/*"]},(e=>{e?this.setState({granted:!0}):C().transaction((e=>{e.billing.purchasingPlan=null}))})),Glamor.createElement("div",{css:nt.permissionPrompt},Glamor.createElement("div",{css:nt.permissionText},Glamor.createElement(g().default.SvgIcon,{name:"billing-checkout-mediator.unlock"}),Glamor.createElement(g().default.Spacer,{height:"g3"}),Glamor.createElement("div",null,"INSSIST needs your permission to launch a secure billing form powered by FastSpring.")));const t=_().env.options.checkoutContainer,s=this._fetchFSpringConfig(),a=`${t}/fspring/${this.state.theme}?config=${s}`;Glamor.createElement("iframe",{src:a,style:{border:"none",width:"100%",height:"100%"},className:"dnd-immune",onLoad:this._onLoad});return Glamor.createElement("div",{css:nt.fsForm(this.state)},Glamor.createElement("iframe",{src:a,style:{border:"none",width:"100%",height:"100%"},className:"dnd-immune",onLoad:this._onLoad}),Glamor.createElement(g().default.CloseButton,{style:g().default.absolute("8 8 . . 2"),onClick:this._onCloseClick}))}_fetchFSpringConfig(){const e=this.props.billing,t={plan:e.purchasingPlan.id,email:e.account.email,token:e.account.token,hasPro:b().stateProxy.hasPro(),countryIso:"default"===e.snapshot.checkoutCurrency?"US":e.countryIso,storefront:_().env.options.storefront,apiUrl:_().env.options.apiUrl};return"inssist-pro-lifetime"===t.plan&&(t.tags={accounts:[{id:C().model.state.authStatus.userId,name:C().model.state.authStatus.username}]}),btoa(JSON.stringify(t))}}var it=C().influx((e=>({billing:e.billing})))(g().default.theme.ThemeAware(ot));class rt extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onCloseClick=()=>{C().transaction((e=>{e.sidebar.isOpen=!1}))},this._onBillingFaqClick=()=>{m().gaController.sendEvent("user","billing:faq-click"),chrome.tabs.create({url:f().common.faqBillingUrl})},t}componentDidMount(){Date.now()-rt.lastUpdateTs<5e3||(rt.lastUpdateTs=Date.now(),setTimeout((()=>chrome.runtime.sendMessage({name:"update-pro"})),250))}render(){const{billing:e}=this.props;return Glamor.createElement(p().default.BillingPanel,{form:this._getFormSection(),storefront:this._getStorefrontSection(),checkout:this._getCheckoutSection(),clients:this._getClientsSection(),stats:this._getStatsSection(),features:this._getFeaturesSection(),onCloseClick:this._onCloseClick,onBillingFaqClick:this._onBillingFaqClick,loading:e.snapshot.loading})}_getFormSection(){const{panel:e,accountScreen:t}=this.props.billing.snapshot;return"form"===e&&t?Glamor.createElement(Ze,null):null}_getStorefrontSection(){const{panel:e,accountScreen:t}=this.props.billing.snapshot;return"form"===e&&t?null:Glamor.createElement(st,null)}_getCheckoutSection(){const{purchasingPlan:e}=this.props.billing;return e?Glamor.createElement(it,null):null}_getClientsSection(){return Glamor.createElement(p().default.BillingClients,null)}_getStatsSection(){return Glamor.createElement(Xe,null)}_getFeaturesSection(){return Glamor.createElement(at,null)}}var lt=C().influx((e=>({billing:e.billing})))(rt);g(),p(),C();class ct extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onActionBlockCloseClick=()=>{C().transaction((e=>{e.billing.verificationCodeEmail=null}))},t}render(){const{email:e}=this.props,t=Boolean(e),s=[Glamor.createElement("div",null,"We sent a verification code to ",Glamor.createElement("b",null,e)," from ",Glamor.createElement("b",null,"Inssist, no-reply@slashed.io")),Glamor.createElement("div",null,"Sometimes it may get into a spam folder. If a code is not delivered in 5 minutes, please double check your email address or reach out to us at ","inssist@slashed.io")];return Glamor.createElement(p().default.SnackbarItem,{id:"billing-code-mediator",show:t},Glamor.createElement(g().default.InfoCard,{markerColor:g().default.color.positive,title:"Your Code is Emailed",content:s,onClose:this._onActionBlockCloseClick}))}}var dt=C().influx((e=>({email:e.billing.verificationCodeEmail})))(ct);E(),g(),p(),g(),p(),_(),f(),m(),b(),C();class ut extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onFaqClick=()=>{m().gaController.sendEvent("user","billing:faq-click"),chrome.tabs.create({url:f().common.faqBillingUrl})},t}render(){return Glamor.createElement(p().default.BillingPurchase,{expanded:this.props.expanded,purchased:this.props.hasProPaid,withShadow:this.props.withShadow,hidePrice:this.props.hidePrice,hideDisclaimer:this.props.hideDisclaimer,hideFaq:this.props.hideFaq,header:this._getHeader(),features:this._getFeatures(),footer:this._getFooter(),onFaqClick:this._onFaqClick})}_getHeader(){return{title:"Upgrade to PRO",description:Glamor.createElement(g().default.Fragment,null,"A ",Glamor.createElement("b",null,"trial")," period of this feature has expired. Please consider upgrading to PRO to continue using ",this.props.featureTitle,".")}}_getFeatures(){return _().env.options.billingProFeaturesList.map((e=>({id:e.id,icon:e.icon,title:e.title,description:e.description})))}_getFooter(){return{button:{label:"ACTIVATE PRO",onClick:this.props.onActivateProClick}}}}ut.defaultProps={expanded:!1,widthShadow:!0,hidePrice:!0,hideDisclaimer:!0,hideFaq:!0};var ht=C().influx((e=>({hasPro:b().stateProxy.hasPro(),hasProPaid:b().stateProxy.hasProPaid()})))(ut);class mt extends g().default.Component{constructor(e){super(e),this._onActivateProClick=()=>{const e=this.props.feature||null;ze.openBilling(e)},this.state={id:`up-${E().generate()}`}}componentDidMount(){}componentWillUnmount(){clearInterval(this.reloadIfHidden)}render(){return Glamor.createElement(p().default.UpsellOverlay,{id:this.state.id,show:this.props.show,onOverlayClick:this.props.onOverlayClick,content:this._renderContent()})}_isVisible(){const e=document.getElementById(this.state.id);return e&&null!==e.offsetParent&&"visible"===window.getComputedStyle(e).visibility}_renderContent(){const e={analytics:"Analytics",bulk:"Post Assistant",schedule:"Post Assistant","cover-assist":"Cover Assistant",dm:"Ghost Mode",insights:"Analytics"}[this.props.feature]||"INSSIST";return Glamor.createElement("div",{css:{width:400}},Glamor.createElement(ht,{featureTitle:e,onActivateProClick:this._onActivateProClick}))}}g(),p(),C(),v(),m(),b();const gt={tip:{"&:not(:last-child)":{marginBottom:g().default.space.g3}}};class pt extends g().default.Component{constructor(e){super(e),this._onScheduleTipOkClick=()=>{b().actions.acknowledge.dispatch("scheduleTip"),m().gaController.sendEvent("user","tips:schedule-tip-ok-click")},this._onScheduleTipShowClick=()=>{b().actions.acknowledge.dispatch("scheduleTip"),m().gaController.sendEvent("user","tips:schedule-tip-show-click"),C().transaction((e=>{e.sidebar.selectedTabId="tab-scheduling",e.sidebar.isOpen=!0}))},this._onStoryLimitationsOkClick=()=>{b().actions.acknowledge.dispatch("storyLimitations"),m().gaController.sendEvent("user","tips:story-limitations-ok-click")},this._onIframePathChange=e=>{let t;t=e.startsWith("/create/story")?"create-story":e.startsWith("/create/")?"create-post":null,this.setState({pageType:t})},this.state={pageType:null}}componentDidMount(){v().iframeBus.on("ig.path-change",this._onIframePathChange)}componentWillUnmount(){v().iframeBus.off("ig.path-change",this._onIframePathChange)}render(){const e=[],t=this.state.pageType,s=this.props.acknowledged;return"create-post"===t?(e.push({key:"crop-tip",content:this._renderCropTip()}),s.scheduleTip||e.push({key:"schedule-tip",content:this._renderScheduleTip()})):"create-story"===t&&(e.push({key:"crop-tip",content:this._renderCropTip()}),s.story||e.push({key:"story-limitations",content:this._renderStoryLimitations()})),e.length?Glamor.createElement("div",null,e.map((e=>Glamor.createElement("div",{css:gt.tip,key:e.key},e.content)))):null}_renderStoryLimitations(){return Glamor.createElement(p().default.Tip,{content:Glamor.createElement(g().default.Fragment,null,Glamor.createElement("b",null,"Limitations:")," When posting stories a few features such as tagging, gifs and mentions on videos are not implemented in the browser version of Instagram website and thus not available on the app."),buttons:[{label:"OK, GOT IT",onClick:this._onStoryLimitationsOkClick}]})}_renderCropTip(){return Glamor.createElement(p().default.Tip,{icon:"bulb",content:[Glamor.createElement(g().default.Fragment,null,Glamor.createElement("b",null,"Tips:")," Recommended Instagram photo / video sizes and formats can be found in ",Glamor.createElement("a",{href:"https://inssist.com/knowledge-base/instagram-image-size-cheat-sheet",target:"_blank"},"our guide"),"."),Glamor.createElement(g().default.Fragment,null,"You can pre-edit, crop or scale your photo with a free ",Glamor.createElement("a",{href:"https://www.iloveimg.com/crop-image",target:"_blank"},"iloveimg")," tool, and your video with ",Glamor.createElement("a",{href:"https://ezgif.com/resize-video",target:"_blank"},"ezgif")," tool.")]})}_renderScheduleTip(){return Glamor.createElement(p().default.Tip,{icon:"bulb",content:[Glamor.createElement(g().default.Fragment,null,Glamor.createElement("b",null,"Tips:")," A few features such as posting carousels and editing published posts are not available on Instagram Web client."),Glamor.createElement(g().default.Fragment,null,"You can post carousels, edit posts and schedule posts for later with Post Assistant module on the left.")],buttons:[{label:"OK, GOT IT",onClick:this._onScheduleTipOkClick},{label:"SHOW ME, GURU",onClick:this._onScheduleTipShowClick}]})}}var ft=C().influx((e=>({acknowledged:{story:-1!==e.acknowledged.storyLimitations,scheduleTip:-1!==e.acknowledged.scheduleTip}})))(pt);L(),g(),p(),C(),L(),g(),p(),C(),b(),g(),p(),C(),m(),L(),g(),p(),f(),C(),b(),m(),L();class Ct extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onGoToTagClick=()=>{const e=f().ig.hashtag.url(this.props.tag.name);window.electron?window.open(e,`hashtag-details.${this.props.tag.name}`):chrome.tabs.create({url:e,active:!0})},this._onRefreshTagClick=()=>{m().gaController.sendEvent("user","tag-assist:refresh-tag-click"),Be.refreshTag(this.props.tag.name)},this._onUpgradeClick=()=>{ze.openBilling("tag-assist")},this._onUpgradeCancelClick=()=>{C().transaction((e=>{e.tagAssist.tagMetricsUpsellDismissed=!0}))},t}render(){return Glamor.createElement(p().default.TagStatsPopup,{tag:this.props.tag,accountStats:this.props.accountStats,tiers:this.props.tiers,markerDy:this.props.markerDy,markerAtLeft:this.props.markerAtLeft,showRefreshButton:this.props.showRefreshButton,showUpgradeToPro:!this.props.hasPro,onGoToTagClick:this._onGoToTagClick,onRefreshTagClick:this._onRefreshTagClick,onUpgradeClick:this._onUpgradeClick,onUpgradeCancelClick:this._onUpgradeCancelClick})}}var vt=C().influx((e=>({tiers:e.tagAssist.ladderConfig.tiers,hasPro:b().stateProxy.hasPro({feature:"tagAssist"}),accountStats:L().default.getAccountStats(),showRefreshButton:e.experiments.enabled})))(Ct);const{hasEngagementData:bt,engagementToBgColor:kt}=p().default.tagUtils;class wt extends g().default.Component{constructor(...e){var t;return t=super(...e),this._constructStatsPopup=({markerDy:e,markerAtLeft:t})=>Glamor.createElement(vt,{tag:this.props.tag,markerDy:e,markerAtLeft:t}),this._onClick=()=>{if("sidebar"!==this.props.placement||"collections"!==this.props.selectedTabId)Be.registerUsage(),Be.toggleTag(this.props.tag.name,this.props.placement),m().gaController.sendEvent("user","tag-assist:tag-click");else{if(bt(this.props.tag))return;Be.checkCollectionTags([this.props.tag.name],{useRedis:!1})}},t}render(){const e=!!this.props.tag.lastScanOn;return Glamor.createElement(p().default.TagPill,{name:this.props.tag.name,color:this._getColor(),loading:this._isLoading(),selected:this._isSelected(),banned:this.props.tag.isBanned,flagged:this.props.tag.isFlagged,clickable:this._isClickable(),renderStatsPopup:e?this._constructStatsPopup:null,onClick:this._onClick})}_isClickable(){return"sidebar"!==this.props.placement||"collections"!==this.props.selectedTabId||!bt(this.props.tag)}_getColor(){return this.props.noColor?null:kt(this.props.tag,this.props.accountStats,this.props.tiers)}_isLoading(){return("collections"===this.props.selectedTabId?this.props.collectionsLoadingTags:this.props.ladderLoadingTags).includes(this.props.tag.name)}_isSelected(){return!this.props.disableSelect&&this.props.selectedTags.includes(this.props.tag.name)}}var St=C().influx(((e,t)=>({tiers:e.tagAssist.ladderConfig.tiers,accountStats:L().default.getAccountStats(),selectedTabId:e.tagAssist.selectedTabId,selectedTags:L().default.getSelectedTags(t.placement),ladderLoadingTags:e.tagAssist.ladderLoadingTags,collectionsLoadingTags:e.tagAssist.collectionsLoadingTags})))(wt);class _t extends g().default.Component{constructor(...e){var t;return t=super(...e),this.scuIgnoreFields=["tagData"],this._constructTag=(e,t)=>{let s=this.props.tagData[e]||null;return(!s||!this.props.hasPro&&this.props.upsellDismissed)&&(s={name:e}),{id:e,element:Glamor.createElement(St,{tag:s,noColor:!this.props.hasPro,placement:this.props.placement})}},t}render(){return Glamor.createElement(p().default.TagAssistList,{label:this.props.label,tags:this.props.tagNames.map(this._constructTag),noTagsMessage:"No tags found"})}}var yt=C().influx((e=>({hasPro:b().stateProxy.hasPro({feature:"tagAssist"}),upsellDismissed:e.tagAssist.tagMetricsUpsellDismissed})))(_t);g(),p(),C(),b(),L(),g(),p(),C(),L();const{hasEngagementData:Tt,calcEngagement:Et,calcRate:Pt}=p().default.tagUtils;class At extends g().default.Component{constructor(e){super(e),this.scuIgnoreFields=["tagData"],this._renderTagPill=({name:e})=>Glamor.createElement(St,{tag:this._getTag(e),placement:this.props.placement}),this._onEngagementSortClick=()=>{C().transaction((e=>{const t="summary"===this.props.placement?"summaryEngagementSort":"ladderEngagementSort";e.tagAssist[t]?"descending"===e.tagAssist[t]?e.tagAssist[t]="ascending":e.tagAssist[t]=null:e.tagAssist[t]="descending"}))},this._onPostCountSortClick=()=>{C().transaction((e=>{const t="summary"===this.props.placement?"summaryPostCountSort":"ladderPostCountSort";e.tagAssist[t]?"descending"===e.tagAssist[t]?e.tagAssist[t]="ascending":e.tagAssist[t]=null:e.tagAssist[t]="descending"}))},this._onSkipChange=e=>{this.setState({skip:e})},this._onCheckClick=e=>{Be.checkTags([e])},this._onCheckAllClick=()=>{const e=this._getPageTags().map((e=>e.name));Be.checkTags(e)},this._onStopAllClick=()=>{const e=this._getPageTags().map((e=>e.name));Be.stopTags(e)},this.tags=[],this.state={skip:0}}render(){return this.tags=this._getSortedTags(),Glamor.createElement(p().default.TagAssistTable,{skip:this.state.skip,pageSize:this._getPageSize(),engagementSort:this.props.engagementSort,renderTagPill:this._renderTagPill,tags:this.tags,onEngagementSortClick:this.props.isNoDataGroup?null:this._onEngagementSortClick,onPostCountSortClick:this.props.isNoDataGroup?null:this._onPostCountSortClick,showCheckAll:this._shouldShowCheckAll(),showStopAll:this._shouldShowStopAll(),onSkipChange:this._onSkipChange,onCheckClick:this._onCheckClick,onCheckAllClick:this._onCheckAllClick,onStopAllClick:this._onStopAllClick})}_getPageSize(){return"summary"===this.props.placement?100:window.innerHeight<890&&"sidebar"===this.props.placement?8:10}_getSortedTags(){const e=this.props.engagementSort,t=this.props.postCountSort,s=Et(this.props.accountStats);return this.props.tagNames.map((e=>{const t=this._getTag(e),a=Et(t);return{name:t.name,hasData:Tt(t),banned:t.isBanned,flagged:t.isFlagged,fetching:this.props.loadingTags.includes(t.name),postCount:t.avgPosts,engagementRate:Pt(a,s)}})).sort(((s,a)=>{if(e){if(!s.hasData&&!a.hasData)return null;if(s.hasData&&!a.hasData)return-1;if(!s.hasData&&a.hasData)return 1;return("ascending"===e?1:-1)*(s.engagementRate-a.engagementRate)}if(t){return("ascending"===t?1:-1)*(s.postCount-a.postCount)}return null}))}_shouldShowCheckAll(){if(!this.props.isNoDataGroup)return!1;const e=this._getPageTags();return!e.some((e=>this.props.loadingTags.includes(e.name)))&&e.filter((e=>!this.props.tagData[e.name])).length>0}_shouldShowStopAll(){if(!this.props.isNoDataGroup)return!1;return this._getPageTags().some((e=>this.props.loadingTags.includes(e.name)))}_getPageTags(){const e=this.state.skip,t=this._getPageSize();return this.tags.slice(e,e+t)}_getTag(e){return this.props.tagData[e]||{name:e}}}var It=C().influx(((e,t)=>{const s="ladder"===e.tagAssist.selectedTabId&&"nodata"===e.tagAssist.selectedGroupId;let a,n;return s?(a=null,n=null):"summary"===t.placement?(a=e.tagAssist.summaryEngagementSort,n=e.tagAssist.summaryPostCountSort):(a=e.tagAssist.ladderEngagementSort,n=e.tagAssist.ladderPostCountSort),{loadingTags:e.tagAssist.ladderLoadingTags,accountStats:L().default.getAccountStats(),engagementSort:a,postCountSort:n,isNoDataGroup:s}}))(At);class xt extends g().default.Component{constructor(...e){var t;return t=super(...e),this.scuIgnoreFields=["tagData"],this._onGroupClick=e=>{C().transaction((t=>{t.tagAssist.selectedGroupId=e}))},t}render(){return Glamor.createElement(p().default.TagAssistLadder,{selectedGroupId:this.props.selectedGroupId,groups:this._getGroups(),content:this._constructContent(),blurContent:this._shouldBlurContent(),showNotEnoughDataWarning:this._shouldShowNotEnoughDataWarning(),onGroupClick:this._onGroupClick})}_getGroups(){return this.props.ladder?[this._getGroupLow(),this._getGroupMedium(),this._getGroupHigh(),this._getGroupVHigh(),this._getGroupNoData()]:null}_constructContent(){if(!this.props.ladder)return null;const e=this.props.ladder[this.props.selectedGroupId];return 0===e.length?null:Glamor.createElement(It,{key:this.props.selectedGroupId,tagNames:e,tagData:this.props.tagData,tagDataKey:this.props.tagDataKey,placement:this.props.placement})}_shouldBlurContent(){return!this.props.hasPro}_shouldShowNotEnoughDataWarning(){if(!this.props.ladder)return!1;return this.props.ladder[this.props.selectedGroupId].length<10}_getGroupLow(){const e=this._getGroupCount("low");return{id:"low",title:"LOW",count:e,tooltip:{text:[Glamor.createElement(g().default.Fragment,null,"Hashtags of this group have a ",Glamor.createElement("b",null,"LOW")," engagement comparing to your account."),Glamor.createElement(g().default.Fragment,null,"It is quite likely to get ranked among the top posts for these hashtags. Using these hashtags should boost your engagement."),!!e&&Glamor.createElement(g().default.Fragment,null,"You selected ",Glamor.createElement("b",null,e)," ",1===e?"hashtag":"hashtags"," of this group.")]}}}_getGroupMedium(){const e=this._getGroupCount("medium");return{id:"medium",title:"MEDIUM",count:e,tooltip:{text:[Glamor.createElement(g().default.Fragment,null,"Hashtags of this group have a ",Glamor.createElement("b",null,"MEDIUM")," engagement comparing to your account."),Glamor.createElement(g().default.Fragment,null,"It is possible to get ranked among the top posts for these hashtags. Using these hashtags is optimal for your account. Mix them with low hashtags to get ranked higher among them."),!!e&&Glamor.createElement(g().default.Fragment,null,"You selected ",Glamor.createElement("b",null,e)," ",1===e?"hashtag":"hashtags"," of this group.")]}}}_getGroupHigh(){const e=this._getGroupCount("high");return{id:"high",title:"HIGH",count:e,tooltip:{text:[Glamor.createElement(g().default.Fragment,null,"Hashtags of this group have a ",Glamor.createElement("b",null,"HIGH")," engagement comparing to your account."),Glamor.createElement(g().default.Fragment,null,"It will be possible to get ranked among the top posts for these hashtags if your post also ranks among the low and medium hashtags."),!!e&&Glamor.createElement(g().default.Fragment,null,"You selected ",Glamor.createElement("b",null,e)," ",1===e?"hashtag":"hashtags"," of this group.")]}}}_getGroupVHigh(){const e=this._getGroupCount("vhigh");return{id:"vhigh",title:"V.HIGH",tooltip:{text:[Glamor.createElement(g().default.Fragment,null,"Hashtags of this group have a ",Glamor.createElement("b",null,"VERY HIGH")," engagement comparing to your account."),Glamor.createElement(g().default.Fragment,null,"It is unlikely to get ranked among the top posts for these hashtags. It is better to avoid these hashtags if possible."),!!e&&Glamor.createElement(g().default.Fragment,null,"You selected ",Glamor.createElement("b",null,e)," ",1===e?"hashtag":"hashtags"," of this group.")]}}}_getGroupNoData(){if(0===this.props.ladder.nodata.length)return null;return{id:"nodata",title:"NO DATA",tooltip:{text:[Glamor.createElement(g().default.Fragment,null,"Inssist has no engagement data for these hashtags (yet)."),Glamor.createElement(g().default.Fragment,null,"Click CHECK TAGS button to request data for these hashtags.")]}}}_getGroupCount(e){return this.props.hasPro?(this.props.ladder[e]||[]).filter((e=>this.props.selectedTags.includes(e))).length:null}}var Dt=C().influx(((e,t)=>({selectedGroupId:e.tagAssist.selectedGroupId,selectedTags:L().default.getSelectedTags(t.placement),ladder:L().default.getLadderLatinOnlyAware(),hasPro:b().stateProxy.hasPro({feature:"tagAssist"})})))(xt);g(),p(),C(),G();class Gt extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onInput=e=>{C().transaction((t=>{t.tagAssist.sidebarSelectedTags=G().extractTags(e),t.tagAssist.sidebarSelectedTagsAsText=e}))},this._onCopyAllClick=()=>{const e=G().extractTags(this.props.sidebarSelectedTagsAsText);Be.copyTags(e)},t}componentDidUpdate(e){const t=e,s=this.props;if(t.sidebarSelectedTagsAsText===s.sidebarSelectedTagsAsText){const e=t.sidebarSelectedTags.map((e=>`#${e}`)).join(" "),a=s.sidebarSelectedTags.map((e=>`#${e}`)).join(" ");e!==a&&C().transaction((e=>{e.tagAssist.sidebarSelectedTagsAsText=a}))}}render(){return Glamor.createElement(p().default.TagAssistTextarea,{label:this._getLabel(),value:this._getValue(),onInput:this._onInput,onCopyAllClick:this._onCopyAllClick})}_getLabel(){return 0===this.props.sidebarSelectedTags.length?"hashtags":`hashtags (${this.props.sidebarSelectedTags.length})`}_getValue(){return this.props.sidebarSelectedTagsAsText}}var Ft=C().influx((e=>({sidebarSelectedTags:e.tagAssist.sidebarSelectedTags,sidebarSelectedTagsAsText:e.tagAssist.sidebarSelectedTagsAsText})))(Gt);g(),p(),C(),L();class Ot extends g().default.Component{constructor(e){super(e),this._onQueryInput=e=>{C().transaction((t=>{t.tagAssist.query=e,e?t.tagAssist.searching=!0:(t.tagAssist.searching=!1,t.tagAssist.ladder=null)})),clearTimeout(this.searchTimeout),this.searchTimeout=this.setTimeout((()=>{this.searchTimeout=null,Be.search()}),800)},this._onClearQueryClick=()=>{C().transaction((e=>{e.tagAssist.query=""})),clearTimeout(this.searchTimeout),this.searchTimeout=null,Be.search()},this._onLatinOnlyClick=()=>{C().transaction((e=>{e.tagAssist.latinOnly=!e.tagAssist.latinOnly}))},this.ladder=null,this.searchTimeout=null}componentDidMount(){this.props.query&&Be.search({sendGaEvent:!1})}componentWillUnmount(){super.componentWillUnmount(),this.searchTimeout&&Be.search()}render(){return Glamor.createElement(p().default.TagAssistSearchInput,{type:this._getType(),query:this.props.query,placeholder:this._getPlaceholder(),loading:this.props.loading,latinOnly:this.props.latinOnly,onQueryInput:this._onQueryInput,onClearQueryClick:this._onClearQueryClick,onLatinOnlyClick:this._onLatinOnlyClick})}_getType(){return"search"===this.props.selectedTabId?"search":"ladder"===this.props.selectedTabId?"ladder":null}_getPlaceholder(){var e;const t=(null===(e=this.props.accountStats)||void 0===e?void 0:e.mostUsedTags)||[];return 0===t.length?function(...e){return e[Math.floor(Math.random()*e.length)]}("#travel","#design","#nature","#life","#instagram"):t.slice(0,2).map((e=>`#${e}`)).join(" ")}}var Bt=C().influx((e=>({query:e.tagAssist.query,loading:e.tagAssist.searching,latinOnly:e.tagAssist.latinOnly,selectedTabId:e.tagAssist.selectedTabId,accountStats:L().default.getAccountStats()})))(Ot);class Ut extends g().default.Component{constructor(...e){var t;return t=super(...e),this.scuIgnoreFields=["tagData"],t}render(){return Glamor.createElement(p().default.TagAssistPanelSearch,{type:this._getType(),input:this._constructInput(),content:this._constructContent(),textarea:this._constructTextarea(),showWelcome:this._shouldShowWelcome()})}_getType(){return"search"===this.props.selectedTabId?"search":"ladder"===this.props.selectedTabId?"ladder":null}_constructInput(){return Glamor.createElement(Bt,null)}_constructContent(){if("search"===this.props.selectedTabId){var e;const t=(null===(e=this.props.ladder)||void 0===e?void 0:e.relevant)||[];return Glamor.createElement(yt,{label:"relevant hashtags",tagNames:t,tagData:this.props.tagData,tagDataKey:this.props.tagDataKey,placement:this.props.placement})}if("ladder"===this.props.selectedTabId)return Glamor.createElement(Dt,{tagData:this.props.tagData,tagDataKey:this.props.tagDataKey,placement:this.props.placement})}_constructTextarea(){return"sidebar"===this.props.placement&&(this.props.ladder||this.props.sidebarSelectedTags.length>0)?Glamor.createElement(Ft,null):null}_shouldShowWelcome(){return!this.props.ladder}}var Lt=C().influx((e=>({ladder:L().default.getLadderLatinOnlyAware(),selectedTabId:e.tagAssist.selectedTabId,sidebarSelectedTags:e.tagAssist.sidebarSelectedTags})))(Ut);g(),p(),C(),L();class Mt extends g().default.Component{constructor(e){super(e),this.scuIgnoreFields=["tagData"],this._onTakeAllClick=()=>{Be.selectTags(this.tags,this.props.placement)},this._onRemoveAllClick=()=>{Be.unselectTags(this.tags,this.props.placement)},this._onCheckAllClick=()=>{Be.checkTags(this.tags)},this._onStopAllClick=()=>{Be.stopAllTags()},this.tags=[...e.selectedTags]}render(){const e=this._getRanking();return Glamor.createElement(p().default.TagAssistPanelSummary,{rankingTitle:e.title,rankingColor:e.color,rankingDescription:e.description,showTakeAll:this._shouldShowTakeAll(),showRemoveAll:this._shouldShowRemoveAll(),showCheckAll:this._shouldShowCheckAll(),showStopAll:this._shouldShowStopAll(),content:this._constructContent(),onTakeAllClick:this._onTakeAllClick,onRemoveAllClick:this._onRemoveAllClick,onCheckAllClick:this._onCheckAllClick,onStopAllClick:this._onStopAllClick})}_shouldShowTakeAll(){return 0!==this.tags.length&&this.tags.some((e=>!this.props.selectedTags.includes(e)))}_shouldShowRemoveAll(){return 0!==this.tags.length&&this.tags.every((e=>this.props.selectedTags.includes(e)))}_shouldShowCheckAll(){return 0!==this.tags.length&&(!(this.props.loadingTags.length>0)&&this.tags.filter((e=>!this.props.tagData[e])).filter((e=>!this.props.loadingTags.includes(e))).length>0)}_shouldShowStopAll(){return this.tags.some((e=>this.props.loadingTags.includes(e)))}_getRanking(){const e=this.props.summaryStatus.id;return"n/a"===e?this._getRankingNA():"not-enough-low"===e?this._getRankingNotBalanced("low"):"not-enough-high"===e?this._getRankingNotBalanced("high"):this._getRankingBalanced()}_constructContent(){return Glamor.createElement(It,{tagNames:this.tags,tagData:this.props.tagData,tagDataKey:this.props.tagDataKey,placement:this.props.placement})}_getRankingNA(){return{title:"N/A",color:this.props.summaryStatus.color,description:Glamor.createElement(g().default.Fragment,null,"Please add at least 9 hashtags with data to get a hashtag ladder ranking. Find out more in our ",Glamor.createElement("a",{href:"https://inssist.com/knowledge-base/ultimate-instagram-hashtag-guide",target:"_blank"},"Hashtag Guide"),".")}}_getRankingNotBalanced(e){return e=e.toUpperCase(),{title:"Not Balanced",color:this.props.summaryStatus.color,description:Glamor.createElement(g().default.Fragment,null,"Your hashtag selection is missing hashtags from ",e," engagement group. Try to find and add more ",e," hashtags to your caption. Find out more in our ",Glamor.createElement("a",{href:"https://inssist.com/knowledge-base/ultimate-instagram-hashtag-guide",target:"_blank"},"Hashtag Guide"),".")}}_getRankingBalanced(){return{title:"Balanced",color:this.props.summaryStatus.color,description:Glamor.createElement(g().default.Fragment,null,"Your hashtag selection looks spot on with competitive and niche hashtags mixed together. Find out more in our ",Glamor.createElement("a",{href:"https://inssist.com/knowledge-base/ultimate-instagram-hashtag-guide",target:"_blank"},"Hashtag Guide"),".")}}}var Rt=C().influx(((e,t)=>({loadingTags:e.tagAssist.ladderLoadingTags,selectedTags:L().default.getSelectedTags(t.placement),summaryStatus:L().default.getSummaryStatus(t.placement)})))(Mt);g(),p(),C(),g(),p(),P(),C(),G(),b(),m(),L();class Nt extends g().default.Component{constructor(e){super(e),this._constructTag=e=>({id:e.name,element:Glamor.createElement(St,{tag:e,placement:this.props.placement})}),this._onCopyAllClick=()=>{m().gaController.sendEvent("user","tag-assist:collection-copy-all");const e=this.tags.map((e=>e.name));Be.copyTags(e)},this._onTakeAllClick=()=>{m().gaController.sendEvent("user","tag-assist:collection-take-all");const e=this.tags.map((e=>e.name));Be.selectTags(e,this.props.placement)},this._onRemoveAllClick=()=>{m().gaController.sendEvent("user","tag-assist:collection-remove-all");const e=this.tags.map((e=>e.name));Be.unselectTags(e,this.props.placement)},this._onNameInput=e=>{C().transaction((t=>{this._getCollection(t).editName=e}))},this._onTextInput=e=>{C().transaction((t=>{this._getCollection(t).editText=e}))},this._onEditClick=()=>{b().stateProxy.hasPro({feature:"tagAssist"})?C().transaction((e=>{for(const t of e.tagAssist.collections)t.editing=!1;const t=this._getCollection(e);t.editing=!0,t.editName=t.editName||this.props.collection.name,t.editText=t.editText||this.tags.map((e=>`#${e.name}`)).join(" ")})):ze.openBilling("tag-assist")},this._onSaveClick=()=>{m().gaController.sendEvent("user","tag-assist:collection-edit"),C().transaction((e=>{const t=this._getCollection(e);t.name=t.editName,t.tags=G().extractTags(t.editText),t.editing=!1,t.editName="",t.editText=""})),Be.registerUsage(),Be.saveCollectionsToLs(),Be.updateCollectionsTagData()},this._onCancelClick=()=>{C().transaction((e=>{const t=this._getCollection(e);t.editing=!1,t.editName="",t.editText=""}))},this._onDeleteClick=()=>{m().gaController.sendEvent("user","tag-assist:collection-delete"),C().transaction((e=>{e.tagAssist.collections=e.tagAssist.collections.filter((e=>e.id!==this.props.collectionId))})),Be.saveCollectionsToLs(),Be.updateCollectionsTagData()},this.tags=[]}render(){this.tags=this.props.collection.tags.map((e=>this.props.tagData[e]||e)).map(G().decompressTag);const e=this.tags.every((e=>this.props.selectedTags.includes(e.name))),t=G().extractTags(this.props.collection.editText).filter(P().default).length;return Glamor.createElement(p().default.TagAssistCollection,{name:this.props.collection.name,tags:this.tags.map(this._constructTag),editing:this.props.collection.editing,editName:this.props.collection.editName,editText:this.props.collection.editText,editTextLabel:this._getEditTextLabel(t),editErrorMessage:this._getEditErrorMessage(t),showCopyAll:this.tags.length>0,showTakeAll:"sidebar"!==this.props.placement&&this.tags.length>0&&!e,showRemoveAll:"sidebar"!==this.props.placement&&this.tags.length>0&&e,onCopyAllClick:this._onCopyAllClick,onTakeAllClick:this._onTakeAllClick,onRemoveAllClick:this._onRemoveAllClick,onNameInput:this._onNameInput,onTextInput:this._onTextInput,onEditClick:this._onEditClick,onSaveClick:this._onSaveClick,onCancelClick:this._onCancelClick,onDeleteClick:this._onDeleteClick})}_getEditTextLabel(e){return e<=1?"hashtags":`hashtags (${e})`}_getEditErrorMessage(e){return e<=100?null:`Limit exceeded: ${e} / 100`}_getCollection(e){return e.tagAssist.collections.find((e=>e.id===this.props.collectionId))}}var zt=C().influx(((e,{collectionId:t,placement:s})=>({tagData:e.tagAssist.collectionsTagData,collection:e.tagAssist.collections.find((e=>e.id===t)),selectedTags:L().default.getSelectedTags(s)})))(Nt);E(),g(),p(),P(),C(),b(),m(),G();class Ht extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onButtonClick=()=>{b().stateProxy.hasPro({feature:"tagAssist"})?C().transaction((e=>{e.tagAssist.newCollection.name="Collection",e.tagAssist.newCollection.text="",e.tagAssist.newCollection.showForm=!0})):ze.openBilling("tag-assist")},this._onNameInput=e=>{C().transaction((t=>{t.tagAssist.newCollection.name=e}))},this._onTextInput=e=>{C().transaction((t=>{t.tagAssist.newCollection.text=e}))},this._onSaveClick=()=>{m().gaController.sendEvent("user","tag-assist:collection-create"),C().transaction((e=>{const t=e.tagAssist.newCollection;e.tagAssist.collections.unshift({id:E().generate(),name:t.name,tags:G().extractTags(t.text),editing:!1,editName:"",editText:""}),t.name="",t.text="",t.showForm=!1})),Be.registerUsage(),Be.saveCollectionsToLs(),Be.updateCollectionsTagData()},this._onCancelClick=()=>{C().transaction((e=>{e.tagAssist.newCollection.name="",e.tagAssist.newCollection.text="",e.tagAssist.newCollection.showForm=!1}))},t}render(){const e=G().extractTags(this.props.newCollection.text).filter(P().default).length;return Glamor.createElement(p().default.TagAssistNewCollection,{name:this.props.newCollection.name,text:this.props.newCollection.text,textLabel:this._getTextLabel(e),showForm:this.props.newCollection.showForm,errorMessage:this._getErrorMessage(e),onButtonClick:this._onButtonClick,onNameInput:this._onNameInput,onTextInput:this._onTextInput,onSaveClick:this._onSaveClick,onCancelClick:this._onCancelClick})}_getTextLabel(e){return e<=1?"hashtags":`hashtags (${e})`}_getErrorMessage(e){return e<=100?null:`Limit exceeded: ${e} / 100`}}var Vt=C().influx((e=>({newCollection:e.tagAssist.newCollection})))(Ht);class Wt extends g().default.Component{constructor(...e){var t;return t=super(...e),this._constructCollection=e=>({id:e,element:Glamor.createElement(zt,{collectionId:e,placement:this.props.placement})}),t}render(){return Glamor.createElement(p().default.TagAssistPanelCollections,{newCollection:Glamor.createElement(Vt,null),collections:this.props.collectionIds.map(this._constructCollection)})}}var $t=C().influx((e=>({collectionIds:e.tagAssist.collections.map((e=>e.id))})))(Wt);const qt=({props:e})=>({width:6,height:6,marginLeft:g().default.space.g1,borderRadius:"50%",background:e.summaryColor});class jt extends g().default.Component{constructor(e){super(e),this.scuIgnoreFields=["tagData"],this._applyTagData=e=>{this.setState({tagData:{...e},tagDataKey:String(Date.now())})},this._onTabClick=e=>{m().gaController.sendEvent("user",`tag-assist:tab-click-${e.id}`),C().transaction((t=>{t.tagAssist.selectedTabId=e.id}))},this._onUpgradeClick=()=>{m().gaController.sendEvent("user","tag-assist:upgrade-to-pro-click"),ze.openBilling("tag-assist")},this._onCloseClick=()=>{C().transaction((e=>{"schedule"===this.props.placement?e.schedule.showTagAssist=!1:e.tagAssist.shown=!1}))},this.state={tagData:{},tagDataKey:null}}componentDidMount(){(async()=>{const e=await Be.getTagData();this._applyTagData(e)})(),Be.onTagDataUpdate(this._applyTagData)}componentWillUnmount(){Be.onTagDataUpdate.off(this._applyTagData)}render(){return Glamor.createElement(p().default.TagAssistPanel,{placement:this.props.placement,selectedTabId:this.props.selectedTabId,tabs:this._getTabs(),proWarning:this._constructProWarning(),body:this._constructBody(),tips:this._constructTips(),onTabClick:this._onTabClick,onCloseClick:"sidebar"===this.props.placement?null:this._onCloseClick})}_getTabs(){return[{id:"search",label:"SEARCH"},{id:"ladder",label:"LADDER"},{id:"collections",label:"COLLECTIONS"},this.props.hasPro&&"sidebar"!==this.props.placement&&{id:"summary",label:Glamor.createElement(g().default.Fragment,null,"RANK",Glamor.createElement("div",{css:qt(this)}))}].filter(Boolean)}_constructProWarning(){if(this.props.hasPro)return null;const e=this.props.selectedTabId;return"search"===e?null:"ladder"!==e||this.props.hasLadder?{text:"Upgrade to PRO to get tag metrics, ladders and hashtag collection features.",onUpgradeClick:this._onUpgradeClick}:null}_constructBody(){const e=this.props.selectedTabId;return"search"===e||"ladder"===e?Glamor.createElement(Lt,{tagData:this.state.tagData,tagDataKey:this.state.tagDataKey,placement:this.props.placement}):"collections"===e?Glamor.createElement($t,{placement:this.props.placement}):"summary"===e?Glamor.createElement(Rt,{tagData:this.state.tagData,tagDataKey:this.state.tagDataKey,placement:this.props.placement}):null}_constructTips(){return"sidebar"===this.props.placement||"schedule"===this.props.placement?null:Glamor.createElement(ft,null)}}var Yt=C().influx(((e,t)=>({hasPro:b().stateProxy.hasPro({feature:"tagAssist"}),selectedTabId:e.tagAssist.selectedTabId,summaryColor:L().default.getSummaryStatus(t.placement).color,hasLadder:Boolean(e.tagAssist.ladder)})))(jt);g(),p(),C();class Kt extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onCloseClick=()=>{C().transaction((e=>{e.sidebar.isOpen=!1}))},t}render(){return Glamor.createElement(p().default.TagAssistSidePanel,{title:"Tag Assistant",content:Glamor.createElement(Yt,{placement:"sidebar"}),onCloseClick:this._onCloseClick})}}function Zt(){return(Zt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}g(),p(),C();class Jt extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onCloseClick=()=>{C().transaction((e=>{e.tagAssist.errorCode=null}))},t}render(){return Glamor.createElement(p().default.SnackbarItem,{id:"tag-assist-snackbar-item-mediator",show:!!this.props.errorCode},Glamor.createElement(g().default.InfoCard,Zt({},this._getTitleAndContent(),{icon:"warning-triangle",iconStyle:{width:14,height:16,color:g().default.color.error,position:"relative",top:1},markerColor:g().default.color.error,onClose:this._onCloseClick})))}_getTitleAndContent(){if("tag-fetch-failed"===this.props.errorCode)return{title:"Too Many Requests",content:"\n          Failed to fetch data for a Hashtag page.\n          Too many hashtag requests were made from your IP network recently.\n          Please give it some time (from 15 minutes to a few hours) and try again.\n        "}}}var Qt=C().influx((e=>({errorCode:e.tagAssist.errorCode})))(Jt);function Xt(...e){const t=function(e,...t){let s=0;return e.join("###").split(",").join("\n,\n").split("{").join("\n{").split("\n").map((e=>{if(!e.includes("###"))return e;const a=B().default(t[s]).map((t=>e.split("###").join(t))).join(",\n");return s+=1,a})).join("\n")}(...e);document.head.insertAdjacentHTML("afterbegin",t)}o(),H(),O(),y(),A(),B(),w(),_(),V(),C(),W(),S(),v(),d(),b(),R(),$(),q();const es={init:function(){this._initialized||(this._initialized=!0,this._initTestCommand(),this._initToggleExperimentsShortcut(),this._initGlobalVars())},_initTestCommand:function(){window.test=()=>{chrome.tabs.create({url:"/tests.html",active:!0})}},_initToggleExperimentsShortcut:function(){document.addEventListener("keydown",(e=>{e.ctrlKey&&e.altKey&&e.shiftKey&&40===e.keyCode&&C().transaction((e=>{e.experiments.enabled=!e.experiments.enabled}))}))},_initGlobalVars:function(){window.env=_().env,window.eventBus=W().eventBus,window.chromeBus=S().chromeBus,window.iframeBus=v().iframeBus,window.tagAssistController=Be,window.abTestingController=d().abTestingController,window.igApi=R().igApi,window.callAsync=y().default,window.createUrl=A().default,window.ls=H().default,window.safe=O().default,window.idbController=V().idbController,window.insertMultistyle=Xt,(_().env.is.development||_().env.is.beta)&&(window.model=C().model,window.transaction=C().transaction,window.stateProxy=b().stateProxy,window.scheduleProxy=$().default,window.scheduleGenerateSquarePreview=q().default,window.setState=this.setState,Object.assign(window,w()),this.defineCommit())},setState:function(e){const t=o().default.cloneDeep(e);b().replaceState.dispatch(t)},defineCommit:function(){Object.defineProperty(window,"commit",{get:()=>(this.setState(C().model.state),null)})}};function ts(e){_().env.is.development&&console.log(`%c${e}`,"color: #00a084")}g(),p(),_(),C(),b(),v(),v(),m(),C(),$(),E(),j(),Y(),k(),C(),b(),w(),m(),W(),S(),v(),u(),k(),_(),Y(),x(),w(),b(),v(),S(),C();var ss={applyBulkActions:async function(){if(!$().default.hasBulkActions())return;let e=!1;const t=$().default.getPosts({ignoreBulkDeleteAction:!0}).map((e=>e.id)).reverse();for(const s of t){const t=C().model.state,a=t.bulk.actions[s];if(!a)continue;const n=t.schedule.posts.find((e=>e.id===s));if(n){C().transaction((e=>{e.schedule.posts.find((e=>e.id===s)).saveStatus="saving"}));try{await ns({action:a,post:n})}catch(t){e=!0,is(null),os(null),C().transaction((e=>{delete e.bulk.actions[s]})),console.error("[bulk]",t)}ts(`[bulk] sleeping for ${as.sleepSeconds.toFixed(2)}s`),await k().default(as.sleepSeconds*w().SECOND),as.sleepSeconds=0,C().transaction((e=>{const t=e.schedule.posts.find((e=>e.id===s));t&&"saving"===t.saveStatus&&(t.saveStatus=null)})),is(null),os(null)}}e&&C().transaction((e=>{e.schedule.fcsError="Failed to save some changes",e.schedule.isErrorShown=!0}))},cancelBulkActions:function(){C().transaction((e=>{e.bulk.actions={},e.bulk.selectedPostIds=[]}))}};const as={sleepSeconds:0};async function ns({action:e,post:t},s=0){var a;const n=async()=>{ts("[bulk] failed, retrying in 4 seconds"),await k().default(4*w().SECOND),await ns({action:e,post:t},s+1)};os(t.preview);try{"fcs"===t.source?await async function({action:e,post:t}){if(e.delete){is("DELETING POST..."),as.sleepSeconds=0;const e=await S().chromeBus.send("fb-api.fcs-delete-post",t.id);if(e.error)throw e.error;return void C().transaction((e=>{e.schedule.posts=e.schedule.posts.filter((e=>e.id!==t.id)),delete e.bulk.actions[t.id]}))}const s=e.status||t.status,a=s!==t.status,n="caption"in e&&e.caption!==t.caption,o="on"in e&&e.on!==t.on;if("draft"===s&&(a||n)){var i;a&&is("SAVING AS A DRAFT..."),as.sleepSeconds=1.5;const s=await S().chromeBus.send("fb-api.fcs-save-as-draft",t.id,{caption:null!==(i=e.caption)&&void 0!==i?i:t.caption});if(s.error)throw s.error}else if("scheduled"===s&&(a||n||o)){var r;(a||o)&&is("SCHEDULING..."),as.sleepSeconds=1.5;const s=await S().chromeBus.send("fb-api.fcs-save-as-scheduled",t.id,e.on||t.on,{caption:null!==(r=e.caption)&&void 0!==r?r:t.caption});if(s.error)throw s.error}else if("posted"===s&&(a||n)){var l;a&&is("PUBLISHING..."),as.sleepSeconds=1.5;const s=await S().chromeBus.send("fb-api.fcs-save-as-published",t.id,{caption:null!==(l=e.caption)&&void 0!==l?l:t.caption});if(s.error)throw s.error}else as.sleepSeconds=.15;C().transaction((s=>{var a;"draft"!==t.status||"scheduled"!==e.status&&"posted"!==e.status||b().stateProxy.hasProPaid()||(s.billing.trial.schedule+=1);const n=s.schedule.posts.find((e=>e.id===t.id));n.status=e.status||t.status,n.caption=null!==(a=e.caption)&&void 0!==a?a:t.caption,n.on=e.on||t.on,n.draftOrder=e.draftOrder||t.draftOrder,"posted"!==t.status&&"posted"===e.status&&(n.createdOn=n.on,n.saveStatus="syncing"),delete s.bulk.actions[t.id]})),rs()}({action:e,post:t}):"local"===t.source&&await async function({action:e,post:t}){var s;if(e.delete)return as.sleepSeconds=.15,is("DELETING POST..."),void C().transaction((e=>{x().default(e.schedule.posts,(e=>e.id===t.id))}));if(!e.status)return as.sleepSeconds=.15,void C().transaction((s=>{var a;const n=s.schedule.posts.find((e=>e.id===t.id));n.on=e.on||t.on,n.caption=null!==(a=e.caption)&&void 0!==a?a:t.caption,n.draftOrder=e.draftOrder||t.draftOrder}));is("UPLOADING..."),as.sleepSeconds=2;const a=await Ws.getPostFiles(t.id),n=e.status||t.status;await v().iframeBus.send("schedule.fcs-open-new-post-form",{localPostId:t.id,localPostFiles:a,postMode:"posted"===n?"publish":"draft"===n?"draft":"scheduled"===n?"schedule":null});const o=null!==(s=e.caption)&&void 0!==s?s:t.caption;await v().iframeBus.send("schedule.set-caption",o),C().transaction((s=>{if(s.schedule.dateDialog.selectedOption="posted"===n?"publish-now":"draft"===n?"save-as-draft":"scheduled"===n?"schedule":null,"scheduled"===n){const a=e.on||t.on;s.schedule.dateDialog.selectedDay=Y().default(a).getTime(),s.schedule.dateDialog.selectedSlotTime=null,s.schedule.dateDialog.customTime=a-Y().default(a).getTime()}})),"scheduled"===n&&await Fs.actualizeDataForIframe();const i=await v().iframeBus.send("schedule.fcs-wait-upload");if(C().transaction((e=>{e.schedule.addCard.savingTitle=null})),!i)throw new Error("failed to upload files to fcs");is("posted"===n?"PUBLISHING...":"draft"===n?"SAVING AS A DRAFT...":"scheduled"===n?"SCHEDULING...":null),await k().default(300),await v().iframeBus.send("schedule.fcs-submit-composer"),rs()}({action:e,post:t})}catch(e){if(s>=2)throw e;return void await n()}await k().default(200);if((null===(a=C().model.state.bulk.actions[t.id])||void 0===a?void 0:a.failed)||!1){if(s>=2)throw new Error("failed to apply bulk action");C().transaction((e=>{e.bulk.actions[t.id].failed=!1})),await n()}}function os(e){C().transaction((t=>{t.schedule.addCard.savingPreview=e}))}function is(e){C().transaction((t=>{t.schedule.addCard.savingTitle=e}))}function rs(){const e=rs;e.executing||(clearTimeout(e.timeout),e.timeout=setTimeout((async()=>{e.executing=!0,await v().iframeBus.send("schedule.fcs-refresh-data"),e.executing=!1}),1e3))}function ls(e,t){const s=e.indexOf(t);-1===s?e.push(t):e.splice(s,1)}g(),p(),C(),g(),p(),C(),g(),p(),P(),K(),C();class cs extends g().default.Component{constructor(e){var t;super(e),this._onClick=({withShift:e})=>{if(this._blinkAddCardIfSaving())return;if(this.props.post.saveStatus)return;const t=this.props.post.id,s=cs.lastClickedPostId;C().transaction((a=>{if(!(e&&s&&s!==t))return void ls(a.bulk.selectedPostIds,t);const n=$().default.getPosts({applyGridFilters:!0}).map((e=>e.id)),o=n.indexOf(t),i=n.indexOf(s);if(-1===o||-1===i)return;const r=o<i?n.slice(o,i+1):n.slice(i,o+1),l=e=>a.bulk.selectedPostIds.includes(e),c=r.every(l),d=l(s);a.bulk.selectedPostIds=d&&!c?a.bulk.selectedPostIds.concat(r).filter(P().default):a.bulk.selectedPostIds.filter((e=>!r.includes(e)))})),cs.lastClickedPostId=t},this._onEditClick=()=>{this._blinkAddCardIfSave()||this._blinkAddCardIfSaving()||this.props.post.saveStatus||na.openPost(this.props.post)},this._onCaptionChange=e=>{this._blinkAddCardIfSaving()||this.props.post.saveStatus||(this.setState({caption:e}),clearTimeout(this.updateCaptionTimeout),this.updateCaptionTimeout=this.setTimeout((()=>{C().transaction((t=>{const s=this.props.post.id,a=t.schedule.posts.find((e=>e.id===s)),n=t.bulk.actions[s]||{};a.caption===e?delete n.caption:n.caption=e,0===Object.keys(n).length?delete t.bulk.actions[s]:t.bulk.actions[s]=n}))}),400))},this._onDragStart=()=>{this._blinkAddCardIfSaving()||this.props.post.saveStatus||_a.onDragStart(this)},this._onDragEnd=()=>{this._blinkAddCardIfSaving()||this.props.post.saveStatus||_a.onDragEnd(this)},this._onDragEnter=()=>{this._blinkAddCardIfSaving()||this.props.post.saveStatus||_a.onDragEnter(this)},this.captionChangeTimeout=null,this.state={caption:(null===(t=e.action)||void 0===t?void 0:t.caption)||e.post.caption||"",dragPost:null}}componentDidUpdate(e){var t,s;const a=e,n=this.props,o=(null===(t=a.action)||void 0===t?void 0:t.caption)||a.post.caption||"",i=(null===(s=n.action)||void 0===s?void 0:s.caption)||n.post.caption||"";o!==i&&this.state.caption!==i&&this.setState({caption:i})}render(){const e=this._getCaption();return Glamor.createElement(p().default.BulkPost,{caption:e,changed:!!this.props.action,selected:this.state.dragPost?null:this.props.selected,canDrag:this._canDrag(),postImage:this._getPost().preview,postPreview:this._constructPostPreview(),charsLeft:this._getCharsLeft(e),hashtagsLeft:this._getHashtagsLeft(e),mentionsLeft:this._getMentionsLeft(e),onClick:this._onClick,onEditClick:this._onEditClick,onCaptionChange:this._onCaptionChange,onDragStart:this._onDragStart,onDragEnter:this._onDragEnter,onDragEnd:this._onDragEnd})}_getCaption(){const e=this.state.dragPost;return e?e.caption:this.state.caption}_canDrag(){return"posted"!==this.props.post.status}_getPost(){return this.state.dragPost||this.props.post}_getCharsLeft(e){return 2200-e.length}_getHashtagsLeft(e){const t=K().default();return 30-(e.match(t)||[]).length}_getMentionsLeft(e){return 30-(e.match(/@\w+/g)||[]).length}_constructPostPreview(){return Glamor.createElement(Ea,{post:this.props.post,dragPost:this.state.dragPost})}_blinkAddCardIfSave(){return"save"===$().default.getAddCardStatus()&&(na.blinkAddCardAttention(),!0)}_blinkAddCardIfSaving(){return!!$().default.isSaving()&&(na.blinkAddCardAttention(),!0)}}cs.lastClickedPostId=null;var ds=C().influx(((e,t)=>{const s=t.post.id;return{selected:e.bulk.selectedPostIds.includes(s),action:e.bulk.actions[s]||null}}))(cs);class us extends g().default.Component{render(){return Glamor.createElement(p().default.BulkGrid,{animatePostsOrder:!this.props.dragging,posts:this._getPosts()})}_getPosts(){return this.props.posts.map(((e,t)=>({id:e.id,element:Glamor.createElement(ds,{post:e})})))}}var hs=C().influx((e=>({posts:$().default.getPosts({applyGridFilters:!0}),dragging:e.schedule.isDraggingPost})))(us);g(),p(),w(),C(),g(),p(),Z(),Y(),w(),C(),g(),w(),C();class ms extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onFrequencyChange=e=>{C().transaction((t=>{t.bulk.dateDialog.interval.frequency=e,t.bulk.dateDialog.interval.timeList=this._buildTimeList(t,e)}))},t}componentDidMount(){C().transaction((e=>{const t=e.bulk.dateDialog.interval.frequency;e.bulk.dateDialog.interval.timeList=this._buildTimeList(e,t)}))}render(){return Glamor.createElement(g().default.Range,{selectedOption:this.props.frequency,options:[{value:"1:7",label:"one post every 7 days"},{value:"1:3",label:"one post every 3 days"},{value:"1:2",label:"one post every 2 days"},{value:"1:1",label:"one post a day"},{value:"2:1",label:"2 posts a day"},{value:"3:1",label:"3 posts a day"}],onChange:this._onFrequencyChange})}_buildTimeList(e,t){const s=e.schedule.timeSlots,a=e.bulk.dateDialog.interval.timeList;return Array.from(Array(3)).map(((e,t)=>{var n;return a[t]||{errorMessage:null,selectedSlotTime:(null===(n=s[t])||void 0===n?void 0:n.time)||null,customTime:0===t?13*w().HOUR:1===t?16*w().HOUR:2===t?20*w().HOUR:null}}))}}var gs=C().influx((e=>({frequency:e.bulk.dateDialog.interval.frequency})))(ms);g(),p(),C();class ps extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onSlotChange=e=>{C().transaction((t=>{const s=t.bulk.dateDialog.interval.timeList[this.props.index];s.selectedSlotTime=e,s.errorMessage=null}))},this._onCustomTimeInput=()=>{C().transaction((e=>{e.bulk.dateDialog.interval.timeList[this.props.index].errorMessage=null}))},this._onCustomTimeChange=e=>{C().transaction((t=>{const s=t.bulk.dateDialog.interval.timeList[this.props.index];s.customTime=e,s.errorMessage=null}))},t}render(){return Glamor.createElement(p().default.ScheduleTimePicker,{label:this._getLabel(),timezone:this.props.timezone,errorMessage:this.props.errorMessage,slots:this.props.slots,selectedSlot:this.props.selectedSlotTime,customTime:this.props.customTime,onSlotChange:this._onSlotChange,onCustomTimeInput:this._onCustomTimeInput,onCustomTimeChange:this._onCustomTimeChange})}_getLabel(){return 0===this.props.index?"time to schedule at":1===this.props.index?"2nd time to schedule at":2===this.props.index?"3rd time to schedule at":null}}var fs=C().influx(((e,t)=>{const s=e.bulk.dateDialog.interval.timeList[t.index];return{slots:e.schedule.timeSlots,timezone:e.schedule.dateDialog.timezone,customTime:(null==s?void 0:s.customTime)||null,selectedSlotTime:(null==s?void 0:s.selectedSlotTime)||null,errorMessage:(null==s?void 0:s.errorMessage)||null}}))(ps);g(),p(),C();class Cs extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onDayClick=e=>{C().transaction((t=>{ls(t.bulk.dateDialog.week.selectedDays,e),t.bulk.dateDialog.week.dayErrorMessage=null}))},t}render(){return Glamor.createElement(p().default.ScheduleWeekdayPicker,{selectedDays:this.props.selectedDays,errorMessage:this.props.errorMessage,onDayClick:this._onDayClick})}}var vs=C().influx((e=>({selectedDays:e.bulk.dateDialog.week.selectedDays,errorMessage:e.bulk.dateDialog.week.dayErrorMessage})))(Cs);g(),p(),C();class bs extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onSlotChange=e=>{C().transaction((t=>{t.bulk.dateDialog.week.selectedSlotTime=e,t.bulk.dateDialog.week.timeErrorMessage=null}))},this._onCustomTimeInput=()=>{C().transaction((e=>{e.bulk.dateDialog.week.timeErrorMessage=null}))},this._onCustomTimeChange=e=>{C().transaction((t=>{t.bulk.dateDialog.week.customTime=e,t.bulk.dateDialog.week.timeErrorMessage=null}))},t}render(){return Glamor.createElement(p().default.ScheduleTimePicker,{label:"time to schedule",timezone:this.props.timezone,errorMessage:this.props.errorMessage,slots:this.props.slots,selectedSlot:this.props.selectedSlotTime,customTime:this.props.customTime,onSlotChange:this._onSlotChange,onCustomTimeInput:this._onCustomTimeInput,onCustomTimeChange:this._onCustomTimeChange})}}var ks=C().influx((e=>({slots:e.schedule.timeSlots,timezone:e.schedule.dateDialog.timezone,customTime:e.bulk.dateDialog.week.customTime,selectedSlotTime:e.bulk.dateDialog.week.selectedSlotTime,errorMessage:e.bulk.dateDialog.week.timeErrorMessage})))(bs);g(),p(),w(),C();class ws extends g().default.Component{constructor(e){super(e),this._onDaySelect=e=>{C().transaction((t=>{t.bulk.dateDialog.calendar.selectedDay=e,t.bulk.dateDialog.calendar.errorMessage=null}))},this._onPeriodStartChange=e=>{C().transaction((t=>{t.bulk.dateDialog.calendar.periodStart=e}))};const t=Date.now(),s=Se.getConfig().fcs;this.maxDay=t+s.MAX_DAYS_FROM_NOW*w().DAY,this.tomorrow=t+w().DAY}render(){return Glamor.createElement(p().default.ScheduleDatePicker,{periodStart:this.props.periodStart||this.tomorrow,maxDay:this.maxDay,selectedDay:this.props.selectedDay,onDaySelect:this._onDaySelect,onPeriodStartChange:this._onPeriodStartChange})}}var Ss=C().influx((e=>({periodStart:e.bulk.dateDialog.calendar.periodStart,selectedDay:e.bulk.dateDialog.calendar.selectedDay})))(ws);g(),p(),C();class _s extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onSlotChange=e=>{C().transaction((t=>{t.bulk.dateDialog.calendar.selectedSlotTime=e,t.bulk.dateDialog.calendar.errorMessage=null}))},this._onCustomTimeInput=()=>{C().transaction((e=>{e.bulk.dateDialog.calendar.errorMessage=null}))},this._onCustomTimeChange=e=>{C().transaction((t=>{t.bulk.dateDialog.calendar.customTime=e}))},t}render(){return Glamor.createElement(p().default.ScheduleTimePicker,{label:"time to publish",timezone:this.props.timezone,errorMessage:this.props.errorMessage,slots:this.props.slots,selectedSlot:this.props.selectedSlotTime,customTime:this.props.customTime,onSlotChange:this._onSlotChange,onCustomTimeInput:this._onCustomTimeInput,onCustomTimeChange:this._onCustomTimeChange})}}var ys=C().influx((e=>({timezone:e.schedule.dateDialog.timezone,slots:e.schedule.timeSlots,selectedSlotTime:e.bulk.dateDialog.calendar.selectedSlotTime,customTime:e.bulk.dateDialog.calendar.customTime,errorMessage:e.bulk.dateDialog.calendar.errorMessage})))(_s);g(),p(),J(),w(),C();class Ts extends g().default.Component{constructor(e){super(e),this._onTypeChange=e=>{C().transaction((t=>{t.bulk.dateDialog.startingDay.selectedTypeId=e.id}))},this._onDaySelect=e=>{C().transaction((t=>{t.bulk.dateDialog.startingDay.selectedDay=e}))},this._onPeriodStartChange=e=>{C().transaction((t=>{t.bulk.dateDialog.startingDay.periodStart=e}))};const t=Date.now(),s=Se.getConfig().fcs;this.maxDay=t+s.MAX_DAYS_FROM_NOW*w().DAY}render(){return Glamor.createElement(g().default.Fragment,null,this._constructTypeDropdown(),this._constructDatePicker())}_constructTypeDropdown(){const e=Date.now(),t=this.props.lastPost,s=this.props.selectedTypeId,a=!!(t&&t.on>e),n=!!(t&&t.on+1*w().DAY>e);("last-post"===s&&!a||"last-post-next-day"===s&&!n)&&C().transaction((e=>{e.bulk.dateDialog.startingDay.selectedTypeId="today"}));const o=[{id:"today",label:"Today",selected:"today"===this.props.selectedTypeId},{id:"tomorrow",label:"Tomorrow",selected:"tomorrow"===this.props.selectedTypeId},a&&{id:"last-post",label:`${J().default(t.on,"MMMM d")}, day of the last post`,selected:"last-post"===this.props.selectedTypeId},n&&{id:"last-post-next-day",label:J().default(t.on+1*w().DAY,"MMMM d"),selected:"last-post-next-day"===this.props.selectedTypeId},{id:"custom",label:"Custom date",selected:"custom"===this.props.selectedTypeId}];return Glamor.createElement(g().default.Dropdown,{label:"starting day",items:o.filter(Boolean),menuStyle:g().default.fullWidth,isMenuAtTheTop:!0,onChange:this._onTypeChange})}_constructDatePicker(){return"custom"!==this.props.selectedTypeId?null:Glamor.createElement(g().default.Fragment,null,Glamor.createElement(g().default.Spacer,{height:"g2"}),Glamor.createElement(p().default.ScheduleDatePicker,{periodStart:this.props.periodStart,maxDay:this.maxDay,selectedDay:this.props.selectedDay,onDaySelect:this._onDaySelect,onPeriodStartChange:this._onPeriodStartChange}))}}var Es=C().influx((e=>({selectedTypeId:e.bulk.dateDialog.startingDay.selectedTypeId,periodStart:e.bulk.dateDialog.startingDay.periodStart,selectedDay:e.bulk.dateDialog.startingDay.selectedDay,lastPost:$().default.getLastPost()})))(Ts);class Ps extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onTypeChange=e=>{C().transaction((t=>{t.bulk.dateDialog.selectedTypeId=e,t.bulk.dateDialog.timeSlots.errorMessage=null}))},this._onApplyClick=()=>{"calendar"===this.props.view?this._applyCalendar():"interval"===this.props.view?this._applyInterval():"week"===this.props.view?this._applyWeek():"timeSlots"===this.props.view&&this._applyTimeSlots()},this._applyCalendar=()=>{C().transaction((e=>{const t=e.bulk.dateDialog.calendar,s=Y().default(t.selectedDay).getTime(),a=t.selectedSlotTime||t.customTime||null,n=a?s+a:null,o=this._getMinOn();!n||n<=o?t.errorMessage="should be at least 10 minutes from now":this._apply(e,{getNextOn:()=>n})}))},this._applyInterval=()=>{C().transaction((e=>{const t=e.bulk.dateDialog.interval,s=t.frequency.split(":"),a=Number(s[0]),n=Number(s[1]);let o,i=!1,r=[];if(t.timeList.slice(0,a).forEach(((e,t)=>{const s=e.selectedSlotTime||e.customTime;"number"==typeof s?r.push(s):(e.errorMessage="select time",i=!0)})),i)return;r=r.sort(((e,t)=>e-t));let l=0,c=0;const d=$().default.getBulkStartingDay(),u=this._getMinOn(),h=()=>(o=d+l*w().DAY+r[c],c+=1,c===r.length&&(c=0,l+=n),o<=u?h():o);this._apply(e,{getNextOn:h})}))},this._applyWeek=()=>{C().transaction((e=>{const t=e.bulk.dateDialog.week,s=t.selectedDays;if(0===s.length)return void(t.dayErrorMessage="select at least one day");const a=t.selectedSlotTime||t.customTime;if("number"!=typeof a)return void(t.timeErrorMessage="select time");let n,o=0,i=0;const r=$().default.getBulkStartingDay(),l=this._getMinOn(),c=()=>{const e=s[o]-Z().default(r);return n=r+e*w().DAY+i*w().WEEK+a,o+=1,o===s.length&&(o=0,i+=1),n<=l||n<r?c():n};this._apply(e,{getNextOn:c})}))},this._applyTimeSlots=()=>{C().transaction((e=>{const t=e.schedule.timeSlots.map((e=>e.time));if(0===t.length)return void(e.bulk.dateDialog.timeSlots.errorMessage="you have no time slots");let s,a=0,n=0;const o=$().default.getBulkStartingDay(),i=this._getMinOn(),r=()=>(s=o+n*w().DAY+t[a],a+=1,a===t.length&&(a=0,n+=1),s<=i?r():s);this._apply(e,{getNextOn:r})}))},this._apply=(e,{getNextOn:t})=>{const s=$().default.getOrderedSelectedPostIds();for(const a of s){const s=e.bulk.actions[a]||{},n=e.schedule.posts.find((e=>e.id===a)),o=t();"scheduled"===n.status&&n.on===o?(delete s.on,delete s.status):(s.on=o,s.status="scheduled"),0===Object.keys(s).length?delete e.bulk.actions[a]:e.bulk.actions[a]=s}e.bulk.selectedPostIds=[],e.bulk.dateDialog.show=!1},this._getMinOn=()=>{const e=Se.getConfig().fcs;return Date.now()+e.MIN_MINUTES_FROM_NOW*w().MINUTE},t}render(){return Glamor.createElement(p().default.BulkDateDialog,{view:this.props.view,typeErrorMessage:this.props.typeErrorMessage,intervalFrequency:Glamor.createElement(gs,null),intervalTimePickerList:this._getIntervalTimePickerList(),weekWeekdayPicker:Glamor.createElement(vs,null),weekTimePicker:Glamor.createElement(ks,null),calendarDatePicker:Glamor.createElement(Ss,null),calendarTimePicker:Glamor.createElement(ys,null),startingDayPicker:Glamor.createElement(Es,null),onTypeChange:this._onTypeChange,onApplyClick:this._onApplyClick})}_getIntervalTimePickerList(){const e=Number(this.props.frequency.split(":")[0]);return Array.from(Array(e)).map(((e,t)=>({id:t,element:Glamor.createElement(fs,{index:t})})))}}var As=C().influx((e=>{let t;t=1===e.bulk.selectedPostIds.length?"calendar":e.bulk.dateDialog.selectedTypeId;let s=null;return"timeSlots"===t&&(s=e.bulk.dateDialog.timeSlots.errorMessage),{view:t,frequency:e.bulk.dateDialog.interval.frequency,typeErrorMessage:s}}))(Ps);class Is extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onSelectAllClick=()=>{C().transaction((e=>{const t=e.bulk.selectedPostIds.some((t=>"posted"===e.schedule.posts.find((e=>e.id===t)).status));e.bulk.selectedPostIds=t?$().default.getPosts({applyGridFilters:!0}).map((e=>e.id)):$().default.getPosts({applyGridFilters:!0}).filter((e=>"posted"!==e.status)).map((e=>e.id))}))},this._onUnselectAllClick=()=>{C().transaction((e=>{e.bulk.selectedPostIds=[]}))},this._onScheduleClick=()=>{C().transaction((e=>{e.bulk.dateDialog.show=!e.bulk.dateDialog.show}))},this._onPublishNowClick=()=>{C().transaction((e=>{$().default.getOrderedSelectedPostIds().forEach(((t,s)=>{const a=e.schedule.posts.find((e=>e.id===t)),n=e.bulk.actions[t]||{};"posted"===a.status?(delete n.status,delete n.on):(n.status="posted",n.on=Date.now()+1*w().MINUTE+s),0===Object.keys(n).length?delete e.bulk.actions[t]:e.bulk.actions[t]=n})),e.bulk.selectedPostIds=[]}))},this._onSaveAsDraftClick=()=>{C().transaction((e=>{for(const t of e.bulk.selectedPostIds){const s=e.schedule.posts.find((e=>e.id===t)),a=e.bulk.actions[t]||{};"fcs"===s.source&&"draft"===s.status?delete a.status:a.status="draft",0===Object.keys(a).length?delete e.bulk.actions[t]:e.bulk.actions[t]=a}e.bulk.selectedPostIds=[]}))},this._onDeleteClick=()=>{C().transaction((e=>{for(const t of e.bulk.selectedPostIds){const s=e.bulk.actions[t]||{};s.delete=!0,e.bulk.actions[t]=s}e.bulk.selectedPostIds=[]}))},this._onOutOfDateDialogClick=()=>{C().model.state.bulk.dateDialog.show&&C().transaction((e=>{e.bulk.dateDialog.show=!1}))},t}render(){return Glamor.createElement(p().default.BulkActionBar,{dateDialog:Glamor.createElement(As,null),showDateDialog:this.props.showDateDialog,selectedPostCount:this.props.selectedPostCount,disableSaveButtons:this.props.disableSaveButtons,onSelectAllClick:this._onSelectAllClick,onUnselectAllClick:this._onUnselectAllClick,onScheduleClick:this._onScheduleClick,onPublishNowClick:this._onPublishNowClick,onSaveAsDraftClick:this._onSaveAsDraftClick,onDeleteClick:this._onDeleteClick,onOutOfDateDialogClick:this._onOutOfDateDialogClick})}}var xs=C().influx((e=>{const t=e.bulk.selectedPostIds.some((t=>{const s=e.schedule.posts.find((e=>e.id===t));return!!s&&"posted"===s.status}));return{showDateDialog:e.bulk.dateDialog.show,selectedPostCount:e.bulk.selectedPostIds.length,disableSaveButtons:t}}))(Is);class Ds extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onUpsellOverlayClick=()=>{C().transaction((e=>{e.schedule.isUpsellShown=!1}))},this._onCloseClick=()=>{C().transaction((e=>{e.schedule.navigation.isOpen=!1}))},t}render(){return Glamor.createElement(p().default.BulkScreen,{loading:this.props.addingFiles,addCard:Glamor.createElement(za,null),controls:Glamor.createElement(Ga,null),grid:Glamor.createElement(hs,null),actionBar:Glamor.createElement(xs,null),showActionBar:this.props.showActionBar,upsellOverlay:this._constructUpsellOverlay(),onCloseClick:this._onCloseClick})}_constructUpsellOverlay(){return Glamor.createElement(mt,{show:this.props.showUpsell,onOverlayClick:this._onUpsellOverlayClick,feature:"bulk"})}}var Gs=C().influx((e=>({showUpsell:e.schedule.isUpsellShown,showActionBar:e.bulk.selectedPostIds.length>0,addingFiles:e.schedule.addingFiles})))(Ds);$(),Q(),q(),X(),Y(),C(),v(),$();var Fs={init:function(){v().iframeBus.on("schedule.fcs-date-dialog-toggled",(async e=>{C().transaction((t=>{t.schedule.dateDialog.isOpen=e}));const t=await v().iframeBus.send("schedule.fcs-date-dialog-get-timezone");C().transaction((e=>{e.schedule.dateDialog.timezone=t}))})),v().iframeBus.on("schedule.fcs-date-dialog-invalid-time",(()=>{C().transaction((e=>{e.schedule.dateDialog.isTimeError=!0}))}))},actualizeDataForIframe:async function(){const e=C().model.state.schedule.dateDialog,t=$().default.getDateDialogSelectedDay();let s;s=e.selectedSlotTime?Y().default(t).getTime()+e.selectedSlotTime:e.customTime?Y().default(t).getTime()+e.customTime:null;await v().iframeBus.send("schedule.fcs-date-dialog-set-publish-time",s),await v().iframeBus.send("schedule.fcs-date-dialog-set-selected-option",e.selectedOption)}};var Os=document.documentElement;C();var Bs={init:function(){Os.addEventListener("dragenter",Ls),Os.addEventListener("dragover",Ms),Os.addEventListener("drop",Rs)}};const Us={dragLeaveTimer:null};function Ls(e){Ns()&&(e.preventDefault(),clearTimeout(Us.dragLeaveTimer),"Files"===e.dataTransfer.types[0]&&C().transaction((e=>{e.schedule.addCard.draggingFiles=!0})))}function Ms(e){Ns()&&(e.preventDefault(),clearTimeout(Us.dragLeaveTimer),"Files"===e.dataTransfer.types[0]&&(C().transaction((e=>{e.schedule.addCard.draggingFiles=!0})),Us.dragLeaveTimer=setTimeout((()=>{C().transaction((e=>{e.schedule.addCard.draggingFiles=!1}))}),50)))}function Rs(e){Ns()&&(e.preventDefault(),clearTimeout(Us.dragLeaveTimer),setTimeout((()=>{C().transaction((e=>{e.schedule.addCard.draggingFiles=!1}))})))}function Ns(){const e=C().model.state;return e.sidebar.isOpen&&"tab-scheduling"===e.sidebar.selectedTabId}E(),O(),w(),m(),V(),C(),Q(),q(),$();const zs={mimeTypes:["image/jpeg","image/png","video/quicktime","video/mp4","video/webm","text/csv"],maxPostCount:150,maxFileSize:524288e3,maxFileSizeStr:"500MB",minVideoDurationSec:3,maxVideoDurationSec:60,minVideoRatio:.8,maxVideoRatio:1.778};let Hs;const Vs={selectedFiles:[]};var Ws={init:function(){Hs=Se.getConfig().fcs,function(){const e={};let t=!1,s=!1;C().model.observe((e=>e.schedule.posts.filter((e=>"local"===e.source)).map((e=>e.id)).join("-")),(async function a(){if(t)return void(s=!0);t=!0;const n=C().model.state.schedule.posts.filter((e=>"local"===e.source));for(const t of n){if(e[t.id])continue;const s=`schedule.local-post:${t.id}`,a=await O().default((()=>V().idbController.get(s)));if(!a)continue;const n=URL.createObjectURL(a.previewBlob);e[t.id]=n}C().transaction((t=>{for(const s of t.schedule.posts)"local"===s.source&&(s.image=e[s.id],s.preview=e[s.id])})),t=!1,s&&(s=!1,a())}))}()},config:zs,chooseFiles:function(e){if(!C().model.state.authStatus.userId)return;const t=document.createElement("input");t.setAttribute("type","file"),t.setAttribute("multiple",!0),t.setAttribute("accept",zs.mimeTypes.join(", ")),t.addEventListener("change",(async t=>{t.preventDefault();const s=Array.from(t.target.files);e(s)}),{once:!0}),t.click()},selectFiles:function(e){Vs.selectedFiles=e,C().transaction((t=>{t.schedule.addCard.fileCount=e.length}));!e.some((e=>"text/csv"===e.type))&&e.length>1&&e.length<=10?C().transaction((t=>{t.schedule.addCard.fileCount=e.length})):$s(e,{isCarousel:!1})},addFiles:$s,addSelectedFiles:function({isCarousel:e}){$s(Vs.selectedFiles,{isCarousel:e})},getPostFiles:async function(e){const t=await O().default((()=>async function(e){const t=`schedule.local-post:${e}`;return await V().idbController.get(t)||null}(e)));if(!t)return[];return t.files||[]}};async function $s(e,{isCarousel:t,postMode:s=null}){const a=$s;if(a.running)return;a.running=!0,C().transaction((e=>{e.schedule.addingFiles=!0,e.schedule.addCard.fileCount=0}));let n=[],o=C().model.state.schedule.posts.filter((e=>"local"===e.source)).length;const i=[];for(const t of e)if("text/csv"===t.type)try{const e="{{__csv-quote__}}",s="{{__csv-br__}}",a=URL.createObjectURL(t),r=await fetch(a);let l=await r.text();l=l.split('""').join(e);const c=[];let d=!1;l.split("").forEach(((e,t)=>{'"'!==e?d&&"\n"===e?c.push(s):c.push(e):d=!d})),l=c.join("");const u=Ys(l),h=Xs(u.flat());for(const t of u){const a=Ks(t);if(0===a.length)continue;const r=[];for(const e of a){const t=await fetch(e),s=await t.blob(),a=t.url.split("/").pop().split("?")[0],n=new File([s],a,{type:s.type}),l=await qs(n);if(l)i.push({file:n,error:l});else if(o+=1,o>zs.maxPostCount)i.push({file:n,error:"post-count-limit-reached"});else if(r.push(n),r.length>=10)break}0!==r.length&&n.push({id:E().generate(),files:r,on:Qs(t,h),preview:await q().default(r[0]),caption:Zs(t).split(e).join('"').split(s).join("\n").split("\\n").join("\n")})}}catch(e){console.error(e),i.push({file:t,error:"failed-to-read-csv"})}else{const e=await qs(t);if(e){i.push({file:t,error:e});continue}if(o+=1,o>zs.maxPostCount){i.push({file:t,error:"post-count-limit-reached"});continue}n.push({id:E().generate(),files:[t],preview:await q().default(t),caption:""})}if(t&&(n=[{id:n[0].id,files:n.map((e=>e.files)).flat(),preview:n[0].preview,caption:""}]),C().transaction((e=>{e.schedule.fileUploadErrors=i.map((e=>({type:e.error,filename:e.file.name})))})),0===n.length)return C().transaction((e=>{e.schedule.addingFiles=!1})),void(a.running=!1);for(const e of n)try{await js(e.id,{id:e.id,files:e.files,previewBlob:e.preview.blob})}catch(t){C().transaction((t=>{e.files.map((e=>{t.schedule.fileUploadErrors.push({type:"unknown",filename:e.name})}))}))}const r=Date.now();C().transaction((e=>{n.reverse().forEach(((t,s)=>{let a;a=t.files.length>1?"carousel":t.files[0].type.startsWith("video/")?"video":"photo",e.schedule.posts.push(Q().default({id:t.id,source:"local",type:a,status:"draft",image:null,preview:null,imageAvgColor:t.preview.averageColor,on:null,createdOn:Date.now(),stats:null,crosspostToFb:null,saveStatus:null,draftOrder:r+s,caption:t.caption||""})),t.on&&(e.bulk.actions[t.id]={on:t.on,status:"scheduled"})}))})),C().transaction((e=>{e.schedule.addingFiles=!1})),a.running=!1,m().gaController.sendEvent("user","schedule:add-files",`${t?"carousel":"posts"}-${e.length}`);const l=n.map((e=>e.id));if(!$().default.isBulkScreen()&&1===l.length&&(t||1===e.length)){const e=$().default.getPosts().find((e=>e.id===l[0]));e&&await na.openPost(e,{postMode:s})}return l}async function qs(e){if(e.size>zs.maxFileSize)return"file-size-limit-reached";if(!zs.mimeTypes.includes(e.type))return"unsupported-type";if(!e.type.startsWith("video/"))return null;let t;try{t=await new Promise(((t,s)=>{const a=document.createElement("video");a.src=URL.createObjectURL(e),a.preload="metadata",a.addEventListener("loadedmetadata",(()=>{URL.revokeObjectURL(a.src),t({duration:a.duration,width:a.videoWidth,height:a.videoHeight})})),a.addEventListener("error",(()=>{s(a.error)}))}))}catch(t){return console.error("failed to load metadata",{file:e,details:t}),"unknown"}if(0===t.width&&0===t.height)return"unsupported-codec";if(t.duration<zs.minVideoDurationSec||t.duration>zs.maxVideoDurationSec)return"unsupported-duration";const s=t.width/t.height;return s<zs.minVideoRatio||s>zs.maxVideoRatio?"unsupported-ratio":null}async function js(e,t){const s=`schedule.local-post:${e}`;await V().idbController.set(s,t)}function Ys(e){const t=[",",";","\t","|"];let s=null,a=0;for(const n of t){const t=e.split(n).length;(!s||t>a)&&(s=n,a=t)}return e.split("\n").map((e=>e.split(s)))}function Ks(e){return e.map(sa).flat()}function Zs(e){const t=[...e].sort(((e,t)=>{const s=Js(e),a=Js(t);return s&&a?t.length-e.length:s?-1:a?1:null}))[0];return Js(t)?t:""}function Js(e){if(sa(e).length>0)return!1;const t=e.replace(/\D/g,"").length;return!(t>2&&t/e.length>.5)}function Qs(e,t){for(const s of e){const e=ea(s,t);if(e)return e}return null}function Xs(e){const t=e.map(ta).filter(Boolean);for(const e of t){if(e[1]>11)return!0;if(e[0]>11)return!1}return!1}function ea(e,t=!1){var s;if(sa(e).length>0)return null;const a=(e=e.toLowerCase()).includes("today"),n=e.includes("tomorrow"),o=ta(e)||null;if(!a&&!n&&!o)return null;let i,r,l,c,d;if(o)i=t?o[1]:o[0],r=t?o[0]:o[1],l=o[2];else if(a){var u;const t=Date.now(),s=(null===(u=e.match(/today ?\+ ?(\d+)/))||void 0===u?void 0:u[1])||0,a=new Date(t+s*w().DAY);i=a.getDate(),r=a.getMonth()+1,l=a.getFullYear()}else if(n){var h;const t=Date.now()+1*w().DAY,s=(null===(h=e.match(/tomorrow ?\+ ?(\d+)/))||void 0===h?void 0:h[1])||0,a=new Date(t+s*w().DAY);i=a.getDate(),r=a.getMonth()+1,l=a.getFullYear()}const m=(null===(s=e.match(/\d{1,2}:\d{2}/))||void 0===s?void 0:s[0])||"";if(m){const t=m.split(":").map(Number);c=t[0],d=t[1];(/[\d ]pm /.test(e)||/[\d ]pm$/.test(e))&&c<12&&(c+=12)}const g=new Date;i&&g.setDate(i),r&&g.setMonth(r-1),l&&g.setYear(l),c&&g.setHours(c),d&&g.setMinutes(d);const p=g.getTime(),f=Date.now()+Hs.MIN_MINUTES_FROM_NOW*w().MINUTE,C=Date.now()+Hs.MAX_DAYS_FROM_NOW*w().DAY;return p<f||p>C?null:p}function ta(e){const t=e.match(/(\d{1,2})[./](\d{2})[./]?(\d{2,4})?/)||null;if(!t)return null;const s=Number(t[1]),a=Number(t[2]);if(s>31||a>31)return null;if(0===s||0===a)return null;let n=Number(t[3])||null;n<2e3&&(n+=2e3);return n>(new Date).getFullYear()+1?null:[s,a,n]}function sa(e){return e.trim().split(/\s+/g).filter(aa)}function aa(e){return e.trim().startsWith("http://")||e.trim().startsWith("https://")}var na={init:function(){v().iframeBus.on("schedule.get-ig-username",ra),v().iframeBus.on("schedule.show-upsell",ga),v().iframeBus.on("schedule.is-fallback-enabled",va),v().iframeBus.on("schedule.has-pro",la),v().iframeBus.on("schedule.get-post",ca),v().iframeBus.on("schedule.is-creating-post",da),v().iframeBus.on("schedule.delete-post",ua),v().iframeBus.on("schedule.apply-fcs-posts",ha),v().iframeBus.on("schedule.fcs-connection-status",ma),v().iframeBus.on("schedule.fcs-notification-error-appeared",pa),v().iframeBus.on("schedule.fcs-critical-error",Ca),v().iframeBus.on("schedule.fcs-error",fa),Ws.init(),Bs.init(),Fs.init(),function(){let e,t=!1;C().model.observe((()=>$().default.isSaving()),(s=>{const a=t&&!s;t=s,a&&(C().transaction((e=>{e.schedule.addCard.saved=!0})),clearTimeout(e),e=setTimeout((()=>{C().transaction((e=>{e.schedule.addCard.saved=!1}))}),2*w().SECOND))}))}(),window.addEventListener("beforeunload",(e=>{$().default.isSavingOrNeedsSave()&&(e.returnValue="")})),C().model.observe((e=>e.authStatus.username),(e=>{e&&S().chromeBus.send("schedule.update-ig-posts")})),function(){const e=15*w().MINUTE;let t,s;C().model.observe((e=>e.schedule.lastIgPostsUpdateOn),(s=>{if(!s)return;const a=s+e-Date.now();clearTimeout(t),t=setTimeout((()=>{S().chromeBus.send("schedule.update-ig-posts")}),a)})),C().model.observe((e=>e.schedule.lastFcsPostsUpdateOn),(t=>{if(!t)return;const a=t+e-Date.now();clearTimeout(s),s=setTimeout((()=>{v().iframeBus.send("schedule.fcs-refresh-data")}),a)}))}(),C().model.observe((()=>b().stateProxy.hasPro()),(e=>{e&&C().transaction((e=>{e.schedule.isUpsellShown=!1}))})),function(){const e={};v().iframeBus.on("schedule.fcs-edit-post-request",(async({postId:t,status:s,on:a})=>{const n=C().model.state.schedule.posts.find((e=>e.id===t));n&&("draft"===n.status&&"draft"!==s&&function(e){b().stateProxy.hasProPaid()&&m().gaController.sendEvent("user","pro-paid-usage:schedule");C().transaction((t=>{t.billing.trial.schedule+=e}))}(1),m().gaController.sendEvent("user","schedule:save-post-click"),C().transaction((n=>{const o=n.schedule.posts.find((e=>e.id===t));"posted"===o.status||(o.on="posted"===s?Date.now():a),e[o.id]=o.status,o.status=s,o.saveStatus="saving",n.schedule.navigation.isOpen=!1,"scheduled"===s&&(n.schedule.recentScheduledOn=a)})))})),v().iframeBus.on("schedule.fcs-edit-post-response",(async({postId:t,status:s})=>{C().model.state.schedule.posts.find((e=>e.id===t))&&(C().transaction((a=>{const n=a.schedule.posts.find((e=>e.id===t)),o=e[n.id];delete e[n.id],"posted"!==o&&"posted"===s?(n.saveStatus="syncing",n.on=Date.now(),n.createdOn=Date.now()):n.saveStatus=null})),await k().default(2*w().SECOND),v().iframeBus.send("schedule.fcs-refresh-data"))}))}(),function(){const e={};v().iframeBus.on("schedule.fcs-create-post-request",(async({type:t,image:s,crosspostToFb:a,localPostId:n})=>{C().model.state.bulk.saving||m().gaController.sendEvent("user","schedule:save-post-click"),C().transaction((o=>{let i,r,l;"bulk"!==o.schedule.navigation.selectedTabId&&(o.schedule.navigation.isOpen=!1);const c=Date.now(),d=o.schedule.dateDialog;if("publish-now"===d.selectedOption)i=c,r="posted",l=c;else if("save-as-draft"===d.selectedOption)i=null,r="draft",l=c;else if("schedule"===d.selectedOption){const e=d.customTime||d.selectedSlotTime;i=d.selectedDay+e,r="scheduled",l=i,o.schedule.recentScheduledOn=i}if(n){const t=o.schedule.posts.find((e=>e.id===n));if(!t)return;e[s]=t.id;const d=o.bulk.actions[t.id];var u;if(d)delete o.bulk.actions[t.id],t.source="fcs",t.status=d.status||t.status,t.image=s,t.caption=null!==(u=d.caption)&&void 0!==u?u:t.caption,t.on=d.on||t.on,t.createdOn=c,t.stats={likes:0,comments:0},t.draftOrder=d.draftOrder||t.draftOrder;else t.source="fcs",t.status=r,t.image=s,t.on=i,t.createdOn=c,t.stats={likes:0,comments:0},t.crosspostToFb=a,t.saveStatus="saving","draft"!==r&&(t.draftOrder=l)}else{const n=E().generate();e[s]=n,o.schedule.posts.unshift({id:n,source:"fcs",type:t,status:r,image:s,preview:null,imageAvgColor:null,on:i,createdOn:c,stats:{likes:0,comments:0},crosspostToFb:a,saveStatus:"saving",draftOrder:l})}}))})),v().iframeBus.on("schedule.fcs-create-post-response",(async({image:t})=>{const s=e[t];if(!C().model.state.schedule.posts.find((e=>e.id===s)))return console.error("post was not found"),void v().iframeBus.send("schedule.fcs-refresh-data");delete e[t],C().transaction((e=>{e.schedule.posts.find((e=>e.id===s)).saveStatus="syncing"})),C().model.state.bulk.saving||(await k().default(2*w().SECOND),v().iframeBus.send("schedule.fcs-refresh-data"))}))}()},isSaving:function(){return $().default.isSaving()},addFiles:Ws.addFiles,chooseFiles:function(e){if($().default.isSavingOrNeedsSave())return void ia();Ws.chooseFiles(e)},toggleTab:function(e){const t=C().model.state;if(t.schedule.fcsSetup.checking)return;if(!t.schedule.fcsSetup.connected)return void wa();C().transaction((t=>{const s=t.schedule.navigation;s.selectedTabId===e&&s.isOpen?s.isOpen=!1:(s.isOpen=!0,s.selectedTabId=e)}))},openNewPost:oa,openPost:async function(e,{postMode:t=null,isRetry:s=!1}={}){if(ka())return void wa();if($().default.isSavingOrNeedsSave())return void ia();const a=$().default.getRecentScheduledOn();if(C().transaction((e=>{e.schedule.dateDialog.isOpen=!1})),"local"===e.source)return oa({postMode:t||(e.on?"schedule":"draft"),localPostId:e.id,localPostFiles:await Ws.getPostFiles(e.id)}),void(e.on?(ba({on:e.on}),Fs.actualizeDataForIframe()):ba({on:a,takeNextTimeSlot:!0}));C().transaction((e=>{e.schedule.navigation.isOpen=!0,e.schedule.navigation.selectedTabId=null,e.schedule.navigation.isFcsLoading=!0,e.schedule.navigation.withBackToCalendarButton=!1})),"scheduled"===e.status?(C().transaction((e=>{e.schedule.dateDialog.selectedOption="schedule"})),ba({on:e.on})):"draft"===e.status&&(C().transaction((e=>{e.schedule.dateDialog.selectedOption="save-as-draft"})),ba({on:a,takeNextTimeSlot:!0}));Fs.actualizeDataForIframe(),await k().default(200),await v().iframeBus.send("schedule.fcs-open-post",e.id),C().transaction((e=>{e.schedule.navigation.isFcsLoading=!1}))},commitPostChanges:async function(){if(!la())return void(C().model.state.schedule.navigation.isOpen?ga():ze.openBilling("schedule"));const e=C().model.state,t=Object.keys(e.bulk.actions).length;m().gaController.sendEvent("user","schedule:add-card-save-click",t);const s=Object.keys(e.bulk.actions).every((t=>{const s=e.schedule.posts.find((e=>e.id===t)),a=e.bulk.actions[t];return"local"===s.source&&!a.status}));b().stateProxy.hasProPaid()&&m().gaController.sendEvent("user","pro-paid-usage:schedule");C().transaction((e=>{e.bulk.saving=!0,e.bulk.selectedPostIds=[]})),await ss.applyBulkActions(),s?C().transaction((e=>{e.bulk.saving=!1,e.bulk.actions={}})):(C().transaction((e=>{e.schedule.addCard.savingTitle="SYNCING..."})),v().iframeBus.send("schedule.fcs-refresh-data"),W().eventBus.once("schedule.fcs-posts-applied",(()=>{C().transaction((e=>{e.bulk.saving=!1,e.bulk.actions={},e.schedule.addCard.savingTitle=null}))})))},cancelPostChanges:function(){ss.cancelBulkActions()},closeBodyPanel:function(){C().transaction((e=>{e.schedule.navigation.isOpen=!1})),setTimeout((()=>{C().transaction((e=>{e.schedule.navigation.selectedTabId=null}))}),200)},blinkAddCardAttention:ia};async function oa({postMode:e="publish",localPostId:t=null,localPostFiles:s=[]}={}){const a=C().model.state;t&&a.schedule.navigation.selectedPostId===t||(ka()?wa():$().default.isSavingOrNeedsSave()?ia():(C().transaction((t=>{t.schedule.navigation.isOpen=!0,t.schedule.navigation.isFcsLoading=!0,t.schedule.navigation.selectedTabId="post",t.schedule.navigation.withBackToCalendarButton=!1,t.schedule.dateDialog.isOpen=!1,t.schedule.dateDialog=X().default(t),t.schedule.dateDialog.selectedOption={publish:"publish-now",draft:"save-as-draft",schedule:"schedule"}[e]})),ba({on:$().default.getRecentScheduledOn(),takeNextTimeSlot:!0}),Fs.actualizeDataForIframe(),await v().iframeBus.send("schedule.fcs-open-new-post-form",{postMode:e,localPostId:t,localPostFiles:s}),C().transaction((e=>{e.schedule.navigation.isFcsLoading=!1}))))}function ia(){C().transaction((e=>{e.schedule.addCard.attention=!0})),setTimeout((()=>{C().transaction((e=>{e.schedule.addCard.attention=!1}))}),600)}function ra(){return C().model.state.authStatus.username}function la(){return b().stateProxy.hasPro({feature:"schedule"})}function ca(e){return C().model.state.schedule.posts.find((t=>t.id===e))}function da(){return"post"===C().model.state.schedule.navigation.selectedTabId}async function ua(e){const t=C().model.state.schedule.posts.find((t=>t.id===e));if(!t)return;m().gaController.sendEvent("user","schedule:delete-post-click"),C().transaction((t=>{t.schedule.navigation.isOpen=!1;t.schedule.posts.find((t=>t.id===e)).saveStatus="deleting"}));let s=null;if("local"===t.source)await k().default(1*w().SECOND);else{const t=await S().chromeBus.send("fb-api.fcs-delete-post",e);s=t.error||null}C().transaction((t=>{if(!s)return void(t.schedule.posts=t.schedule.posts.filter((t=>t.id!==e)));console.error("failed to delete post",s),t.schedule.fcsError="Failed to delete post",t.schedule.isErrorShown=!0;t.schedule.posts.find((t=>t.id===e)).saveStatus=null}))}async function ha(e){const t=ha;let s=e.map((e=>{const t=C().model.state.schedule.posts.find((t=>t.id===e.id)),s={IG_IMAGE:"photo",IG_VIDEO:"video",IG_CAROUSEL:"carousel"}[e.postType];if(!s)return null;const a={DRAFT:"draft",POSTED:"posted",SCHEDULED:"scheduled"}[e.postStatus];let n=null;"draft"!==a&&(n=1e3*e.scheduledOrLastAddedTimestamp);let o,i=null;return"posted"===a&&(i={likes:e.likeCount,comments:e.commentCount}),o="scheduled"===a?n:(null==t?void 0:t.draftOrder)||1e3*e.lastAddedTime,Q().default({id:e.id,source:"fcs",type:s,status:a,image:e.thumbnailSrc,preview:(null==t?void 0:t.preview)||null,imageAvgColor:(null==t?void 0:t.imageAvgColor)||null,on:n,createdOn:1e3*e.lastAddedTime,stats:i,crosspostToFb:(null==t?void 0:t.crosspostToFb)||!1,saveStatus:(null==t?void 0:t.saveStatus)||null,draftOrder:o,caption:e.description||""})})).filter(Boolean);s=s.filter((e=>!C().model.state.schedule.posts.find((t=>"syncing"===t.saveStatus&&t.id===e.id))));const a=[];{const e=C().model.state;for(const t of s){if(!!e.schedule.posts.find((e=>e.id===t.id)))continue;let s;const o=e.schedule.posts.filter((s=>{var a;const n=(null===(a=e.bulk.actions[s.id])||void 0===a?void 0:a.status)||s.status;return"syncing"===s.saveStatus&&s.type===t.type&&n===t.status}));if("photo"!==t.type)s=o[0]||null;else{var n;const e=[];for(const s of o)try{await new Promise(((a,n)=>{const o=setTimeout(n,7*w().SECOND);(async()=>{const[n,i,r]=await Sa(t.image),[l,c,d]=await Sa(s.image);clearTimeout(o),e.push({post:s,rgbDistance:Math.abs(n-l)+Math.abs(i-c)+Math.abs(r-d)}),a()})()}))}catch(t){e.push({post:s,rgbDistance:765})}e.sort(((e,t)=>e.rgbDistance-t.rgbDistance)),s=(null===(n=e[0])||void 0===n?void 0:n.post)||null}s&&(t.preview=s.preview,t.imageAvgColor=s.imageAvgColor,t.draftOrder=s.draftOrder,t.crosspostToFb=s.crosspostToFb,a.push(s.id))}}C().transaction((e=>{e.schedule.loading=!1,e.schedule.lastFcsPostsUpdateOn=Date.now(),e.schedule.posts=e.schedule.posts.filter((e=>!a.includes(e.id))).filter((e=>"ig"!==e.source)).filter((e=>"fcs"!==e.source||"syncing"===e.saveStatus)).concat(s)}));const o=C().model.state.schedule.posts.some((e=>"syncing"===e.saveStatus));t.refreshCount=t.refreshCount||0,t.refreshDelay=t.refreshDelay||3*w().SECOND,o&&t.refreshCount<4?(clearTimeout(t.refreshTimeout),t.refreshTimeout=setTimeout((()=>{t.refreshCount+=1,t.refreshDelay*=1.5,v().iframeBus.send("schedule.fcs-refresh-data")}),t.refreshDelay)):(t.refreshCount=null,t.refreshDelay=null,t.refreshTimeout=null),C().transaction((e=>{const t=[...e.schedule.posts];for(const s of t){if("syncing"!==s.saveStatus)continue;Date.now()-s.createdOn>1*w().HOUR&&(e.schedule.fcsError="Could not save or sync your post(s) to Instagram API. Instagram API is not responsive.",e.schedule.isErrorShown=!0,e.schedule.posts=e.schedule.posts.filter((e=>e.id!==s.id)))}})),W().eventBus.send("schedule.fcs-posts-applied")}function ma(e){C().transaction((t=>{t.schedule.fcsSetup.attempted&&(t.schedule.fcsSetup.attempted=!1,e||(t.schedule.fcsSetup.failed=!0,t.schedule.fcsSetup.newApi=!t.schedule.fcsSetup.newApi)),t.schedule.fcsSetup.checking=!1,t.schedule.fcsSetup.connected=e,t.schedule.fcsSetup.showPanel=!1})),e||S().chromeBus.send("schedule.update-ig-posts",!0)}function ga(){C().transaction((e=>{e.schedule.isUpsellShown=!0}))}function pa({postId:e,errorText:t}){C().transaction((s=>{if(s.bulk.saving){const t=s.bulk.actions[e];if(t)return void(t.failed=!0)}s.schedule.fcsError=t,s.schedule.isErrorShown=!0,"post"===s.schedule.navigation.selectedTabId&&(s.schedule.navigation.isOpen=!1,s.schedule.navigation.selectedPostId=null)}))}function fa({message:e,details:t={},critical:s=!1}){const a=fa;t.isNetworkOk&&u().sentryController.sendError(e,"error",{details:t},{actor:"schedule"}),s&&(a.init||(a.init=!0,a.criticalCount=0),t.isNetworkOk&&(a.criticalCount+=1),C().transaction((e=>{e.schedule.fcsFailed=!0,e.schedule.isErrorShown=!0,e.schedule.fallback.hideSwitchToFallbackButton=!t.isNetworkOk||a.criticalCount<2})))}function Ca({message:e,isNetworkOk:t}){const s=Ca;s.init||(s.init=!0,s.count=0),t&&(m().gaController.sendEvent("user","schedule:fcs-failed",e),s.count+=1),C().transaction((e=>{e.schedule.fcsFailed=!0,e.schedule.isErrorShown=!0,"post"===e.schedule.navigation.selectedTabId&&(e.schedule.navigation.isOpen=!1,e.schedule.navigation.selectedPostId=null),e.schedule.fallback.hideSwitchToFallbackButton=!t||s.count<3}))}function va(){return C().model.state.schedule.fallback.isEnabled}function ba({on:e,takeNextTimeSlot:t=!1}){C().transaction((s=>{const a=s.schedule.dateDialog;let n=Y().default(e).getTime(),o=e-n;if(t){const e=s.schedule.timeSlots;if(0===e.length)a.periodStart=n,a.selectedDay=n,a.customTime=o,a.selectedSlotTime=null;else for(;;){const t=e.find((e=>e.time>o));t?(a.periodStart=n,a.selectedDay=n,a.customTime=t.time,a.selectedSlotTime=t.time):(a.periodStart=j().default(n,1).getTime(),a.selectedDay=j().default(n,1).getTime(),a.customTime=e[0].time,a.selectedSlotTime=e[0].time);const i=a.selectedDay+a.selectedSlotTime;if(!s.schedule.posts.find((e=>"fcs"===e.source&&e.on===i)))break;n=a.selectedDay,o=a.selectedSlotTime}}else a.periodStart=n,a.selectedDay=n,a.selectedSlotTime=null,a.customTime=o}))}function ka(){return!C().model.state.schedule.fcsSetup.connected}function wa(){C().transaction((e=>{e.schedule.fcsSetup.errorCode=null,e.schedule.fcsSetup.showPanel=!0}))}async function Sa(e){const t=Sa;if(t.cache||(t.cache={}),!t.cache[e]){const s=await fetch(e),a=await s.blob(),{averageColor:n}=await q().default(a),[o,i,r]=n.replace("rgb(","").replace(")","").split(", ").map(Number);t.cache[e]=[o,i,r],setTimeout((()=>{delete t.cache[e]}),10*w().MINUTE)}return t.cache[e]}O(),C(),$();var _a={onDragStart:function(e){if($().default.isSaving())return void na.blinkAddCardAttention();ya.mediator1=e,ya.mediator2=e,ya.dragging=!0,C().transaction((e=>{e.schedule.isDraggingPost=!0}))},onDragEnd:function(e){ya.dragging=!1,setTimeout((()=>{C().transaction((e=>{e.schedule.isDraggingPost=!1}))}));const t=O().default((()=>ya.mediator1.props.post),null),s=O().default((()=>ya.mediator2.props.post),null);ya.mediator1&&ya.mediator1.setState({dragPost:null});ya.mediator2&&ya.mediator2.setState({dragPost:null});if(!t||!s)return;if(t.id===s.id)return;let a=0;if(t.draftOrder===s.draftOrder){const e=t.index,n=s.index;a=Math.sign(e-n)}C().transaction((e=>{"bulk"!==e.schedule.navigation.selectedTabId&&"calendar"!==e.schedule.navigation.selectedTabId&&"time-slots"!==e.schedule.navigation.selectedTabId&&(e.schedule.navigation.isOpen=!1,e.schedule.navigation.selectedTabId=null);const n=e.bulk.actions[t.id]||{};if(n.on=s.on,n.draftOrder=s.draftOrder+a,"local"!==t.source){n.status="local"===s.source&&s.on?"scheduled":s.status;const a=e.schedule.posts.find((e=>e.id===t.id));n.status===a.status&&delete n.status}e.bulk.actions[t.id]=n;const o=e.bulk.actions[s.id]||{};if(o.on=t.on,o.draftOrder=t.draftOrder,"local"!==s.source){o.status="local"===t.source&&t.on?"scheduled":t.status;const a=e.schedule.posts.find((e=>e.id===s.id));o.status===a.status&&delete o.status}e.bulk.actions[s.id]=o}))},onDragEnter:function(e){if(!ya.dragging)return;if("posted"===e.props.post.status)return;ya.mediator2.setState({dragPost:null}),ya.mediator2=e,ya.mediator1.setState({dragPost:ya.mediator2.props.post}),ya.mediator2.setState({dragPost:ya.mediator1.props.post})}};const ya={mediator1:null,mediator2:null,dragging:!1};g(),p(),C(),$(),g(),p(),C(),w(),v(),S(),$(),J(),ee(),te(),se(),w(),g(),p(),C(),$();class Ta extends g().default.Component{constructor(e){super(e),this._onClick=()=>{const e=this._getDragPost()||this.props.post;na.openPost(e)},this._onDragStart=()=>{_a.onDragStart(this)},this._onDragEnd=()=>{_a.onDragEnd(this)},this._onDragEnter=()=>{_a.onDragEnter(this)},this._getDateText=e=>{const t=new Date(e),s=J().default(t,"HH:mm");let a;return a=ee().default(t)?"Today":te().default(t)?"Tomorrow":se().default(t)?J().default(t,"d MMM"):J().default(t,"d MMM yyyy"),`${a}, ${s}`},this.state={dragPost:null}}render(){const e=this._getDragPost()||this.props.post;return Glamor.createElement(p().default.SchedulePostNew,{image:e.preview,backgroundColor:e.imageAvgColor,type:e.type,local:"local"===e.source&&"syncing"!==e.saveStatus,blur:this._isBlur(),grayscale:this._isGrayscale(),index:e.index,canClick:this._canClick(),canDrag:this._canDrag(),showFooter:this.props.showInfo,info:this._getInfo(),stats:e.stats,onClick:this._onClick,onDragStart:this._onDragStart,onDragEnter:this._onDragEnter,onDragEnd:this._onDragEnd})}_isBlur(){const e=this._getDragPost()||this.props.post;return"saving"===e.saveStatus||"syncing"===e.saveStatus||"deleting"===e.saveStatus}_isGrayscale(){const e=this._getDragPost()||this.props.post;return"saving"===e.saveStatus||"deleting"===e.saveStatus}_canClick(){const e=this._getDragPost()||this.props.post;return"saving"!==e.saveStatus&&("syncing"!==e.saveStatus&&"deleting"!==e.saveStatus)}_canDrag(){return!this.props.saving&&(!this.props.post.saveStatus&&"posted"!==this.props.post.status)}_getInfo(){const e=this._getDragPost()||this.props.post;return"saving"===e.saveStatus?{text:"SAVING...",color:g().default.color.bgLight1}:"syncing"===e.saveStatus?{text:"SYNCING...",color:g().default.color.bgLight1}:"deleting"===e.saveStatus?{text:"DELETING...",color:g().default.color.bgLight1}:"failed"===e.saveStatus?{text:"Failed to save",color:g().default.color.error}:this._isFailedToPost()?{text:"Failed to post",color:g().default.color.error}:"posted"===e.status?null:"local"===e.source?this.props.post.on?{text:this._getDateText(this.props.post.on),color:g().default.color.attention}:null:"draft"===this.props.post.status?{text:"Draft",color:g().default.color.positive}:"scheduled"===this.props.post.status&&this.props.post.on?{text:this._getDateText(this.props.post.on),color:g().default.color.positive}:null}_isFailedToPost(){const e=Date.now(),t=this._getDragPost()||this.props.post,s=t.on+5*w().MINUTE,a="scheduled"===t.status,n=e>s;return this.props.lastFcsPostsUpdateOn>s&&a&&n}_getDragPost(){return this.props.dragPost||this.state.dragPost}}var Ea=C().influx((e=>({saving:$().default.isSaving(),showInfo:e.schedule.filters.showInfo,lastFcsPostsUpdateOn:e.schedule.lastFcsPostsUpdateOn})))(Ta);class Pa extends g().default.Component{constructor(e){super(e),this._MAX_IG_POSTS_TO_SHOW=60,this._onSendReportClick=()=>{this.setState({isReportSent:!0}),S().chromeBus.send("overseer.send-report",{key:"user"})},this._onReloadPageClick=()=>{location.reload()},this._checkingTimer=null,this._fcsAutorefreshed=!1,this.state={isLongChecking:!1,isReportSent:!1},e.checking&&this._setCheckingTimer()}componentDidUpdate(e){const t=e,s=this.props;!t.checking&&s.checking?this._setCheckingTimer():t.checking&&!s.checking&&(clearTimeout(this._checkingTimer),this.setState({isLongChecking:!1}))}render(){return Glamor.createElement(p().default.ScheduleGrid,{posts:this._getPosts(),animatePostsOrder:!this.props.dragging,overlay:this._getOverlay(),message:this._getMessage()})}_getPosts(){let e=0;return this.props.posts.map((t=>"ig"===t.source&&(e+=1,e>this._MAX_IG_POSTS_TO_SHOW)?null:{id:t.id,element:Glamor.createElement(Ea,{post:t})})).filter(Boolean)}_getOverlay(){return{shown:this.props.addingFiles||this.props.checking||0===this.props.posts.length&&this.props.loading,icon:"spinner",...this.state.isLongChecking&&{text:Glamor.createElement(g().default.Fragment,null,"Oops... Establishing connection takes longer that usual. Please try again later or send us a report."),buttons:[{id:"send-report",element:Glamor.createElement("div",{css:[g().default.row,g().default.alignItems.center]},Glamor.createElement(g().default.LinkButton,{label:"SEND REPORT",onClick:this._onSendReportClick}),Glamor.createElement(g().default.Spacer,{width:"g1"}),Glamor.createElement(g().default.InfoCircle,{tooltip:{text:Glamor.createElement(g().default.Fragment,null,"Clicking this button will send an internal technical data on this connectivity error to the development team for research. This data is not shared with 3rd parties.")}}))},{id:"reload-page",element:Glamor.createElement(g().default.LinkButton,{cancel:!0,label:"RELOAD PAGE",onClick:this._onReloadPageClick})}]},...this.state.isReportSent&&{icon:"success",text:Glamor.createElement(g().default.Fragment,null,"Thank you! The bug report has been sent.",Glamor.createElement("br",null),"We will check what could be wrong and try",Glamor.createElement("br",null),"to fix that in the future version."),buttons:[{id:"reload-page",element:Glamor.createElement(g().default.LinkButton,{label:"RELOAD PAGE",onClick:this._onReloadPageClick})}]}}}_getMessage(){return this.props.posts.filter((e=>"ig"===e.source)).length>this._MAX_POSTS_TO_SHOW?"Older posts are omitted":0===this.props.posts.length?"No posts to show":null}_setCheckingTimer(){this._checkingTimer=this.setTimeout((()=>{if(!this._fcsAutorefreshed)return this._fcsAutorefreshed=!0,v().iframeBus.send("schedule.fcs-refresh-page"),void this._setCheckingTimer();this.setState({isLongChecking:!0}),this.setTimeout((()=>{this.state.isReportSent||S().chromeBus.send("overseer.send-report",{key:"schedule-auto"})}),5*w().SECOND)}),30*w().SECOND)}}var Aa=C().influx((e=>({posts:$().default.getPosts({applyGridFilters:!0}),checking:e.schedule.fcsSetup.checking,loading:e.schedule.loading,dragging:e.schedule.isDraggingPost,addingFiles:e.schedule.addingFiles})))(Pa);g(),p(),m(),C(),v(),S(),$(),g(),p(),m(),C();class Ia extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onFilterClick=e=>{m().gaController.sendEvent("user",`schedule:filter-click-${e}`),C().transaction((t=>{t.schedule.filters[e]=!t.schedule.filters[e]}))},t}render(){return Glamor.createElement(p().default.ScheduleFilters,{filters:this.props.filters,onFilterClick:this._onFilterClick})}}var xa=C().influx((e=>({filters:e.schedule.filters})))(Ia);class Da extends g().default.Component{constructor(...e){var t;return t=super(...e),this._checkHasFilters=()=>Object.values(this.props.filters).some((e=>!e)),this._onPillClick=e=>{na.toggleTab(e)},this._onRefreshClick=()=>{const e=$().default.getAddCardStatus();if("save"===e||"saving"===e)return void na.blinkAddCardAttention();m().gaController.sendEvent("user","schedule:refresh-click"),C().transaction((e=>{e.schedule.loading=!0}));C().model.state.schedule.fcsSetup.connected?v().iframeBus.send("schedule.fcs-refresh-data"):S().chromeBus.send("schedule.update-ig-posts")},t}render(){return Glamor.createElement(p().default.ScheduleControls,{selectedPillId:this.props.selectedTabId,loading:this.props.loading,hasFilters:this._checkHasFilters(),filters:Glamor.createElement(xa,null),onPillClick:this._onPillClick,onRefreshClick:this._onRefreshClick})}}var Ga=C().influx((e=>({filters:e.schedule.filters,loading:e.schedule.loading,selectedTabId:e.schedule.navigation.isOpen?e.schedule.navigation.selectedTabId:null})))(Da);g(),p(),C(),$(),g(),p(),C();class Fa extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onClick=()=>{this.props.checking||Ws.chooseFiles((e=>{Ws.selectFiles(e)}))},this._onLongPress=()=>{C().transaction((e=>{e.schedule.fallback.isEnabled=!0}))},t}render(){return Glamor.createElement(p().default.ScheduleAddCardContentDefault,{onClick:this._onClick,onLongPress:this._onLongPress})}}var Oa=C().influx((e=>({checking:e.schedule.fcsSetup.checking})))(Fa);g(),p(),C(),$();class Ba extends g().default.Component{constructor(e){super(e),this._onSaveClick=()=>{na.commitPostChanges()},this._onCancelClick=()=>{na.cancelPostChanges()},this.state={forceSavedStatus:!1}}componentDidUpdate(e){const t=e,s=this.props;"saved"===t.addCardStatus&&"saved"!==s.addCardStatus&&(this.setState({forceSavedStatus:!0}),this.setTimeout((()=>{this.setState({forceSavedStatus:!1})}),500))}render(){return Glamor.createElement(p().default.ScheduleAddCardContentChanges,{status:this._getStatus(),savingTitle:this.props.savingTitle,savingText:this.props.savingText,savingPreview:this.props.savingPreview,onSaveClick:this._onSaveClick,onCancelClick:this._onCancelClick})}_getStatus(){return this.state.forceSavedStatus||"saved"===this.props.addCardStatus?"saved":"saving"===this.props.addCardStatus?"saving":null}}var Ua=C().influx((e=>({savingTitle:e.schedule.addCard.savingTitle,savingText:e.schedule.addCard.savingText,savingPreview:e.schedule.addCard.savingPreview,addCardStatus:$().default.getAddCardStatus()})))(Ba);g(),p();class La extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onDrop=e=>{Ws.selectFiles(e)},t}render(){return Glamor.createElement(p().default.ScheduleAddCardContentDropZone,{onDrop:this._onDrop})}}g(),p(),C();class Ma extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onOptionClick=e=>{C().transaction((t=>{t.schedule.addCard.selectedOption=e}))},this._onConfirmClick=()=>{const e="carousel"===this.props.selectedOption;Ws.addSelectedFiles({isCarousel:e})},this._onCancelClick=()=>{C().transaction((e=>{e.schedule.addCard.fileCount=0}))},t}componentDidMount(){this.addEventListener(Os,"keydown",(e=>{"Escape"===e.key&&C().transaction((e=>{e.schedule.addCard.fileCount=0}))})),C().transaction((e=>{e.schedule.addCard.selectedOption="multiple"}))}render(){return Glamor.createElement(p().default.ScheduleAddCardContentDropForm,{fileCount:this.props.fileCount,selectedOption:this.props.selectedOption,onOptionClick:this._onOptionClick,onConfirmClick:this._onConfirmClick,onCancelClick:this._onCancelClick})}}var Ra=C().influx((e=>({fileCount:e.schedule.addCard.fileCount,selectedOption:e.schedule.addCard.selectedOption})))(Ma);class Na extends g().default.Component{render(){return Glamor.createElement(p().default.ScheduleAddCard,{contentToShow:this._getContentToShow(),highlight:this.props.attention,contentDefault:Glamor.createElement(Oa,null),contentChanges:Glamor.createElement(Ua,null),contentDropZone:Glamor.createElement(La,null),contentDropForm:Glamor.createElement(Ra,null)})}_getContentToShow(){return"save"===this.props.status||"saved"===this.props.status||"saving"===this.props.status?"changes":"dropForm"===this.props.status?"dropForm":"dropZone"===this.props.status?"dropZone":"default"}}var za=C().influx((e=>({status:$().default.getAddCardStatus(),attention:e.schedule.addCard.attention})))(Na);g(),p(),C(),S(),ae();class Ha extends g().default.Component{constructor(e){super(e),this._onCloseClick=()=>{C().transaction((e=>{e.schedule.fcsSetup.showPanel=!1}))},this._onConnectClick=()=>{S().chromeBus.send("schedule.connect-to-fcs")},this.state={tryAgainWasClicked:!1}}render(){return Glamor.createElement(p().default.ScheduleSetupPanel,{connecting:this.props.connecting,onCloseClick:this._onCloseClick,onConnectClick:this._onConnectClick,showManualSetupMessage:this.props.showManualSetupMessage,alternativeContent:this._getAlternativeContent()})}_getAlternativeContent(){if(!this.props.errorCode)return null;if(this.props.errorCode===ae().default.nonProfessionalAccount)return{isError:!1,title:"Setup Post Assistant",text:Glamor.createElement(g().default.Fragment,null,"Please switch your Instagram to ",Glamor.createElement("b",null,"Professional Account")," from Instagram Mobile App.",Glamor.createElement(g().default.Spacer,{height:"g1"}),Glamor.createElement("div",{css:{marginLeft:g().default.space.g2,...g().default.text.of({family:g().default.font.secondary,size:14,height:"19px",weight:600})}},"1. Open Instagram Mobile App",Glamor.createElement(g().default.Spacer,{height:"g1"}),"2. Click Settings → Account",Glamor.createElement(g().default.Spacer,{height:"g1"}),"3. Click Switch to Professional Account",Glamor.createElement(g().default.Spacer,{height:"g1"}))),buttons:[{label:"OK, DONE",onClick:()=>{C().transaction((e=>{e.schedule.fcsSetup.errorCode=null}))}}]};if(this.props.errorCode===ae().default.fbLoginRequired)return{isError:!0,title:"CROSSPOSTING SETUP FAILED",text:Glamor.createElement(g().default.Fragment,null,"Please make sure to login to ",Glamor.createElement("a",{href:"https://facebook.com",target:"_blank"},"Facebook.com"),"."),buttons:[{label:"OK, GOT IT",onClick:()=>{C().transaction((e=>{e.schedule.fcsSetup.showPanel=!1}))}},{label:"OPEN FACEBOOK.COM",onClick:()=>{chrome.tabs.create({active:!0,url:"https://facebook.com?elcw"})}}]};if(this.props.errorCode===ae().default.noConnectedFbPage){const e=this.props.username?`@${this.props.username}`:"Your";return{isError:!0,title:"CROSSPOSTING SETUP FAILED",text:Glamor.createElement(g().default.Fragment,null,e," Instagram account is not connected to a Facebook Page."),buttons:[{label:"OK, GOT IT",onClick:()=>{C().transaction((e=>{e.schedule.fcsSetup.showPanel=!1}))}},{label:"OPEN FACEBOOK.COM",onClick:()=>{chrome.tabs.create({active:!0,url:"https://facebook.com?elcw"})}}]}}return this.state.tryAgainWasClicked?{isError:!0,title:"SETUP FAILED",text:Glamor.createElement(g().default.Fragment,null,"Failed to setup Post Assistant automatically. Please check your Internet connection or try setting up connection manually."),buttons:[{label:"OK, GOT IT",onClick:()=>{C().transaction((e=>{e.schedule.fcsSetup.errorCode=null}))}},{label:"SETUP MANUALLY",onClick:()=>{chrome.tabs.create({active:!0,url:"https://business.facebook.com/creatorstudio?tab=instagram_accounts&mode=instagram&collection_id=all_pages"})}}]}:{isError:!0,title:"SETUP FAILED",text:Glamor.createElement(g().default.Fragment,null,"Failed to setup Post Assistant automatically. Please check your Internet connection and try again."),buttons:[{label:"TRY AGAIN",onClick:()=>{this.setState({tryAgainWasClicked:!0}),C().transaction((e=>{e.schedule.fcsSetup.errorCode=null}))}}]}}}var Va=C().influx((e=>({username:e.authStatus.username,connecting:e.schedule.fcsSetup.connecting,errorCode:e.schedule.fcsSetup.errorCode,showManualSetupMessage:e.schedule.fcsSetup.failed})))(Ha);class Wa extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onCloseClick=()=>{C().transaction((e=>{e.sidebar.isOpen=!1}))},this._onBlurOverlayClick=()=>{C().transaction((e=>{e.schedule.fcsSetup.connecting||e.schedule.fcsSetup.errorCode||(e.schedule.fcsSetup.showPanel=!1)}))},this._onDndTipOkClick=()=>{C().transaction((e=>{e.acknowledged.scheduleDndTip=Date.now()}))},this._onExpandClick=()=>{na.toggleTab("bulk")},t}render(){return Glamor.createElement(p().default.ScheduleSidePanel,{isRefreshing:this.props.loading,controls:Glamor.createElement(Ga,null),addCard:Glamor.createElement(za,null),gridTip:this.props.dndTipShown&&{icon:"bulb",content:Glamor.createElement(g().default.Fragment,null,Glamor.createElement("b",null,"Tips:")," You can rearrange any drafts and scheduled post in a grid or calendar by dragging them with a mouse."),buttons:[{label:"OK, GOT IT",onClick:this._onDndTipOkClick}]},grid:Glamor.createElement(Aa,null),setupPanel:{shown:this.props.setupPanelShown,content:Glamor.createElement(Va,null)},onBlurOverlayClick:this._onBlurOverlayClick,onExpandClick:this._onExpandClick,onCloseClick:this._onCloseClick})}}var $a=C().influx((e=>({dndTipShown:!e.acknowledged.scheduleDndTip,setupPanelShown:e.schedule.fcsSetup.showPanel,loading:$().default.isLoading()})))(Wa);g(),p(),A(),C(),b(),g(),p(),_(),C();class qa extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onCloseClick=()=>{this.props.goToCalendarOnClose?C().transaction((e=>{e.schedule.navigation.selectedTabId="calendar"})):na.closeBodyPanel()},this._onTagAssistClick=()=>{C().transaction((e=>{e.schedule.showTagAssist=!e.schedule.showTagAssist}))},t}render(){if(!this.props.url)return null;const e=ke.createName("inssist-fcs",{theme:this.state.theme,fusionConfig:Se.getConfig(),isElectron:!!window.electron}),t=!1!==_().env.features.iframes?this.props.url:null;return Glamor.createElement(p().default.ScheduleFcsScreen,{title:this.props.title,loading:this.props.isLoading,action:this._getAction(),onCloseClick:this._onCloseClick,iframeAttrs:{name:e,allow:"geolocation",src:t}})}_getAction(){return{label:"# HASHTAGS",selected:this.props.showTagAssist,onClick:this._onTagAssistClick}}}var ja=C().influx((e=>{let t;return t="post"===e.schedule.navigation.selectedTabId?"Create New Post":"Post Details",{title:t,isLoading:e.schedule.navigation.isFcsLoading,showTagAssist:e.schedule.showTagAssist,goToCalendarOnClose:e.schedule.navigation.withBackToCalendarButton}}))(g().default.theme.ThemeAware(qa));g(),p(),C(),$();class Ya extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onPostDrop=(e,t)=>{C().transaction((s=>{const a=s.bulk.actions[e.id]||{};a.on=t,s.bulk.actions[e.id]=a}))},t}render(){return Glamor.createElement(p().default.ScheduleCalendarScreen,{title:"Post Calendar",periodType:this.props.periodType,periodStart:this.props.periodStart||Date.now(),showSlots:this.props.showSlots,posts:this.props.posts,slots:this.props.slots,minMinutesFromNow:15,maxDaysFromNow:170,dragDisabled:this.props.isSaving,onDragFail:na.blinkAddCardAttention,onCloseClick:na.closeBodyPanel,onPeriodTypeChange:this._onPeriodTypeChange,onPeriodStartChange:this._onPeriodStartChange,onShowSlotsChange:this._onShowSlotsChange,onPostClick:this._onPostClick,onPostDrop:this._onPostDrop,onAddPostClick:this._onAddPostClick})}_onPeriodTypeChange(e){C().transaction((t=>{t.schedule.calendar.periodType=e}))}_onPeriodStartChange(e){C().transaction((t=>{t.schedule.calendar.periodStart=e}))}_onShowSlotsChange(e){C().transaction((t=>{t.schedule.calendar.showTimeSlots=e}))}_onAddPostClick({dayStart:e,time:t}){const s=C().model.state.schedule.timeSlots.find((e=>e.time===t));na.openNewPost({postMode:"schedule"}),C().transaction((a=>{a.schedule.navigation.withBackToCalendarButton=!0,a.schedule.dateDialog.periodStart=e,a.schedule.dateDialog.selectedDay=e,a.schedule.dateDialog.selectedSlotTime=s?t:null,a.schedule.dateDialog.customTime=s?null:t})),Fs.actualizeDataForIframe()}_onPostClick({post:e}){na.openPost(e),C().transaction((e=>{e.schedule.navigation.withBackToCalendarButton=!0}))}}var Ka=C().influx((e=>({posts:$().default.getPosts({applyGridFilters:!0}).filter((e=>"draft"!==e.status)).map((e=>({...e,key:e.id}))),slots:e.schedule.timeSlots,periodType:e.schedule.calendar.periodType,periodStart:e.schedule.calendar.periodStart,showSlots:e.schedule.calendar.showTimeSlots,isSaving:$().default.isSaving()})))(Ya);g(),p(),C(),w();class Za extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onAddSlotClick=e=>{C().transaction((t=>{!!t.schedule.timeSlots.find((t=>t.time===e))||(t.schedule.recentScheduledOn=null,t.schedule.timeSlots.push({time:e}),t.schedule.timeSlots.sort(((e,t)=>{let s=e.time-5*w().HOUR;s<0&&(s=24*w().HOUR+s);let a=t.time-5*w().HOUR;return a<0&&(a=24*w().HOUR+a),s-a})))}))},this._onDeleteSlotClick=e=>{C().transaction((t=>{const s=t.schedule.timeSlots.findIndex((t=>t.time===e));-1!==s&&t.schedule.timeSlots.splice(s,1)}))},t}render(){return Glamor.createElement(p().default.ScheduleSlotsScreen,{title:"Time Slots",description:"Manage slots for quick scheduling",slots:this.props.slots,onCloseClick:na.closeBodyPanel,onAddSlotClick:this._onAddSlotClick,onDeleteSlotClick:this._onDeleteSlotClick})}}var Ja=C().influx((e=>({slots:e.schedule.timeSlots})))(Za);g(),p(),v(),C();class Qa extends g().default.Component{render(){return this.props.url?Glamor.createElement(p().default.ScheduleFallback,{topPanel:{icon:"warning-triangle",iconStyle:{width:14,height:16,color:g().default.color.error},text:"Failed connecting to Facebook. Interface was switched to fallback version.",button:{label:"RETRY FB CONNECTION",loadingText:"Retrying...",color:g().default.color.link,isLoading:this.props.isRetryingFbConnection,onClick:this._onRetryClick}},iframeAttrs:{name:ke.createName("inssist-fcs",{fusionConfig:Se.getConfig(),isElectron:!!window.electron}),src:this.props.url}}):null}async _onRetryClick(){C().transaction((e=>{e.schedule.fallback.isRetryingFbConnection=!0,e.schedule.fcsSetup.connected=!1}));const e=await v().iframeBus.send("schedule.fcs-check-critical-vars");C().transaction((t=>{e?(t.schedule.navigation.isOpen=!1,t.schedule.navigation.selectedTabId=null,t.schedule.fallback.isEnabled=!1,t.schedule.fallback.isRetryingFbConnection=!1):(t.schedule.isErrorShown=!0,t.schedule.fallback.isFailedToReconnect=!0,t.schedule.fallback.isRetryingFbConnection=!1)}))}}var Xa=C().influx((e=>({isRetryingFbConnection:e.schedule.fallback.isRetryingFbConnection})))(Qa);const en=({visible:e})=>({height:"100%",...!e&&{...g().default.fixed(),visibility:"hidden",pointerEvents:"none",opacity:0}});class tn extends g().default.Component{constructor(e){super(e),this._onUpsellOverlayClick=()=>{C().transaction((e=>{e.schedule.isUpsellShown=!1}))},this.fcsMainPageUrl=A().default("https://business.facebook.com/creatorstudio",{tab:"instagram_content_posts",mode:"instagram",collection_id:"all_pages",content_table:"INSTAGRAM_POSTS",locale:"en_US"})}render(){return this.props.isFallbackEnabled?Glamor.createElement(Xa,{url:this.fcsMainPageUrl}):Glamor.createElement(p().default.ScheduleBodyPanel,{loading:this.props.isLoading,showTagAssistPanel:this.props.showTagAssist,onLoadingCloseClick:na.closeBodyPanel,upsellOverlay:this._constructUpsellOverlay(),tagAssistPanel:this._constructTagAssistPanel()},this._renderContent())}_renderContent(){const e=this.props;let t=null,s=!1;return"bulk"===e.selectedTabId?t=Glamor.createElement(Gs,null):"calendar"===e.selectedTabId?t=Glamor.createElement(Ka,null):"time-slots"===e.selectedTabId?t=Glamor.createElement(Ja,null):e.isFcsConnected&&(s=!0),Glamor.createElement(g().default.Fragment,null,Glamor.createElement("div",{css:en({visible:s})},Glamor.createElement(ja,{url:this.fcsMainPageUrl})),t)}_constructUpsellOverlay(){return Glamor.createElement(mt,{show:this.props.showUpsell,feature:"schedule",onOverlayClick:this._onUpsellOverlayClick})}_constructTagAssistPanel(){return this.props.showTagAssist?Glamor.createElement(Yt,{placement:"schedule"}):null}}var sn=C().influx((e=>{const t=b().stateProxy.hasPro(),s=e.schedule.fcsSetup.connected;return{isLoading:!s,isFcsConnected:s,isFallbackEnabled:e.schedule.fallback.isEnabled,selectedTabId:e.schedule.navigation.selectedTabId,showUpsell:!t&&s&&e.schedule.isUpsellShown,showTagAssist:e.schedule.showTagAssist}}))(tn);function an(){return(an=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}g(),p(),v(),C();class nn extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onCloseClick=()=>{C().transaction((e=>{e.schedule.isErrorShown=!1}))},this._onRefreshClick=()=>{C().transaction((e=>{e.schedule.loading=!0,e.schedule.isErrorShown=!1,e.schedule.navigation.isOpen=!1,e.schedule.navigation.selectedTabId=null})),v().iframeBus.send("schedule.fcs-refresh-page")},this._onSwitchToFallbackClick=()=>{C().transaction((e=>{e.schedule.isErrorShown=!1,e.schedule.fallback.isEnabled=!0}))},t}render(){return Glamor.createElement(p().default.SnackbarItem,{id:"schedule-error-card-mediator",show:this.props.isShown},Glamor.createElement(p().default.ScheduleErrorCard,an({},this._getErrorCardData(),{onCloseClick:this._onCloseClick})))}_getErrorCardData(){return this.props.failedToReconnect?{title:"Failed connecting to Instagram API Server",content:"\n          We experience temporary technical issues connecting\n          to Instagram API Server and some grid functionality\n          may be unavailable. We are working on fixing the problem.\n        "}:this.props.fcsFailed?{title:"Failed connecting to Instagram API Server",content:"\n          We experience temporary technical issues connecting\n          to Instagram API Server and some grid functionality\n          may be unavailable. We are working on fixing the problem.\n        ",actions:[{label:"REFRESH",onClick:this._onRefreshClick},!this.props.hideSwitchToFallbackButton&&{label:"SWITCH TO FALLBACK VERSION",onClick:this._onSwitchToFallbackClick}]}:this.props.fcsError?{title:"Instagram API error.",content:this.props.fcsError}:null}}var on=C().influx((e=>({isShown:"tab-scheduling"===e.sidebar.selectedTabId&&e.sidebar.isOpen&&e.schedule.isErrorShown,fcsError:e.schedule.fcsError,fcsFailed:e.schedule.fcsFailed,failedToReconnect:e.schedule.fallback.isFailedToReconnect,hideSwitchToFallbackButton:e.schedule.fallback.hideSwitchToFallbackButton})))(nn);g(),p(),v(),C(),w(),$();const rn=({props:e})=>({...g().default.fixed(". 33 66 ."),...g().default.transition.fast,zIndex:1,...!e.isOpen&&{opacity:0,transform:"translateY(10px)",pointerEvents:"none"},...e.showTagAssist&&{right:473}});class ln extends g().default.Component{constructor(e){super(e),this._onOptionClick=async e=>{if(C().transaction((t=>{t.schedule.dateDialog.selectedOption=e})),v().iframeBus.send("schedule.fcs-date-dialog-select-option",e),"schedule"===e){const e=await v().iframeBus.send("schedule.fcs-date-dialog-get-timezone");C().transaction((t=>{t.schedule.dateDialog.timezone=e}))}Fs.actualizeDataForIframe()},this._onDaySelect=e=>{C().transaction((t=>{t.schedule.dateDialog.selectedDay=e})),Fs.actualizeDataForIframe()},this._onPeriodStartChange=e=>{C().transaction((t=>{t.schedule.dateDialog.periodStart=e}))},this._onCustomTimeInput=()=>{C().transaction((e=>{e.schedule.dateDialog.isTimeError=!1}))},this._onCustomTimeChange=e=>{C().transaction((t=>{t.schedule.dateDialog.customTime=e})),Fs.actualizeDataForIframe()},this._onSlotChange=e=>{C().transaction((t=>{t.schedule.dateDialog.selectedSlotTime=e,t.schedule.dateDialog.isTimeError=!1})),Fs.actualizeDataForIframe()};const t=Se.getConfig().fcs;this.maxDay=Date.now()+t.MAX_DAYS_FROM_NOW*w().DAY}render(){return Glamor.createElement("div",{css:rn(this)},Glamor.createElement(p().default.ScheduleDateDialog,{selectedOption:this.props.selectedOption,onOptionClick:this._onOptionClick,datePicker:this._renderDatePicker(),timePicker:this._renderTimePicker()}))}_renderDatePicker(){return Glamor.createElement(p().default.ScheduleDatePicker,{periodStart:this.props.periodStart,maxDay:this.maxDay,selectedDay:this.props.selectedDay,onDaySelect:this._onDaySelect,onPeriodStartChange:this._onPeriodStartChange})}_renderTimePicker(){let e=null;return this.props.isTimeError&&(e="should be at least 10 minutes from now"),Glamor.createElement(p().default.ScheduleTimePicker,{label:"time to publish",timezone:this.props.timezone,errorMessage:e,slots:this.props.slots,selectedSlot:this.props.selectedSlotTime,customTime:this.props.customTime,onSlotChange:this._onSlotChange,onCustomTimeInput:this._onCustomTimeInput,onCustomTimeChange:this._onCustomTimeChange})}}var cn=C().influx((e=>{const t=e.schedule.dateDialog,s=e.schedule.navigation.selectedTabId;return{isOpen:e.sidebar.isOpen&&"tab-scheduling"===e.sidebar.selectedTabId&&e.schedule.navigation.isOpen&&(!s||"post"===s)&&!e.schedule.isUpsellShown&&t.isOpen,slots:e.schedule.timeSlots,selectedOption:t.selectedOption,periodStart:$().default.getDateDialogPeriodStart(),selectedDay:$().default.getDateDialogSelectedDay(),selectedSlotTime:t.selectedSlotTime,customTime:t.customTime,timezone:t.timezone,isTimeError:t.isTimeError,showTagAssist:e.schedule.showTagAssist}}))(ln);g(),p(),C();const dn={content:{marginTop:g().default.space.g0h},errorGroup:{marginBottom:g().default.space.g1h,"&:last-child":{marginBottom:0}},errorGroupTitle:{...g().default.row},errorFilename:e=>({fontWeight:700,...g().default.text.nowrap,...e&&{...g().default.text.ellipsis}}),errorFilenameDivider:{opacity:.5,...g().default.margin("0 g1")},errorGroupDescription:{marginTop:g().default.g0h,"& a":{color:g().default.color.link,...g().default.clickable}}};class un extends g().default.Component{constructor(...e){var t;return t=super(...e),this._renderContent=()=>{const e=[];for(const t of this.props.fileUploadErrors){let s=e.find((e=>e.type===t.type));s||(s={type:t.type,filenames:[]},e.push(s)),s.filenames.push(t.filename)}return Glamor.createElement("div",{css:dn.content},e.map(this._renderErrorGroup))},this._renderErrorGroup=e=>{const t=e.filenames,s=t.slice(0,2);return t.length>2&&s.push(t.length-2+" more..."),Glamor.createElement("div",{css:dn.errorGroup,key:e.type},Glamor.createElement("div",{css:dn.errorGroupTitle},s.map(((e,t)=>{const a=t===s.length-1;return Glamor.createElement(g().default.Fragment,{key:t},Glamor.createElement("div",{css:dn.errorFilename(t<2)},e),!a&&Glamor.createElement("span",{css:dn.errorFilenameDivider},"|"))}))),Glamor.createElement("div",{css:dn.errorGroupDescription},this._renderErrorDescription(e.type)))},this._renderErrorDescription=e=>"unsupported-type"===e?Glamor.createElement(g().default.Fragment,null,"Unsupported file type. Please use PNG / JPG for photos and MP4 / MOV for videos."):"unsupported-duration"===e?Glamor.createElement(g().default.Fragment,null,"Instagram does not accept videos longer than 1 minute. Please cut this video in parts with ",Glamor.createElement("a",{href:"https://ezgif.com/cut-video",target:"_blank"},"EzGif")," or post it as IGTV."):"unsupported-ratio"===e?Glamor.createElement(g().default.Fragment,null,"Unsupported size ratio. Please check the aspect ratios Instagram supports on our ",Glamor.createElement("a",{href:"https://inssist.com/faq#images-are-cut-or-videos-do-not-upload",target:"_blank"},"FAQ page"),"."):"unsupported-codec"===e?Glamor.createElement(g().default.Fragment,null,"Unsupported video codec. A MP4-h264 or WEBM is recommended. Find more on our ",Glamor.createElement("a",{href:"https://inssist.com/faq#images-are-cut-or-videos-do-not-upload",target:"_blank"},"FAQ page"),"."):"file-size-limit-reached"===e?Glamor.createElement(g().default.Fragment,null,"The file is above ",Ws.config.maxFileSizeStr," and is too large to upload. Please resize or compress the file and try again."):"post-count-limit-reached"===e?Glamor.createElement(g().default.Fragment,null,"Post count limit reached. You have reached a limit of ",Ws.config.maxPostCount," local posts. Please schedule or remove some posts before adding more."):"failed-to-read-csv"===e?Glamor.createElement(g().default.Fragment,null,"Failed to read CSV file."):"unknown"===e?Glamor.createElement(g().default.Fragment,null,"Oops... Instagram did not like this file 🤭. Please try again later or pick another file."):"",this._onCloseClick=()=>{C().transaction((e=>{e.schedule.fileUploadErrors=[]}))},t}render(){return Glamor.createElement(p().default.SnackbarItem,{id:"schedule-file-error-card-mediator",show:this.props.fileUploadErrors.length>0},Glamor.createElement(p().default.ScheduleErrorCard,{title:"Failed uploading files",content:this._renderContent(),onCloseClick:this._onCloseClick}))}}var hn=C().influx((e=>({fileUploadErrors:e.schedule.fileUploadErrors})))(un),mn={init:function(){document.addEventListener("click",(()=>{v().iframeBus.send("feature-encourage.app-click")})),v().iframeBus.on("feature-encourage.toggle-creation-card",gn),v().iframeBus.on("feature-encourage.post-creation-carousel-click",pn),v().iframeBus.on("feature-encourage.post-creation-schedule-click",fn)}};function gn(e){C().transaction((t=>{t.igView.creationCardShown=e}))}async function pn({file:e,caption:t}){m().gaController.sendEvent("user","feature-encourage:post-creation-carousel-click"),await new Promise((s=>{na.chooseFiles((async a=>{C().transaction((e=>{e.sidebar.isOpen=!0,e.sidebar.selectedTabId="tab-scheduling"})),await na.addFiles([e,...a],{isCarousel:!0,postMode:"publish"}),await v().iframeBus.send("schedule.set-caption",t,{force:!0}),s()}))}))}async function fn({file:e,caption:t}){m().gaController.sendEvent("user","feature-encourage:post-creation-schedule-click"),await new Promise((s=>{C().transaction((e=>{e.sidebar.isOpen=!0,e.sidebar.selectedTabId="tab-scheduling"})),setTimeout((async()=>{await na.addFiles([e],{isCarousel:!1,postMode:"schedule"}),await v().iframeBus.send("schedule.set-caption",t,{force:!0}),s()}))}))}g(),p(),v(),b(),m(),C();const Cn={story:"feature-encourage-ig-creation-card-mediator.story",post:"feature-encourage-ig-creation-card-mediator.post",reels:"feature-encourage-ig-creation-card-mediator.reels",igtv:"feature-encourage-ig-creation-card-mediator.igtv",carousel:"feature-encourage-ig-creation-card-mediator.carousel",scheduled:"feature-encourage-ig-creation-card-mediator.scheduled"};g().default.SvgIcon.registerSvgIcons([`<symbol id="${Cn.story}" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12.474 22.779a11.28 11.28 0 01-5.294-1.32.777.777 0 11.732-1.37 9.741 9.741 0 006.775.884.777.777 0 01.353 1.513 11.326 11.326 0 01-2.566.293zm-7.205-2.871a.773.773 0 01-.534-.213 11.218 11.218 0 01-3.2-5.509.777.777 0 011.51-.366 9.667 9.667 0 002.757 4.748.777.777 0 01-.534 1.34zm-3.221-8.651h-.077a.776.776 0 01-.7-.849 11.174 11.174 0 01.995-3.632.777.777 0 011.408.656 9.618 9.618 0 00-.854 3.122.777.777 0 01-.772.703zm3.258-6.58a.777.777 0 01-.6-1.269q.1-.127.211-.25a.777.777 0 111.171 1.02c-.062.071-.122.143-.182.215a.776.776 0 01-.6.284zm12.543 16.62a.777.777 0 01-.4-1.443 9.7 9.7 0 00-4.975-18.03.777.777 0 110-1.554 11.255 11.255 0 015.773 20.917.77.77 0 01-.398.11z" fill="currentColor"/><path d="M17.723 10.788h-4.45v-4.45H11.72v4.45H7.27v1.553h4.45v4.45h1.553v-4.45h4.45z" fill="currentColor"/></symbol>`,`<symbol id="${Cn.post}" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M7.164 22.654A5.17 5.17 0 012 17.49V7.164A5.17 5.17 0 017.164 2H17.49a5.17 5.17 0 015.164 5.164V17.49a5.17 5.17 0 01-5.164 5.164zm0-1.757H17.49a3.794 3.794 0 003.41-3.407V14.8l-3.68-3.661-4.394 5.934L8 14.866 3.766 17.7a3.832 3.832 0 003.398 3.2zM3.757 7.164v8.4L7.8 12.785l4.5 2.081 4.681-6.525 3.919 3.922v-5.1a3.794 3.794 0 00-3.41-3.406H7.164a3.794 3.794 0 00-3.407 3.407zm3.943.874a1.709 1.709 0 111.7 1.708 1.709 1.709 0 01-1.7-1.708z" fill="currentColor"/></symbol>`,`<symbol id="${Cn.reels}" viewBox="0 0 24 24"><path d="M15.548 14.007l-.006-.005-.006-.004-4.696-2.73s0 0 0 0a.736.736 0 00-.381-.113.73.73 0 00-.373.108c-.262.11-.407.371-.407.662v5.464c0 .262.155.511.398.658h0l.009.004a.899.899 0 00.352.098.88.88 0 00.314-.069l.063-.022.012-.004.012-.006 4.697-2.732h0l.001-.001a.743.743 0 00.357-.658c0-.259-.152-.505-.346-.65zM20.764 3.85h0l-.003-.004c-.534-.513-1.125-.945-1.943-1.247-.816-.301-1.85-.47-3.264-.47h-6.5c-1.394 0-2.417.169-3.233.476-.818.307-1.42.75-1.974 1.283h0l-.003.004C3.33 4.428 2.9 5.02 2.599 5.834c-.3.812-.469 1.837-.469 3.234v6.514c0 1.396.169 2.432.475 3.255.306.824.748 1.428 1.282 1.964l.002.002c.534.513 1.126.945 1.943 1.246.816.302 1.85.47 3.264.47h6.5c1.394 0 2.428-.168 3.249-.475.823-.307 1.425-.75 1.96-1.285l.001-.002c.513-.535.944-1.128 1.245-1.947.3-.817.469-1.853.469-3.27V9.068c0-1.397-.169-2.422-.475-3.24-.306-.819-.748-1.422-1.28-1.977zm-5.168-.2c1.31 0 2.174.166 2.788.41.612.244.985.567 1.314.896.466.468.897 1.045 1.149 2.216h-3.665L15.19 3.65h.406zm-6.948 0h4.734l1.991 3.522H10.64L8.648 3.65zM4.952 4.957c.435-.436.982-.87 2.065-1.12l1.897 3.336h-5.11c.25-1.17.682-1.748 1.148-2.216zm16.05 10.667c0 1.313-.167 2.178-.41 2.794-.243.613-.565.987-.894 1.316-.328.33-.712.652-1.33.896-.62.244-1.482.411-2.772.411H9.054c-1.31 0-2.174-.167-2.788-.411-.612-.243-.985-.566-1.314-.896a3.699 3.699 0 01-.893-1.332c-.244-.62-.41-1.486-.41-2.778v-6.93h17.353v6.93z" fill="currentColor" stroke="currentColor" stroke-width=".26"/></symbol>`,`<symbol id="${Cn.igtv}" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><g fill="currentColor"><path d="M22.643 10.555c-.007-.53-.023-.874-.045-1.35v-.109a7.646 7.646 0 00-.478-2.512 5.3 5.3 0 00-3.039-3.04 7.729 7.729 0 00-2.509-.48 47.27 47.27 0 00-2.311-.057l1.3-1.412a.941.941 0 00-.07-1.347.966.966 0 00-1.358.064l-1.806 1.96L10.529.314a.973.973 0 00-1.36-.066.944.944 0 00-.317.659.921.921 0 00.253.686L10.4 3.009c-1.088.005-1.5.017-2.311.055a7.771 7.771 0 00-2.512.48 5.1 5.1 0 00-1.838 1.2 5.147 5.147 0 00-1.2 1.841 7.74 7.74 0 00-.477 2.516C2.012 10.186 2 10.548 2 13.332s.012 3.146.062 4.236a7.673 7.673 0 00.481 2.509 5.322 5.322 0 003.037 3.04 7.62 7.62 0 002.512.483c1.088.047 1.415.057 4.238.057s3.151-.01 4.236-.057a7.565 7.565 0 002.509-.483 5.3 5.3 0 003.039-3.04 7.578 7.578 0 00.478-2.509c.052-1.061.062-1.382.062-4.236 0-1.34 0-2.177-.012-2.777m-1.959 2.777c0 1.432 0 2.165-.01 2.7-.01.555-.025.9-.047 1.434v.007a5.654 5.654 0 01-.352 1.89 3.326 3.326 0 01-1.915 1.91 5.463 5.463 0 01-1.885.349c-1.058.05-1.38.06-4.145.06s-3.087-.01-4.147-.06a5.538 5.538 0 01-1.882-.345 3.139 3.139 0 01-1.157-.753 3.128 3.128 0 01-.756-1.157 5.691 5.691 0 01-.347-1.89c-.047-1.045-.062-1.325-.062-4.144s.015-3.1.062-4.147a5.6 5.6 0 01.343-1.885 3.072 3.072 0 01.756-1.16A3.137 3.137 0 016.3 5.385a5.679 5.679 0 011.888-.349c1.07-.047 1.392-.057 4.147-.057s3.077.01 4.145.057a5.617 5.617 0 011.885.349 3.16 3.16 0 011.162.756 3.049 3.049 0 01.748 1.16 5.53 5.53 0 01.352 1.885c.047 1.07.057 1.395.057 4.147"/><path d="M11.475 14.88v-1.45a.124.124 0 00-.158-.119l-4.012 1.155a.93.93 0 01-1.185-.827.945.945 0 01.694-.966l5.57-1.6a.743.743 0 01.949.714v1.449a.124.124 0 00.158.119l3.859-1.112a.93.93 0 011.185.827.943.943 0 01-.694.965l-5.417 1.561a.743.743 0 01-.949-.714"/></g></symbol>`,`<symbol id="${Cn.carousel}" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M10.03 22a4.283 4.283 0 01-2.605-.876 4.363 4.363 0 01-1.539-2.212h2a2.483 2.483 0 002.14 1.235h8.647a2.474 2.474 0 002.471-2.471V9.03a2.483 2.483 0 00-1.235-2.14v-2a4.365 4.365 0 012.212 1.539A4.283 4.283 0 0123 9.03v8.647A4.329 4.329 0 0118.677 22zm-3.706-3.706A4.328 4.328 0 012 13.97V5.324A4.328 4.328 0 016.324 1h8.646a4.328 4.328 0 014.324 4.324v8.646a4.328 4.328 0 01-4.324 4.324zM3.853 5.324v8.646a2.474 2.474 0 002.471 2.471h8.646a2.474 2.474 0 002.471-2.471V5.324a2.474 2.474 0 00-2.471-2.471H6.324a2.474 2.474 0 00-2.471 2.471z" fill="currentColor"/></symbol>`,`<symbol id="${Cn.scheduled}" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M13.841 1.565A9.936 9.936 0 003.906 11.5H.594l4.372 4.449 4.46-4.449H6.114a7.765 7.765 0 112.274 5.453L6.82 18.522a9.933 9.933 0 107.021-16.957zm-1.1 5.52v5.52l4.725 2.8.795-1.336-3.864-2.3V7.085z" fill="currentColor"/></symbol>`]);class vn extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onStoryClick=()=>{m().gaController.sendEvent("user","feature-encourage:story-click"),v().iframeBus.send("feature-encourage.start-story-creation")},this._onPhotoVideoClick=()=>{m().gaController.sendEvent("user","feature-encourage:photo-video-click"),v().iframeBus.send("feature-encourage.start-post-creation")},this._onReelsClick=()=>{m().gaController.sendEvent("user","feature-encourage:reels-click"),v().iframeBus.send("feature-encourage.start-reels-creation")},this._onIgtvVideoClick=()=>{m().gaController.sendEvent("user","feature-encourage:igtv-video-click"),C().transaction((e=>{e.igtvUpload.shown=!0}))},this._onCarouselPostClick=()=>{m().gaController.sendEvent("user","feature-encourage:carousel-post-click"),this._openScheduleNewPost()},this._onScheduledPostClick=()=>{m().gaController.sendEvent("user","feature-encourage:scheduled-post-click"),this._openScheduleNewPost()},this._openScheduleNewPost=()=>{C().transaction((e=>{e.sidebar.selectedTabId="tab-scheduling",e.sidebar.isOpen=!0})),na.openNewPost()},t}render(){return Glamor.createElement(p().default.IgCreationCard,{buttons:[{icon:Cn.story,label:"STORY",onClick:this._onStoryClick},{icon:Cn.post,label:"PHOTO / VIDEO",onClick:this._onPhotoVideoClick},{icon:Cn.reels,label:"REELS",badge:this.props.hasReelsPro?null:"PRO",onClick:this._onReelsClick},{icon:Cn.igtv,label:"IGTV VIDEO",onClick:this._onIgtvVideoClick},{icon:Cn.carousel,label:"CAROUSEL POST",badge:this.props.hasScheduleAccess?null:"PRO",onClick:this._onCarouselPostClick},{icon:Cn.scheduled,label:"SCHEDULED POST",badge:this.props.hasScheduleAccess?null:"PRO",onClick:this._onScheduledPostClick}].filter(Boolean)})}}var bn=C().influx((e=>({hasReelsPro:b().stateProxy.hasPro({feature:"reels"})})))(vn);k(),m(),C(),v(),u(),b();var kn={init:function(){window.addEventListener("message",(e=>{"ig-patch-corrupted"===e.data.name&&m().gaController.sendEvent("system","ig-patch-corrupted")})),function(){let e=!1;window.addEventListener("hashchange",(()=>{if(e)return;const t=location.hash;if(!t.startsWith("#instagram.com/"))return;const s=t.split("instagram.com")[1];v().iframeBus.send("ig.ajax-go",s)})),v().iframeBus.on("ig.url-change",(t=>{e=!0;const s=`instagram.com${t}`;history.replaceState(null,null,`inssist.html#${s}`),e=!1}))}(),v().iframeBus.on("ig.error",wn),v().iframeBus.on("ig.path-change",Sn),v().iframeBus.on("ig.media-open",yn),v().iframeBus.on("ig.media-fullscreen-enter",_n),v().iframeBus.on("ig.open-sidebar-dm",Tn),v().iframeBus.on("ig.start-conversation-in-sidebar-dm",En),v().iframeBus.on("ig.check-has-pro",Pn),v().iframeBus.on("ig.update-ig-view",An),v().iframeBus.on("ig.is-fullscreen",In)}};function wn(e){u().sentryController.sendError(`ig: ${e}`,"error",null,{actor:"instagram"})}function Sn(e){e.startsWith("/stories/")||e.startsWith("/direct/")||localStorage.setItem("instagram-iframe-path",e)}function _n({url:e,currentTime:t,volume:s,muted:a,paused:n}){const o=document.createElement("video"),i=o.requestFullscreen||o.webkitRequestFullScreen;document.body.appendChild(o),o.setAttribute("src",e),i.call(o),o.disablePictureInPicture=!0,o.currentTime=t,o.volume=s,o.muted=a,n||o.play(),document.addEventListener("fullscreenchange",(function t(){document.fullscreenElement||(v().iframeBus.send("ig.media-fullscreen-exit",{url:e,currentTime:o.currentTime,volume:o.volume,muted:o.muted}),o.remove(),document.removeEventListener("fullscreenchange",t))}))}function yn({url:e}){chrome.tabs.create({url:e,active:!0})}function Tn(){C().transaction((e=>{e.sidebar.isOpen=!0,e.sidebar.selectedTabId="tab-dm"}))}async function En(e){v().iframeBus.send("dm.start-conversation",e),await k().default(120),Tn()}function Pn(){return b().stateProxy.hasPro()}async function An(e){C().transaction((t=>{"fullscreenWidth"in e&&(t.igView.fullscreenWidth=e.fullscreenWidth),"withBorder"in e&&(t.igView.withBorder=e.withBorder)})),await new Promise((e=>{requestAnimationFrame(e)}))}function In(){return C().model.state.igView.fullscreen}var xn={init:function(){kn.init()},getInitialUrl:function(){let e;"instagram-iframe-path"in localStorage?(localStorage.removeItem("instagram-iframe-url"),e=`https://www.instagram.com${localStorage.getItem("instagram-iframe-path")}`):e="instagram-iframe-url"in localStorage?localStorage.getItem("instagram-iframe-url"):"https://www.instagram.com";(function(e){const t=e.split("/");return Dn.some((e=>{const s=e.split("/");if(s.length!==t.length)return!1;for(let e=0;e<t.length;e+=1){const a=t[e],n=s[e];if(n!==a&&(!n.startsWith("<")||!n.endsWith(">")))return!1}return!0}))})(function(e){let t=e.split("?")[0].split("/").slice(3).join("/");t.startsWith("/")||(t=`/${t}`);t.endsWith("/")||(t=`${t}/`);return t}(e))||(e="https://www.instagram.com");return e}};const Dn=["/","/explore/","/explore/people/suggested/","/accounts/activity/","/accounts/edit/","/<username>/","/<username>/followers/","/<username>/following/","/<username>/feed/","/<username>/channel/","/<username>/saved/","/<username>/tagged/","/<username>/reels/","/p/<postId>/","/reel/<postId>/"];class Gn extends g().default.Component{constructor(e){super(e),this._initIframe=()=>{this.setState({iframeUrl:xn.getInitialUrl()})},this._onIframeReady=()=>{this.setState({isLoadingShown:!1})},this._onIframePathChange=e=>{this.setState({isDarkBackground:e.startsWith("/stories/")||e.startsWith("/create/story")})},this.state={iframeUrl:null,isDarkBackground:!1,isLoadingShown:!0}}componentDidMount(){v().iframeBus.on("ig.ready",this._onIframeReady),v().iframeBus.on("ig.path-change",this._onIframePathChange),setTimeout(this._initIframe,70)}componentWillUnmount(){v().iframeBus.off("ig.ready",this._onIframeReady),v().iframeBus.off("ig.path-change",this._onIframePathChange)}render(){let e=this.state.isDarkBackground;return"night"===this.state.theme&&(e=!e),Glamor.createElement(p().default.IgView,{iframeAttrs:{src:!1!==_().env.features.iframes?this.state.iframeUrl:null,name:ke.createName("inssist-ig",{theme:this.state.theme,fusionConfig:Se.getConfig(),isElectron:!!window.electron}),allow:"geolocation; autoplay"},isFrameless:this.props.isFrameless,isDarkBackground:e,isLoadingShown:this.state.isLoadingShown,isSplashShown:this.props.isSplashShown,isCreationCardShown:this.props.creationCardShown,creationCard:Glamor.createElement(bn,{hasScheduleAccess:this.props.hasScheduleAccess})})}}var Fn=C().influx((e=>({creationCardShown:e.igView.creationCardShown,hasScheduleAccess:b().stateProxy.hasPro({feature:"schedule"})})))(g().default.theme.ThemeAware(Gn));y(),S();var On={init:async function(){const e=await y().default(chrome.tabs.getCurrent);S().chromeBus.send("core-web-request.popup-tab-id",e.id)}};g(),H(),v();var Bn={init:function(){v().iframeBus.on("theme.get-theme",Un),g().default.theme.onThemeChange(Ln)}};function Un(){return g().default.theme.getTheme()}function Ln(e){H().default.set("theme",e),v().iframeBus.send("theme.switch-theme",e)}v(),C(),C(),b(),v(),m();var Mn={init:function(){C().model.observe((e=>e.dm.ghostModeEnabled),(e=>{v().iframeBus.send("dm.ghost-mode:toggled",e)})),v().iframeBus.on("dm.ghost-mode:is-enabled",Rn),v().iframeBus.on("dm.ghost-mode:failed",Nn),v().iframeBus.on("dm.ghost-mode:increment-trial-usage",zn)}};function Rn(){return C().model.state.dm.ghostModeEnabled}function Nn(e={}){C().transaction((e=>{e.dm.ghostModeFailed=!0,e.dm.ghostModeEnabled=!1})),m().gaController.sendEvent("user","dm:ghost-mode-failed",JSON.stringify(e))}function zn(e=0){b().stateProxy.hasProPaid()&&m().gaController.sendEvent("user","pro-paid-usage:dm-ghost-mode"),C().transaction((t=>{t.billing.trial.dmAdvanced+=e}))}var Hn={init:function(){v().iframeBus.on("dm.ig-go",Vn),v().iframeBus.on("dm.update-badge",Wn),Mn.init()}};function Vn(e){v().iframeBus.send("ig.ajax-go",e)}function Wn(e){C().transaction((t=>{t.dm.badgeText=e}))}g(),p(),_(),C(),b(),v(),m();class $n extends g().default.Component{constructor(e){super(e),this._onChange=({filterString:e,filterUnread:t,filterFlagged:s,ghostModeEnabled:a})=>{let n;C().transaction((e=>{e.dm.ghostModeEnabled!==a&&(a?m().gaController.sendEvent("user","dm:ghost-mode-on"):m().gaController.sendEvent("user","dm:ghost-mode-off")),e.dm.ghostModeEnabled=a})),this.state.filterUnread&&s&&(t=!1),this.state.filterFlagged&&t&&(s=!1),this.setState({filterString:e,filterUnread:t,filterFlagged:s}),v().iframeBus.send("dm.set-filters",{string:e,unread:t,flagged:s}),e&&this.state.filterString!==e?n="dm:filter-string":!this.state.filterUnread&&t?n="dm:filter-unread":!this.state.filterFlagged&&s&&(n="dm:filter-flagged"),clearTimeout(this._sendGaEventTimeout),n&&(this._sendGaEventTimeout=setTimeout((()=>{m().gaController.sendEvent("user",n)}),1e3))},this._onUpgradeClick=()=>{ze.openBilling("dm")},this._onCancelClick=()=>{this._onChange({filterString:"",filterUnread:!1,filterFlagged:!1,ghostModeEnabled:!1})},this._sendGaEventTimeout=null,this.state={filterString:"",filterUnread:!1,filterFlagged:!1}}componentDidUpdate(e){e.dmOpen&&!this.props.dmOpen&&v().iframeBus.send("dm.go-to-inbox")}render(){const e=ke.createName("inssist-dm",{theme:this.state.theme,fusionConfig:Se.getConfig(),isElectron:!!window.electron}),t=!1!==_().env.features.iframes?"https://www.instagram.com/direct/inbox/":null;return Glamor.createElement(p().default.DmSidePanel,{iframeAttrs:{name:e,src:t,allow:"geolocation; autoplay"},filterString:this.state.filterString,filterUnread:this.state.filterUnread,filterFlagged:this.state.filterFlagged,ghostModeEnabled:this.props.ghostModeFailed?null:this.props.ghostModeEnabled,ghostModeTooltip:this._getGhostModeTooltip(),showOverlay:this.showOverlay(),onChange:this._onChange,onUpgradeClick:this._onUpgradeClick,onCancelClick:this._onCancelClick,upsellOverlay:this._renderUpsellOverlay(),upsellOverlayHeaderText:Glamor.createElement(g().default.Fragment,null,"Ghost Mode is a PRO feature.",Glamor.createElement("br",null),"Please consider upgrading to support development.")})}_getGhostModeTooltip(){return{title:"GHOST MODE",text:["If enabled, the messages you read won’t be marked as seen and other users won’t know that you read their messages.","Ghost Mode is a PRO feature and is available to try out for a limited time."]}}_renderUpsellOverlay(){return Glamor.createElement(mt,{show:this.showOverlay(),feature:"dm"})}showOverlay(){return this.props.ghostModeEnabled&&!this.props.ghostModeFailed&&!this.props.hasDmAdvanced}}var qn=C().influx((e=>({dmOpen:e.sidebar.isOpen&&"tab-dm"===e.sidebar.selectedTabId,hasDmAdvanced:b().stateProxy.hasPro({feature:"dmAdvanced"}),ghostModeFailed:e.dm.ghostModeFailed,ghostModeEnabled:e.dm.ghostModeEnabled})))(g().default.theme.ThemeAware($n));S(),C();var jn={cleanUpState:async function(){await new Promise((e=>{let t;S().chromeBus.send("cleanup.clean-up-state").then((e=>{t=e}));const s=C().model.observe((e=>e.cleanupId),(a=>{t&&a===t&&(C().transaction((e=>{delete e.cleanupId})),setTimeout((()=>s())),e())}))}))}};v();var Yn={init:function(){return}};m(),C(),v();var Kn={init:function(){v().iframeBus.on("zen.is-enabled",Zn),v().iframeBus.on("zen.turn-off-click",Qn)},toggleZenMode:Jn};function Zn(){return C().model.state.zen.enabled}function Jn({value:e=null,sendGaEvent:t=!0}={}){C().transaction((t=>{t.zen.enabled="boolean"==typeof e?e:!t.zen.enabled}));const s=C().model.state.zen.enabled;t&&(s?m().gaController.sendEvent("user","zen:toggle-on"):m().gaController.sendEvent("user","zen:toggle-off")),v().iframeBus.send("zen.toggled",s)}function Qn(){Jn({value:!1,sendGaEvent:!1}),m().gaController.sendEvent("user","zen:turn-off-click")}C(),v();var Xn={init:function(){v().iframeBus.on("new-post-extra.click-option",eo),v().iframeBus.on("new-post-extra.enter-page",to),v().iframeBus.on("new-post-extra.exit-page",so),C().model.observe((e=>e.coverAssist.shown?"cover-assist":e.tagAssist.shown?"tag-assist":null),(e=>{v().iframeBus.send("new-post-extra.synch-selected-option",e)}))}};function eo(e){C().transaction((t=>{const s=t.coverAssist.shown?"cover-assist":t.tagAssist.shown?"tag-assist":null;t.tagAssist.shown=!1,t.coverAssist.shown=!1,e!==s&&("tag-assist"===e?t.tagAssist.shown=!0:"cover-assist"===e&&(t.coverAssist.shown=!0))}))}function to({isVideo:e}){C().transaction((t=>{e?(t.tagAssist.shown=!1,t.coverAssist.shown=!0):(t.tagAssist.shown=!0,t.coverAssist.shown=!1),t.sidebar.isOpen=!1}))}function so(){C().transaction((e=>{e.tagAssist.shown=!1,e.coverAssist.shown=!1}))}m(),C(),b(),S(),v(),ne();var ao={init:function(){C().model.observe((e=>e.coverAssist.coverUrl),(async e=>{if(e){const t=await fetch(e),s=await t.blob();v().iframeBus.send("cover-assist.synch-cover",s)}else v().iframeBus.send("cover-assist.synch-cover",null)})),v().iframeBus.on("new-post-extra.creation-video-change",no),v().iframeBus.on("ig.submit-post",oo)}};async function no(e){if(C().transaction((e=>{Object.assign(e.coverAssist,ne().default)})),!e)return;const t=await async function(e,t){return new Promise((s=>{const a=document.createElement("canvas"),n=a.getContext("2d"),o=[],i=document.createElement("video");i.src=e,i.muted=!0,i.addEventListener("loadedmetadata",(()=>{a.width=i.videoWidth,a.height=i.videoHeight,r()})),i.addEventListener("timeupdate",(()=>{n.drawImage(i,0,0),a.toBlob((e=>{const t=URL.createObjectURL(e);o.push(t),r()}),"image/jpeg")}));const r=()=>{const e=i.duration/(t+1),n=o.length;n<t?i.currentTime=(n+1)*e:(i.remove(),a.remove(),s(o))}}))}(e,12),s=C().model.state.authStatus.username,a=await S().chromeBus.send("ig-api.fetch-user-posts",s,14);let n=[];a.result&&(n=a.result.map((e=>e.imgx))),C().transaction((s=>{s.coverAssist.loading=!1,s.coverAssist.videoUrl=e,s.coverAssist.frameGalleryImages=t,s.coverAssist.frameGallerySelectedImage=null,s.coverAssist.gridImages=n}))}function oo(){const e=C().model.state;if(!e.coverAssist.coverUrl)return;const t=e.coverAssist.selectedTabId;"auto"===t?m().gaController.sendEvent("user","cover-assist:submit-cover-auto"):"frame"===t?m().gaController.sendEvent("user","cover-assist:submit-cover-frame"):"upload"===t&&m().gaController.sendEvent("user","cover-assist:submit-cover-upload"),function(e=0){b().stateProxy.hasProPaid()&&m().gaController.sendEvent("user","pro-paid-usage:cover-assist");C().transaction((t=>{t.billing.trial.coverAssist+=e}))}(1)}g(),p(),m(),C(),b(),v();class io extends g().default.Component{constructor(e){super(e),this._onCloseClick=()=>{C().transaction((e=>{e.coverAssist.shown=!1}))},this._onTabClick=e=>{C().transaction((t=>{t.coverAssist.selectedTabId=e,this.props.hasCoverAssistFeature&&("auto"===e?t.coverAssist.coverUrl=t.coverAssist.frameGallerySelectedImage:"frame"===e?t.coverAssist.coverUrl=t.coverAssist.frameSelectImage:"upload"===e&&(t.coverAssist.coverUrl=t.coverAssist.frameUploadImage))}))},this._onUpgradeToProClick=()=>{ze.openBilling("cover-assist"),m().gaController.sendEvent("user","cover-assist:upgrade-to-pro-click")},this._onResetClick=()=>{C().transaction((e=>{e.coverAssist.selectedTabId="auto",e.coverAssist.frameGallerySelectedImage=null,e.coverAssist.coverUrl=null}))},this._onGridButtonClick=()=>{C().transaction((e=>{e.coverAssist.showGrid=!e.coverAssist.showGrid}))},this._onFrameGalleryImageClick=e=>{C().transaction((t=>{t.coverAssist.frameGallerySelectedImage=e,this.props.hasCoverAssistFeature?t.coverAssist.coverUrl=e:this._showUpsell()}))},this._onFrameSelectValueChange=e=>{C().transaction((t=>{t.coverAssist.frameSelectValue=e}))},this._onFrameSelectImageSelect=e=>{C().transaction((t=>{"frame"===t.coverAssist.selectedTabId&&(t.coverAssist.frameSelectImage=e,this.props.hasCoverAssistFeature?t.coverAssist.coverUrl=e:this._showUpsell())}))},this._onFrameUploadFileSelect=async e=>{const t=document.createElement("img");let s=null,a=null;await new Promise((n=>{t.src=URL.createObjectURL(e),t.addEventListener("load",(()=>{s=t.width,a=t.height,n()}))}));const n=document.createElement("canvas"),o=this.props.isCreatingReels?9/16:1;let i,r;s/a>o?(r=a,i=r*o):(i=s,r=i/o);const l=(s-i)/2,c=(a-r)/2,d=n.getContext("2d");n.width=i,n.height=r,d.drawImage(t,l,c,i,r,0,0,i,r);const u=await new Promise((e=>{n.toBlob(e,"image/jpeg")})),h=URL.createObjectURL(u);C().transaction((e=>{e.coverAssist.frameUploadImage=h,this.props.hasCoverAssistFeature?e.coverAssist.coverUrl=h:this._showUpsell()}))},this._showUpsell=()=>{setTimeout((()=>{this.setState({showUpsell:!0})}),500)},this._onUpsellOverlayClick=()=>{this.setState({showUpsell:!1})},this.state={showUpsell:!1,defaultIgCoverUrl:null},v().iframeBus.send("cover-assist.get-default-ig-cover-url",(e=>{this.setState({defaultIgCoverUrl:e})}))}render(){return Glamor.createElement(p().default.CoverAssistPanel,{loading:this.props.loading,selectedTabId:this.props.selectedTabId,showGrid:this.props.showGrid,showResetButton:this.props.showResetButton,hasPro:this.props.hasCoverAssistFeature,resetDisabled:this.props.resetDisabled,frameGallery:this._getFrameGallery(),frameSelect:this._getFrameSelect(),frameUpload:this._getFrameUpload(),grid:this._getGrid(),upsellOverlay:this._getUpsellOverlay(),onCloseClick:this._onCloseClick,onTabClick:this._onTabClick,onUpgradeToProClick:this._onUpgradeToProClick,onResetClick:this._onResetClick,onGridButtonClick:this._onGridButtonClick})}_getFrameGallery(){return Glamor.createElement(p().default.CoverAssistFrameGallery,{images:this.props.frameGalleryImages,selectedImage:this.props.frameGallerySelectedImage,isReelsView:this.props.isCreatingReels,onImageClick:this._onFrameGalleryImageClick})}_getFrameSelect(){return Glamor.createElement(p().default.CoverAssistFrameSelect,{videoUrl:this.props.videoUrl,value:this.props.frameSelectValue,isReelsView:this.props.isCreatingReels,onValueChange:this._onFrameSelectValueChange,onImageSelect:this._onFrameSelectImageSelect})}_getFrameUpload(){return Glamor.createElement(p().default.CoverAssistFrameUpload,{image:this.props.frameUploadImage,isReelsView:this.props.isCreatingReels,onFileSelect:this._onFrameUploadFileSelect})}_getGrid(){const e=[this.props.coverUrl||this.state.defaultIgCoverUrl,...this.props.gridImages];return Glamor.createElement(p().default.CoverAssistGrid,{images:e})}_getUpsellOverlay(){return Glamor.createElement(mt,{show:this.state.showUpsell,feature:"cover-assist",onOverlayClick:this._onUpsellOverlayClick})}}var ro=C().influx((e=>({loading:e.coverAssist.loading,selectedTabId:e.coverAssist.selectedTabId,showGrid:e.coverAssist.showGrid,showResetButton:!!e.coverAssist.coverUrl,coverUrl:e.coverAssist.coverUrl,gridImages:e.coverAssist.gridImages,videoUrl:e.coverAssist.videoUrl,frameGalleryImages:e.coverAssist.frameGalleryImages,frameGallerySelectedImage:e.coverAssist.frameGallerySelectedImage,frameSelectImage:e.coverAssist.frameSelectImage,frameSelectValue:e.coverAssist.frameSelectValue,frameUploadImage:e.coverAssist.frameUploadImage,hasCoverAssistFeature:b().stateProxy.hasPro({feature:"coverAssist"}),isCreatingReels:e.reels.creating})))(io);v(),b(),m(),C();var lo={init:function(){v().iframeBus.on("story-link.get-user-data",co),v().iframeBus.on("story-link.save-click",uo),v().iframeBus.on("story-link.upgrade-to-pro-click",ho),v().iframeBus.on("story-link.story-with-link-submit",mo)}};function co(){const e=C().model.state,t=b().stateProxy.hasProPaid()||b().stateProxy.hasProPromocode(),s=2-e.billing.trial.addLinkToStory;return{hasEnoughFollowers:e.userDetails[e.authStatus.userId].followersCount>1e4,needProUpgrade:!t&&0===s,hasProPaid:t,trialLeftCount:s}}function uo(){m().gaController.sendEvent("user","story-link:save-click")}function ho(){ze.openBilling("story-link"),m().gaController.sendEvent("user","story-link:upgrade-to-pro-click")}function mo(){b().stateProxy.hasProPaid()&&m().gaController.sendEvent("user","pro-paid-usage:add-link-to-story"),C().transaction((e=>{e.billing.trial.addLinkToStory+=1}))}oe();var go=Object.assign((function(e,t=!1){0===po.length&&(fo=new MutationObserver((e=>{for(const t of po){if(fo.disconnect(),t(e),!fo)return;fo.observe(document.documentElement,{attributes:!0,childList:!0,subtree:!0})}})),fo.observe(document.documentElement,{attributes:!0,childList:!0,subtree:!0}));po.push(e),t&&e()}),{off:function(e){const t=po.indexOf(e);if(-1===t)return;po.splice(t,1),0===po.length&&(fo.disconnect(),fo=null)}});const po=[];let fo;S(),V();var Co={init:async function(){return void 0;ko=await V().idbController.get("image-proxy.cache")||{},bo=new Worker("/image-proxy/index-web-worker.js"),function(){const e=Symbol("prevUrl");go((()=>{oe().$$('[style*="background-image:url"], [style*="background-image: url"]').forEach((async t=>{const s=t.style.backgroundImage.split("(")[1].split(")")[0].replace(/['"]/g,"");if(!(s in ko))return;if(t[e]===s)return;const a=await async function(e){if(vo[e])return vo[e];return new Promise((t=>{bo.postMessage({url:e}),bo.addEventListener("message",(function s(a){a.data.originalUrl===e&&(bo.removeEventListener("message",s),vo[e]=a.data.objectUrl||e,t(vo[e]))}))}))}(s);t[e]=a,t.style.backgroundImage=`url('${a}')`,S().chromeBus.send("image-proxy.cache-item-used",s)}))}))}()},save:function(e){return void 0;S().chromeBus.send("image-proxy.save",e)}};const vo={};let bo,ko=null;y(),ie(),z(),v(),S(),b(),C(),m();var wo={init:function(){v().iframeBus.on("reels.is-pro",So),v().iframeBus.on("reels.is-mobile-session",_o),v().iframeBus.on("reels.get-trial-data",yo),v().iframeBus.on("reels.authorize",To),v().iframeBus.on("reels.open-billing",Eo),v().iframeBus.on("reels.creation-session-start",(()=>{C().transaction((e=>{e.reels.creating=!0}))})),v().iframeBus.on("reels.creation-session-end",(()=>{C().transaction((e=>{e.reels.creating=!1}))})),v().iframeBus.on("reels.submit-success",(()=>{m().gaController.sendEvent("user","reels:submit","mobile"),b().stateProxy.hasProPaid()?m().gaController.sendEvent("user","pro-paid-usage:reels","mobile"):C().transaction((e=>{e.billing.trial.reels+=1}))}))}};function So(){return b().stateProxy.hasPro({feature:"reels"})}function _o(){return C().model.state.authStatus.isMobileSession}function yo(){return{hasPro:b().stateProxy.hasPro(),freeReels:Math.max(0,2-C().model.state.billing.trial.reels),maxFreeReels:2}}async function To(){await S().chromeBus.send("auth.toggle-session-watcher",!1),await y().default(chrome.cookies.remove,{url:"https://*.instagram.com/*",name:"sessionid"});const e=await z().utils.createWindow("https://www.instagram.com/accounts/login/",{name:"reels.auth-window"}),t=await new Promise((t=>{(async()=>{await z().utils.waitForWindowClose(e),setTimeout((()=>{t(!1)}),2e3)})(),ie().default("reels.auth-result-cookie",(async e=>{const s="1"===e.value;t(s)}))}));await S().chromeBus.send("auth.toggle-session-watcher",!0),v().iframeBus.send("reels.auth-performed",t),S().chromeBus.send("auth.refresh-user",{isSettingSessionId:t})}function Eo(){m().gaController.sendEvent("user","reels:open-billing"),ze.openBilling("reels")}z(),A(),C(),S();var Po={init:function(){S().chromeBus.on("fb-api.auth-fcs",Ao)}};async function Ao({appId:e,stateCode:t,withCrossposting:s=!1}){const a=s?"https://business.facebook.com/media_manager/instagram/oauthlink/":"https://business.facebook.com/business/loginpage/igoauth/callback/",n=await z().utils.createWindow(A().default("https://api.instagram.com/oauth/authorize/",{app_id:e,state:C().model.state.schedule.fcsSetup.newApi?JSON.stringify({user_nonce:t,from_ig_login_upsell_sso:!1,login_source:"creator_studio"}):t,force_reauth:"true",response_type:"code",redirect_uri:a}));let o=null;return window.addEventListener("message",(function e(t){var s;"fb-api.connect-fcs"===t.data.name&&(window.removeEventListener("message",e),o=null==t||null===(s=t.data)||void 0===s?void 0:s.code)})),await z().utils.waitForWindowClose(n),o}v();var Io={init:function(){if(xo=!!window.electron,Do=ke.isIframe()&&ke.getParams().isElectron,!xo&&!Do)return;xo&&v().iframeBus.on("electron-links.open-url",Go);document.addEventListener("click",(e=>{const t=e.target.closest("a");if(!t)return;if("_blank"!==t.getAttribute("target"))return;const s=t.getAttribute("href");s.startsWith("/")||(e.preventDefault(),e.stopPropagation(),Do?v().iframeBus.send("electron-links.open-url",s):Go(s))}),{capture:!0})}};let xo,Do;function Go(e){chrome.tabs.create({url:e,active:!0})}oe(),v(),re();var Fo={init:function(){v().iframeBus.on("ig.ready",(()=>{Uo.resolve()})),function(){const e=window.fetch.bind(window);window.fetch=async(...t)=>{const s=t[0];return s&&Oo.domains.some((e=>s.includes(e)))&&(t[0]=await Lo(s)),e(...t)}}(),function(){const e=Oo.domains.map((e=>`img[src*="${e}"], [style*="${e}"]`)).join(", ");go((()=>{oe().$$(e).forEach((async e=>{const t="IMG"===e.tagName;let s;s=t?e.getAttribute("src"):e.style.backgroundImage.split("(")[1].split(")")[0].replace(/['"]/g,"");const a=await Lo(s);document.body.contains(e)&&a&&(t?e.setAttribute("src",a):e.style.backgroundImage=`url("${a}")`)}))}))}()}};const Oo={domains:["cdninstagram.com","fbcdn.net"]},Bo={},Uo=re().default();async function Lo(e){if(Bo[e])try{await fetch(Bo[e])}catch(t){delete Bo[e]}if(!Bo[e])try{await Uo,Bo[e]=await v().iframeBus.send("cdn-proxy.fetch-url",e)}catch{return e}return Bo[e]}var Mo={waitForBackground:async function(){const e=await new Promise((e=>chrome.runtime.getBackgroundPage((t=>e(t)))));await new Promise((t=>{const s=setInterval((()=>{e._backgroundReady&&(clearInterval(s),t())}),50)}))}};C();var Ro={init:function(){if(C().model.state.version>70)return;document.body.innerHTML='\n    <style>\n      .min-version {\n        width: 100%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n\n      .min-version__content {\n        width: 440px;\n        position: relative;\n        top: -40px;\n      }\n\n      .min-version__title {\n        font-size: 18px;\n        line-height: 24px;\n        font-weight: 600;\n      }\n\n      .min-version__text {\n        margin-top: 12px;\n      }\n\n      .min-version__paragraph {\n        font-size: 16px;\n        line-height: 24px;\n        margin-top: 12px;\n      }\n      .min-version__paragraph:first-child {\n        margin-top: 0;\n      }\n    </style>\n\n    <div class="min-version">\n      <div class="min-version__content">\n        <div class="min-version__title">\n          FAILED TO UPDATE\n        </div>\n        <div class="min-version__text">\n          <div class="min-version__paragraph">\n            Your Inssist plugin version is too old and Chrome has failed to fix and update it automatically 😵.\n          </div>\n          <div class="min-version__paragraph">\n            Please uninstall Inssist from <a href="chrome://extensions">chrome://extensions</a> page\n            in Chrome and reinstall from <a href="https://get.inssist.com">https://get.inssist.com</a>\n          </div>\n        </div>\n      </div>\n    </div>\n  ',document.body.addEventListener("click",(e=>{const t=e.target.closest("a");if(!t)return;e.preventDefault();const s=t.getAttribute("href");chrome.tabs.create({active:!0,url:s})}))}};S();var No={init:function(){return new Promise((e=>{const t=Math.random();S().chromeBus.send("chrome-tab.close",t),S().chromeBus.on("chrome-tab.close",(e=>{t!==e&&window.close()})),setTimeout(e,50)}))}};C(),v(),m();var zo=function(){v().iframeBus.on("ig.open-media",(()=>{m().gaController.sendEvent("user","ig:media-open")})),v().iframeBus.on("ig.submit-post",(e=>{"photo"===e?m().gaController.sendEvent("user","ig:submit-post-photo"):"video"===e&&m().gaController.sendEvent("user","ig:submit-post-video"),C().transaction((e=>{e.billing.trial.postsPublished=(e.billing.trial.postsPublished||0)+1}))})),v().iframeBus.on("ig.submit-story",(e=>{"photo"===e?m().gaController.sendEvent("user","ig:submit-story-photo"):"video"===e&&m().gaController.sendEvent("user","ig:submit-story-video"),C().transaction((e=>{e.billing.trial.storiesPublished=(e.billing.trial.storiesPublished||0)+1}))})),v().iframeBus.on("ig.open-dm",(()=>{m().gaController.sendEvent("user","ig:dm-open")})),v().iframeBus.on("dm.message-sent",(()=>{C().transaction((e=>{e.billing.trial.dmsSent=(e.billing.trial.dmsSent||0)+1}))}))};S(),o(),le(),ce(),C(),g();g(),p(),C(),v(),g(),p(),C(),m(),b(),g(),C(),f(),S(),m(),b(),p(),g(),_(),C();const Ho={placeholder:{width:"100%",height:300},iframeWrapper:{...g().default.relative()},iframeSubWrapper:{...g().default.absolute(". -16 . -124")},iframe:{border:"none"}};class Vo extends g().default.Component{render(){const e=!1!==_().env.features.iframes&&`https://inssist.com/share?theme=${this.state.theme}`;return this.props.isOpen?Glamor.createElement("div",{css:Ho.iframeWrapper},Glamor.createElement("div",{css:Ho.iframeSubWrapper},Glamor.createElement("iframe",{css:Ho.iframe,src:e,width:"100%",height:"300px"}))):Glamor.createElement("div",{css:Ho.placeholder})}}var Wo=C().influx((e=>({isOpen:e.sidebar.isOpen&&"logo"===e.sidebar.selectedTabId})))(g().default.theme.ThemeAware(Vo));const $o={root:{...g().default.padding("g2 g2 0 23")},card:{marginBottom:24,marginRight:10,"& a":{color:g().default.color.link,fontWeight:"inherit"}},rateUs:{marginLeft:-1,marginBottom:24,marginRight:8,"& a":{color:"inherit !important",fontWeight:700}},contacts:{...g().default.text.bleak},iframeWrapper:{...g().default.relative()},iframeSubWrapper:{...g().default.absolute(". -16 . -124")},iframe:{border:"none"}};g().default.Image.registerImages({"whats-new.fire":"ui-igswiss/billing-fire.png:50:50"});class qo extends g().default.Component{constructor(e){super(e),this._onRateUsClick=()=>{m().gaController.sendEvent("user","rate-us-mini:yes-click"),b().actions.acknowledge.dispatch("rateUs"),chrome.tabs.create({url:f().common.reviewsUrl})},this._onUpgradeClick=()=>{m().gaController.sendEvent("user","whats-new:upgrade-click"),ze.openBilling()},this._onGoToFaq=()=>{m().gaController.sendEvent("user","whats-new:faq-click"),chrome.tabs.create({url:f().common.faqUrl})},this._onSendReportClick=()=>{this.setState({isReportSent:!0}),S().chromeBus.send("overseer.send-report",{key:"user"})},this._onTheEndMoreInfoClick=()=>{C().transaction((e=>{e.acknowledged.theEnd=-1}))},this._whatsNewItems=b().getWhatsNewItems(),this.state={isReportSent:!1}}render(){return Glamor.createElement("div",{css:$o.root},this._renderHeader(),Glamor.createElement(g().default.Spacer,{height:"g1"}),this._renderProPanel(),Glamor.createElement(g().default.Spacer,{height:"g3"}),this._renderWhatsNew(),this._renderRateUs(),this._renderContacts())}_renderHeader(){return Glamor.createElement("div",{css:[g().default.row,g().default.alignItems.center,g().default.text.mainTitle]},"What's New")}_renderProPanel(){const{hasProPaid:e,hasProPromocode:t}=this.props;let s,a;return e||t?(a=!1,s="\n        Inssist PRO is active. All advanced features activated:\n        Scheduling, Tag Collections, Custom Covers and more."):(a=!0,s=Glamor.createElement(g().default.Fragment,null,"All basic features are free forever. Scheduling,",Glamor.createElement("br",null),"Tag Collections and more features are available on PRO:")),Glamor.createElement("div",{css:g().default.row},Glamor.createElement("div",null,Glamor.createElement(g().default.Image,{src:"whats-new.fire",width:19,height:19})),Glamor.createElement(g().default.Spacer,{width:"g1"}),Glamor.createElement("div",{css:g().default.column},Glamor.createElement("div",{css:[g().default.row,g().default.text.bleak]},s),Glamor.createElement(g().default.Spacer,{height:"g1"}),Glamor.createElement("div",{css:g().default.row},a&&Glamor.createElement(g().default.Fragment,null,Glamor.createElement(g().default.LinkButton,{label:"UPGRADE TO PRO",onClick:this._onUpgradeClick}),Glamor.createElement(g().default.Spacer,{width:"g3"})),Glamor.createElement(g().default.LinkButton,{label:"HELP & F.A.Q.",onClick:this._onGoToFaq}))))}_renderWhatsNew(){return Glamor.createElement("div",{css:$o.content},this.props.whatsNew.map((e=>{const t=this._whatsNewItems.find((t=>t.id===e.id));return t?"announcement"===t.id&&this.props.isAfterTheEndUser?null:Glamor.createElement(g().default.Card,{key:e.id,header:t.header,marker:!e.acknowledged&&g().default.color.link,subheader:t.subheader,hexImage:t.hexImage,content:this._renderWhatsNewItemContent(t),style:$o.card}):null})))}_renderWhatsNewItemContent(e){return"macos"===e.id?[Glamor.createElement(g().default.Fragment,null,"This release brings support for the experimental standalone MacOS version. You can download it ",Glamor.createElement("a",{href:"https://inssist.com",target:"_blank"},"from our website"),"."),Glamor.createElement(g().default.Fragment,null,"Reach out to us at ",Glamor.createElement("a",{href:"mailto:inssist@slashed.io"},"inssist@slashed.io")," and let us know what you think about the standalone build or if you find any bugs.")]:"announcement"===e.id?Glamor.createElement("div",null,"Following a complaint from Facebook Inc., we are removing features that can be potentially exploited to violate Instagram and Facebook Terms of Service: Analytics & Insights, Downloading, Reposting."):"posting-from-website"===e.id?[Glamor.createElement(g().default.Fragment,null,"Inssist now adds a [+] button to post to Instagram directly from the ",Glamor.createElement("a",{href:"https://instagram.com",target:"_blank"},"instagram.com")," website."),Glamor.createElement(g().default.Fragment,null,"Inssist will also auto-retry Reels posting if it fails on Instagram Server which improves posting stability.")]:e.content}_renderRateUs(){return this.props.showRateUs?Glamor.createElement("div",{css:$o.rateUs},Glamor.createElement(p().default.RateUsMini,{image:"rate-us-heart",content:Glamor.createElement("div",null,"Something is broken? Reach us at ",Glamor.createElement("a",{href:"mailto:inssist@slashedio.io"},"inssist@slashed.io"),Glamor.createElement(g().default.Spacer,{height:"g1"}),this.state.isReportSent?Glamor.createElement(g().default.Fragment,null,"Thank you! The bug report has been sent."):Glamor.createElement(g().default.Fragment,null,"Or send us a bug report:",Glamor.createElement("div",{css:g().default.row},Glamor.createElement(g().default.LinkButton,{small:!0,label:"SEND BUG REPORT",onClick:this._onSendReportClick}),Glamor.createElement(g().default.Spacer,{width:"g1"}),Glamor.createElement(g().default.InfoCircle,{tooltip:{text:Glamor.createElement(g().default.Fragment,null,"Clicking this button will send an internal technical data on this connectivity error to the development team for research. This data is not shared with 3rd parties.")}})))),onRateUsClick:this._onRateUsClick})):null}_renderContacts(){return Glamor.createElement("div",{css:$o.contacts},"Contact details: ",Glamor.createElement("a",{href:"mailto:inssist@slashed.io"},"inssist@slashed.io"),Glamor.createElement(g().default.Spacer,{height:24}),"Share a word about us:",Glamor.createElement(g().default.Spacer,{height:4}),Glamor.createElement(Wo,null))}}var jo=C().influx((e=>({hasPro:b().stateProxy.hasPro(),hasProPaid:b().stateProxy.hasProPaid(),hasProPromocode:b().stateProxy.hasProPromocode(),whatsNew:e.whatsNew,showRateUs:!e.rateUs.acknowledged,isAfterTheEndUser:e.isAfterTheEndUser})))(qo);C();var Yo=C().action("whats-new.acknowledge-all",((e,t)=>({...e,whatsNew:e.whatsNew.map((e=>({...e,acknowledged:!0})))})));const Ko=({props:e})=>({width:"100%",height:"100%",..."tab-dm"!==e.selectedTabId&&{...g().default.fixed("0 0 0 0"),visibility:"hidden",pointerEvents:"none"}}),Zo=({props:e})=>({width:"100%",height:"100%",...e.schedule.showFallback&&{width:"calc(100vw - 84px)",marginLeft:4},..."tab-scheduling"!==e.selectedTabId&&{...g().default.fixed("0 0 0 0"),visibility:"hidden",pointerEvents:"none"}}),Jo={dm:"sidebar-mediator.dm",covers:"sidebar-mediator.covers",schedule:"sidebar-mediator.schedule",hashtags:"sidebar-mediator.hashtags",billing:"sidebar-mediator.billing"};g().default.Image.registerImages({"sidebar-mediator.billing":"tab-billing.png:34:45"}),g().default.SvgIcon.registerSvgIcons([`<symbol id="${Jo.dm}" viewBox="0 0 43.414 43.414"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M42 1.414l-22.55 22.55M42 1.414l-14.35 41-8.2-18.45L1 15.764z"/></g></symbol>`,`<symbol id="${Jo.covers}" viewBox="0 0 35.699 48.18"><g transform="translate(-1317 -255)"><line y1="8" transform="translate(1326.5 256.5)" fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><path d="M0,16V0" transform="translate(1344.5 256.5)" fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><path d="M0,12V0" transform="translate(1335.5 256.5)" fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"/><path d="M30.891,0H2.808A2.809,2.809,0,0,0,0,2.808V22.466H33.7V2.808A2.809,2.809,0,0,0,30.891,0ZM0,29.331a5.617,5.617,0,0,0,5.617,5.617h5.617v5.617a5.617,5.617,0,0,0,11.233,0V34.947h5.617A5.617,5.617,0,0,0,33.7,29.331V26.523H0Zm16.85,9.127a2.106,2.106,0,1,1-2.106,2.106A2.106,2.106,0,0,1,16.85,38.458Z" transform="translate(1318 256)" fill="none" stroke="currentColor" stroke-width="2"/></g></symbol>`,`<symbol id="${Jo.schedule}" viewBox="0 0 42.004 42.004"><path d="M10.002 42.002a24.394 24.394 0 01-10-10v-26a6.007 6.007 0 016-6h26a24.394 24.394 0 0110 10v26a6.007 6.007 0 01-6 6zm-4-6a4.006 4.006 0 004 4h26a4 4 0 004-4V28.69l-.635-.6-1.855-1.748-.213-.207a1.713 1.713 0 00-2.3-.059l-4.164 3.563a3.726 3.726 0 01-2.619.908l2.154 4.092a.971.971 0 01-.365 1.3.881.881 0 01-.447.117.927.927 0 01-.812-.5l-6.648-12.6-4.57-8.67a1.722 1.722 0 00-3.039-.059L6.001 29.084zm-4-30v26a4 4 0 002 3.463V10.002a6 6 0 016-6h4a1 1 0 010 2h-4a4.008 4.008 0 00-4 4v15.313l6.9-12.062a3.539 3.539 0 016.256.107l2.939 5.582 1.637 3.092 2.92 5.537a1.968 1.968 0 001.367 1.031 1.926 1.926 0 001.637-.432l4.164-3.568a3.529 3.529 0 013.693-.564l1.855 1.459.635.6V10.002a4.006 4.006 0 00-4-4h-14a1 1 0 110-2H35.47a4.117 4.117 0 00-.637-.83 3.991 3.991 0 00-2.831-1.17h-26a4.007 4.007 0 00-4 4zm24.605 8.381a4.556 4.556 0 114.553 4.553 4.562 4.562 0 01-4.553-4.555zm1.768 0a2.789 2.789 0 102.785-2.791 2.788 2.788 0 00-2.785 2.789zM17.002 5.002a1 1 0 111 1 1 1 0 01-1-1z" fill="currentColor"/></symbol>`,`<symbol id="${Jo.hashtags}" viewBox="0 0 38.717 48.907"><path d="M3.802 48.907a3.889 3.889 0 01-3.8-3.8V4.725A4.726 4.726 0 014.725.003h33.051a.945.945 0 010 1.889 2.836 2.836 0 000 5.672.943.943 0 01.943.944v37.564a2.844 2.844 0 01-2.832 2.838zm-1.914-3.8a2.1 2.1 0 001.914 1.909h32.082a.943.943 0 00.943-.944V9.452H4.722a4.679 4.679 0 01-2.834-.974zm0-40.382a2.836 2.836 0 002.834 2.838H33.99a4.734 4.734 0 010-5.672H4.722a2.832 2.832 0 00-2.834 2.831zm19.471 35.412l.8-6.676h-7.207l-.84 6.676h-1.9l.8-6.676h-4.99v-1.934h5.238l.916-7.387H9.145v-1.934h5.273l.811-6.675h1.934l-.846 6.675h7.244l.809-6.675h1.9l-.811 6.675h4.955v1.934h-5.2l-.914 7.387h4.99v1.934h-5.24l-.8 6.676zm-6.189-8.609h7.244l.914-7.387h-7.207z" fill="currentColor"/></symbol>`,`<symbol id="${Jo.billing}" _dx="23%" viewBox="0 0 47.703 36.216"><path d="M18.108 18.108a8.554 8.554 0 10-8.554-8.554 8.579 8.579 0 008.554 8.554zm0 4.277C12.441 22.385 1 25.272 1 30.939v4.277h34.216v-4.277c0-5.667-11.441-8.554-17.108-8.554z" fill="none" stroke="currentColor" stroke-width="2"/><path d="M32.695 1.008h-2.424v5.6h1.3V5.064h1.124c1.5 0 2.432-.776 2.432-2.024s-.936-2.032-2.432-2.032zm-.072 3h-1.056V2.064h1.056c.792 0 1.192.36 1.192.976s-.4.968-1.192.968zm8.384 2.6l-1.256-1.8a1.821 1.821 0 001.156-1.768c0-1.256-.94-2.032-2.436-2.032h-2.424v5.6h1.3v-1.56h1.188l1.08 1.56zM39.591 3.04c0 .608-.4.976-1.192.976h-1.056V2.064h1.056c.792 0 1.192.36 1.192.976zm5.048 3.668a2.9 2.9 0 003.068-2.9 2.9 2.9 0 00-3.064-2.9 2.9 2.9 0 00-3.064 2.9 2.9 2.9 0 003.06 2.9zm0-1.1a1.708 1.708 0 01-1.752-1.8 1.708 1.708 0 011.752-1.792 1.708 1.708 0 011.752 1.792A1.708 1.708 0 0144.639 5.6z" fill="currentColor"/></symbol>`]);class Qo extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onElectronTabOpen=({tab:e})=>{this._onTabClick(e)},this._onTabClick=e=>{C().model.state.sidebar.selectedTabId!==e&&m().gaController.sendEvent("user",`sidebar:open-${e}`),C().transaction((t=>{t.sidebar.selectedTabId===e?t.sidebar.isOpen=!t.sidebar.isOpen:(t.sidebar.isOpen=!0,t.sidebar.selectedTabId=e,t.tagAssist.shown=!1,t.coverAssist.shown=!1)})),"logo"===this.props.selectedTabId&&Yo.dispatch()},this._onSidePanelCloseClick=()=>{C().transaction((e=>{e.sidebar.isOpen=!1})),"logo"===this.props.selectedTabId&&Yo.dispatch()},this._onClosed=()=>{C().transaction((e=>{e.sidebar.isOpen=!1,e.sidebar.selectedTabId=null}))},this._onExpandClick=()=>{na.toggleTab("bulk")},t}componentDidMount(){window.electron&&window.electron.addExtensionListener("sidebar-mediator.open-tab",this._onElectronTabOpen)}componentWillUnmount(){window.electron&&window.electron.removeExtensionListener("sidebar-mediator.open-tab",this._onElectronTabOpen)}render(){return Glamor.createElement(p().default.Sidebar,{open:this.props.isOpen,selectedTabId:this.props.selectedTabId,logoTab:this._getLogoTab(),menu:this._getMenu(),sidePanel:this._getSidePanel(),bodyPanel:this._getBodyPanel(),onTabClick:this._onTabClick,onSidePanelCloseClick:this._onSidePanelCloseClick,onClosed:this._onClosed,onExpandClick:this._getOnExpandClick(),onBodyPanelClosed:this._onBodyPanelClosed,onLogoLongPress:this._onLogoLongPress})}_getLogoTab(){return{svgIcon:"igswiss.logo",withMarker:this.props.withWhatsNewMarker,withProSticker:this.props.hasPro}}_getMenu(){const e=b().stateProxy.hasProPaid("inssist-pro-infinite")?"an infinite":b().stateProxy.hasProPaid("inssist-pro-lifetime")?"a lifetime":b().stateProxy.hasProPaid("inssist-pro-monthly")?"a monthly":"";return{disabled:!this.props.loggedIn,tabs:[{id:"tab-dm",svgIcon:Jo.dm,title:"Direct Messages",features:["send messages","filter chats","ghost mode, peek at photos"],badgeText:this.props.dm.badge},{id:"tab-scheduling",svgIcon:Jo.schedule,title:"Post Assistant",features:["grid planner, bulk upload","post carousels","schedule with auto-post"]},{id:"tab-tag-assist",svgIcon:Jo.hashtags,title:"Hashtag Assistant",features:["manage hashtag collections","find effective hashtags","create hashtag ladders"]},{id:"tab-billing",title:"PRO Version",iconStyle:{position:"relative",left:-1},...this.props.hasProPaid?{svgIcon:Jo.billing,features:["access to all advanced features",`enabled with ${e} plan`,"thank you 😘"]}:{svgIcon:Jo.billing,iconStyle:{position:"relative",left:-1},features:["access to all advanced features","from $7.90 / month","support development"]}}].filter(Boolean)}}_getSidePanel(){let e,t=!1,s=null;const a=this.props.selectedTabId;"logo"===a?e=Glamor.createElement(jo,null):"tab-dm"===a?s=740:"tab-tag-assist"===a?e=Glamor.createElement(Kt,null):"tab-scheduling"===a?this.props.schedule.showFallback?(t=!0,e=null):(t=this.props.schedule.showTagAssist||this.props.schedule.showBulkScreen,e=Glamor.createElement($a,null)):"tab-billing"===a&&(t=!0,e=null);const n=this.props.loggedIn&&Glamor.createElement("div",{css:Ko(this)},Glamor.createElement(qn,null));return{width:s,hidden:t,content:Glamor.createElement(g().default.Fragment,null,e,n),hideCloseButton:"tab-billing"===a||"tab-scheduling"===a||"tab-tag-assist"===a}}_getBodyPanel(){const e=this.props,t=e.selectedTabId;let s=!1,a=null;"tab-scheduling"===t?s=e.schedule.showBody||e.schedule.showFallback:"tab-billing"===t&&(s=!0,a=Glamor.createElement(lt,null));const n=this.props.loggedIn&&Glamor.createElement("div",{css:Zo(this)},Glamor.createElement(sn,null));return{open:s,content:Glamor.createElement(g().default.Fragment,null,a,n)}}_getOnExpandClick(){return"tab-scheduling"!==this.props.selectedTabId||this.props.schedule.showSetupPanel?null:this._onExpandClick}}var Xo=C().influx((e=>({loggedIn:e.authStatus.isLoggedIn,selectedTabId:e.sidebar.selectedTabId,withWhatsNewMarker:e.whatsNew.some((e=>!e.acknowledged)),hasPro:b().stateProxy.hasPro(),hasProPaid:b().stateProxy.hasProPaid(),hasAllFeatures:b().stateProxy.hasPro({feature:"*"}),schedule:{showBody:e.schedule.navigation.isOpen,showFallback:e.schedule.fallback.isEnabled,showTagAssist:e.schedule.showTagAssist,showBulkScreen:"bulk"===e.schedule.navigation.selectedTabId&&e.schedule.navigation.isOpen,showSetupPanel:e.schedule.fcsSetup.showPanel},dm:{badge:e.dm.badgeText}})))(Qo);g(),p(),C();class ei extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onLetsGoClick=()=>{C().transaction((e=>{e.welcome.shown=!1}))},t}render(){return Glamor.createElement(p().default.Welcome,{title:"Instagram Assistant",description:Glamor.createElement(g().default.Fragment,null,"Inssist is your personal Instagram Assistant and is the best way to use ",Glamor.createElement("b",null,"Instagram on Desktop"),", ads free:"),listItems:[Glamor.createElement(g().default.Fragment,null,"Post photos, videos, IGTVs, stories, reels. Send DMs."),Glamor.createElement(g().default.Fragment,null,"Schedule posts, videos and carousels to be published automatically. Calendar and time slots included."),Glamor.createElement(g().default.Fragment,null,"Get relevant hashtag suggestions and manage hashtag collections. Select custom video covers.")],buttonLabel:"OK, LET'S GO",onButtonClick:this._onLetsGoClick,disclaimer:Glamor.createElement(g().default.Fragment,null,"Disclaimer: this app is not endorsed or certified by Instagram™. All Instagram™ logos and trademarks displayed on this app are property of third parties. Inssist is distributed AS IS. By using Inssist you agree to the Inssist terms of service found here: ",Glamor.createElement("a",{href:"https://inssist.com/terms"},"https://inssist.com/terms"),".",Glamor.createElement("br",null),Glamor.createElement("br",null),Glamor.createElement("b",null,"We do not use or sell your data. Inssist is ads free."))})}}C(),f(),m(),b(),g(),p();const ti=e=>({...g().default.text.nowrap,opacity:0,pointerEvents:"none",...e.showTosSummary&&{opacity:1,pointerEvents:"inherit"}}),si=(e,t)=>({...g().default.absolute(". 0 31 ."),...g().default.transition.fast,width:406,opacity:0,transform:"translateY(20px)",pointerEvents:"none",...e.showTosSummary&&t.panelShown&&{opacity:1,transform:"none",pointerEvents:"inherit"}});class ai extends g().default.Component{constructor(e){super(e),this._onButtonClick=()=>{this.setState({panelShown:!this.state.panelShown})},this._onClose=()=>{m().gaController.sendEvent("user","tos-summary:close-click"),b().actions.acknowledge.dispatch("tosSummary")},this._onOkClick=()=>{m().gaController.sendEvent("user","tos-summary:ok-click"),b().actions.acknowledge.dispatch("tosSummary")},this._onFullTermsClick=()=>{m().gaController.sendEvent("user","tos-summary:terms-click"),chrome.tabs.create({url:f().common.termsUrl})},this._onPrivacyPolicyClick=()=>{m().gaController.sendEvent("user","tos-summary:privacy-click"),chrome.tabs.create({url:f().common.policyUrl})},this._onFaqClick=()=>{m().gaController.sendEvent("user","tos-summary:faq-click"),chrome.tabs.create({url:f().common.faqUrl})},this.state={panelShown:!1}}componentDidUpdate(e){!e.showTosSummary&&this.props.showTosSummary&&m().gaController.sendEvent("user","tos-summary:shown")}render(){return Glamor.createElement(g().default.Fragment,null,Glamor.createElement("div",{css:ti(this.props)},Glamor.createElement(g().default.LinkButton,{label:"TOS & PRIVACY",color:g().default.color.textPassive,small:!0,onClick:this._onButtonClick})),Glamor.createElement("div",{css:si(this.props,this.state)},Glamor.createElement(p().default.TosSummary,{onClose:this._onClose,onOkClick:this._onOkClick,onFullTermsClick:this._onFullTermsClick,onPrivacyPolicyClick:this._onPrivacyPolicyClick,onFaqClick:this._onFaqClick})))}}var ni=C().influx((e=>({showTosSummary:-1===e.acknowledged.tosSummary})))(ai);g(),p(),C(),m(),de(),v();const oi="ig-buttons-mediator.back",ii="ig-buttons-mediator.refresh",ri="ig-buttons-mediator.fullscreen-enter",li="ig-buttons-mediator.fullscreen-exit",ci="ig-buttons-mediator.switch-to-day",di="ig-buttons-mediator.switch-to-night",ui="ig-buttons-mediator.zen",hi="ig-buttons-mediator.zen-on";g().default.SvgIcon.registerSvgIcons([`<symbol id="${oi}" viewBox="0 0 40 40"><path fill="none" d="M0 0h40v40H0z"/><path d="M15.125 19.846l9.1-9.1-1.385-1.384-9.644 9.644a1.2 1.2 0 0 0 0 1.681l9.635 9.634 1.385-1.384z" fill="currentColor"/></symbol>`,`<symbol id="${ii}" viewBox="0 0 40 40"><path fill="none" d="M0 0h40v40H0z"/><path d="M30.378 18.7a.82.82 0 1 0-1.618.258v.015a9.022 9.022 0 1 1-2.24-4.582L22.896 15.6l.518 1.555 4.917-1.639a.82.82 0 0 0 .561-.778V9.819h-1.64v2.994a10.546 10.546 0 1 0 3.126 5.887z" fill="currentColor"/></symbol>`,`<symbol id="${ri}" viewBox="0 0 40 40"><path fill="none" d="M0 0h40v40H0z"/><path d="M28.163 26.952l-3.722-3.722-1.211 1.211 3.722 3.722H24.06v1.721h5.824V24.06h-1.721zm-3.722-10.179l3.722-3.725v2.892h1.721v-5.824H24.06v1.721h2.892l-3.722 3.721zm-8.883 6.457l-3.722 3.722V24.06h-1.72v5.824h5.824v-1.721h-2.892l3.725-3.722zm.382-11.393v-1.721h-5.824v5.824h1.721v-2.892l3.721 3.725 1.215-1.215-3.725-3.721z" fill="currentColor"/></symbol>`,`<symbol id="${li}" viewBox="0 0 40 40"><path fill="none" d="M0 0h40v40H0z"/><path d="M24.951 26.162l3.722 3.722 1.211-1.211-3.722-3.722h2.892V23.23H23.23v5.824h1.721zm3.722-16.046l-3.722 3.725v-2.892H23.23v5.824h5.824v-1.721h-2.892l3.722-3.721zM11.332 29.884l3.722-3.722v2.892h1.72V23.23H10.95v1.721h2.892l-3.725 3.722zm-.382-14.832v1.721h5.824v-5.824h-1.721v2.892l-3.721-3.725-1.215 1.215 3.725 3.721z" fill="currentColor"/></symbol>`,`<symbol id="${ci}" viewBox="0 0 40 40"><g transform="translate(3444 7623)"><rect width="40" height="40" transform="translate(-3444 -7623)" fill="none"/><path d="M11.166,20.406h3.118l-1.561,5.045ZM7.535,18.6l2.7,1.56L6.36,23.745Zm7.811,1.515,2.673-1.606,1.259,5.129Zm-9.2-7.347a6.622,6.622,0,1,1,6.621,6.529A6.576,6.576,0,0,1,6.14,12.766Zm-.8,2.579,1.607,2.673L1.816,19.277ZM18.6,17.917l1.56-2.7,3.588,3.875Zm1.81-6.75,5.045,1.561-5.045,1.558ZM0,12.723l5.045-1.557v3.118ZM1.707,6.36,6.855,7.534l-1.56,2.7Zm16.8,1.074,5.129-1.261-3.524,3.933ZM6.174,1.816l3.932,3.522L7.434,6.945Zm9.042,3.479,3.875-3.589L17.917,6.854Zm-4.049-.25L12.727,0l1.557,5.045Z" transform="translate(-3436.759 -7615.715)" fill="currentColor"/></g></symbol>`,`<symbol id="${di}" viewBox="0 0 40 40"><g transform="translate(3380 7623)"><rect width="40" height="40" transform="translate(-3380 -7623)" fill="none"/><g transform="translate(-3372.822 -7615.724)"><path d="M10.518,0a10.077,10.077,0,0,0-1.3.082A10.511,10.511,0,1,0,10.518,0ZM2.63,10.518A7.9,7.9,0,0,1,7.4,3.273a10.52,10.52,0,0,0,7.556,13.771A7.89,7.89,0,0,1,2.63,10.518Z" transform="translate(2.25 2.25)" fill="currentColor"/></g></g></symbol>`,`<symbol id="${ui}" viewBox="0 0 24.512 18.248"><path d="M24.3 14.632a8.813 8.813 0 00-2.357-1.69 9.42 9.42 0 002.271-4.292.719.719 0 00-.548-.7 9.941 9.941 0 00-3.588-.277c.044-.224.082-.449.112-.677a10.525 10.525 0 00-.27-4.118.718.718 0 00-.88-.508 10.6 10.6 0 00-3.729 1.848A10.866 10.866 0 0012.763.207a.719.719 0 00-1.016 0A10.866 10.866 0 009.2 4.222a10.6 10.6 0 00-3.729-1.848.718.718 0 00-.879.508 10.527 10.527 0 00-.158 4.798 9.941 9.941 0 00-3.586.276.719.719 0 00-.551.7 9.355 9.355 0 002.271 4.292A8.811 8.811 0 00.21 14.632a.718.718 0 000 1.016 8.877 8.877 0 0012.045.47 8.877 8.877 0 0012.031-.456.718.718 0 00.015-1.03zm-4.64-5.45a8.509 8.509 0 012.915 0 8.478 8.478 0 01-7.5 5.545 10.579 10.579 0 004.587-5.547zm-17.727 0a8.51 8.51 0 012.915 0 10.58 10.58 0 004.582 5.545 8.477 8.477 0 01-7.5-5.545zm4.552 7.629a7.383 7.383 0 01-4.7-1.672A7.322 7.322 0 013.7 14.007a9.9 9.9 0 005.826 2.159 7.42 7.42 0 01-3.043.646zm.4-6.624a9.15 9.15 0 01-1.077-6.2 9.171 9.171 0 012.96 1.746 10.921 10.921 0 001.249 7.677 9.122 9.122 0 01-3.125-3.222zm5.364 3.9a9.482 9.482 0 010-12.309 9.482 9.482 0 010 12.309zm3.705-6.155a10.931 10.931 0 00-.224-2.2A9.171 9.171 0 0118.7 3.98a9.143 9.143 0 01-4.21 9.423 10.9 10.9 0 001.471-5.474zm2.064 8.882a7.419 7.419 0 01-3.043-.646 9.9 9.9 0 005.826-2.159 7.326 7.326 0 011.917 1.133 7.383 7.383 0 01-4.693 1.67z" fill="currentColor"/></symbol>`]),g().default.Image.registerImages({[hi]:"lotus.png:24.49:18.24"});class mi extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onBackClick=()=>{m().gaController.sendEvent("user","control:back-click"),v().iframeBus.send("ig.back")},this._onRefreshClick=()=>{m().gaController.sendEvent("user","control:refresh-click"),v().iframeBus.send("ig.refresh")},this._onFullscreenClick=()=>{const e=this.props.isFullscreen?"fullscreen:exit":"fullscreen:enter";C().transaction((e=>{e.igView.fullscreen=!e.igView.fullscreen})),m().gaController.sendEvent("user",e),v().iframeBus.send("ig.widescreen-toggled")},this._onToggleThemeClick=()=>{g().default.theme.toggleTheme()},this._onToggleZenClick=()=>{Kn.toggleZenMode()},t}render(){return Glamor.createElement(p().default.IgButtons,{isHorizontal:this.props.isHorizontal,buttons:[{id:"back",icon:oi,tooltip:{title:"GO BACK"},onClick:this._onBackClick},{id:"refresh",icon:ii,tooltip:{title:"REFRESH"},onClick:this._onRefreshClick,onLongPress:()=>{de().resetController.reset(),location.reload()}},{id:"widescreen",icon:this.props.isFullscreen?li:ri,tooltip:{title:"TOGGLE WIDESCREEN"},onClick:this._onFullscreenClick},{id:"theme",icon:"night"===this.state.theme?ci:di,tooltip:{title:"night"===this.state.theme?"GO LIGHT":"GO DARK"},onClick:this._onToggleThemeClick},{id:"zen",icon:this.props.zenModeEnabled?null:ui,image:this.props.zenModeEnabled?hi:null,tooltip:{title:"ZEN MODE",text:Glamor.createElement(g().default.Fragment,null,"Switch your Instagram home feed",Glamor.createElement("br",null),"to a distraction free mode (PRO)")},onClick:this._onToggleZenClick}]})}}var gi=C().influx((e=>({isFullscreen:e.igView.fullscreen,zenModeEnabled:e.zen.enabled})))(g().default.theme.ThemeAware(mi));g(),p(),x(),m(),v(),S(),C();const pi=({state:e})=>({...e.disableHover&&{pointerEvents:"none !important","& *":{pointerEvents:"none !important"}}});class fi extends g().default.Component{constructor(e){super(e),Ci.call(this),this.state={loggedInStatus:null,disableHover:!1}}componentDidMount(){S().chromeBus.on("auth.refreshed",this._dropLoggedInStatus),v().iframeBus.on("ig.ready",this._dropDisableHover)}componentWillUnmount(){S().chromeBus.off("auth.refreshed",this._dropLoggedInStatus),v().iframeBus.off("ig.ready",this._dropDisableHover)}render(){const e=this.props;return e.hidden?null:Glamor.createElement(p().default.AccountSwitcher,{style:pi(this),accounts:e.accounts.map((t=>{const s=t.userId===e.selectedUserId&&!e.addingNewAccount;let a=!0;return s&&(a=null===this.state.loggedInStatus?e.loggedIn:this.state.loggedInStatus),{id:t.userId,name:`@${t.username}`,avatarUrl:t.avatarUrl,selected:s,loggedIn:a}})),backgroundColor:this.props.backgroundColor,addingNewAccount:this.props.addingNewAccount,onSwitchAccountClick:this._onSwitchAccountClick,onAddAccountClick:this._onAddAccountClick,onDisconnectAccountClick:this._onDisconnectAccountClick})}async _logout(){this.setState({loggedInStatus:!1}),S().chromeBus.send("auth.logout")}async _login(e){this.setState({loggedInStatus:!0}),S().chromeBus.send("auth.login",e)}_alertScheduleSaving(){alert("Inssist is saving changed to Scheduled Posts.Please wait for the save to complete before switching accounts.")}}var Ci=function(){this._onSwitchAccountClick=async e=>{if(this.props.scheduleIsSaving)return void this._alertScheduleSaving();const t=this.props,s=t.accounts.find((t=>t.userId===e));if(this.setState({disableHover:!0}),m().gaController.sendEvent("user","multiaccount:switch"),C().transaction((t=>{t.multiaccount.addingNewAccount=!1,t.multiaccount.selectedUserId=e})),t.loggedIn){const e=await v().iframeBus.send("ig.get-url"),a=e.split("/")[1].split("?")[0];if(a===t.accounts.find((e=>e.userId===t.selectedUserId)).username){const t=e.replace(a,s.username);await S().chromeBus.send("auth.set-ig-initial-url",t)}}this._login(e)},this._onAddAccountClick=async()=>{this.props.scheduleIsSaving?this._alertScheduleSaving():(this.setState({disableHover:!0}),C().transaction((e=>{e.multiaccount.addingNewAccount=!0})),this._logout())},this._onDisconnectAccountClick=e=>{if(this.props.scheduleIsSaving)return void this._alertScheduleSaving();const t=this.props.selectedUserId===e;if(t&&this.props.loggedIn)return C().transaction((e=>{e.authStatus.cookies.igSessionId=null})),this.setState({disableHover:!0}),void this._logout();let s;C().transaction((t=>{const a=t.multiaccount.userIds;x().default(a,e),s=a[a.length-1]||null})),t&&s&&(C().transaction((e=>{e.multiaccount.selectedUserId=s})),this.setState({loggedInStatus:!0}),this.setState({disableHover:!0}),this._login(s))},this._dropLoggedInStatus=()=>{this.setState({loggedInStatus:null})},this._dropDisableHover=()=>{this.setState({disableHover:!1})}},vi=C().influx((e=>({hidden:e.welcome.shown,loggedIn:e.authStatus.isLoggedIn,selectedUserId:e.multiaccount.selectedUserId,addingNewAccount:e.multiaccount.addingNewAccount,scheduleIsSaving:na.isSaving(),accounts:e.multiaccount.userIds.map((t=>{const s=e.userStates[t]||e;if(!s.authStatus.isLoggedIn)return null;if(s.authStatus.userId!==t)return null;const a=s.authStatus;return{userId:a.userId,username:a.username,avatarUrl:a.avatarUrl}})).filter(Boolean)})))(fi);g(),p(),A(),_(),b(),C();class bi extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onSendEmailClick=e=>{const t=A().default(`${_().env.options.apiUrl}/promo`,{username:C().model.state.authStatus.username,email:e});fetch(t)},this._onOkClick=()=>{this._acknowledge()},this._onCancelSubscriptionClick=()=>{this._acknowledge(),chrome.tabs.create({url:"https://slashed.onfastspring.com/account",active:!0})},t}render(){return this.props.show?Glamor.createElement(p().default.TheEndOverlay,{showCancelSubscriptionButton:this.props.hasSubscription,onSendEmailClick:this._onSendEmailClick,onOkClick:this._onOkClick,onCancelSubscriptionClick:this._onCancelSubscriptionClick}):null}_acknowledge(){C().transaction((e=>{e.acknowledged.theEnd=Date.now()}))}}var ki=C().influx((e=>({show:!e.acknowledged.theEnd||-1===e.acknowledged.theEnd,hasSubscription:b().stateProxy.hasProPaid("inssist-pro-monthly")})))(bi);g(),p(),g(),p(),C(),m(),R();class wi extends g().default.Component{constructor(...e){var t;return t=super(...e),this._onActionBlockCloseClick=()=>{m().gaController.sendEvent("user","action-block:close-click"),C().transaction((e=>{e.igTask.actionBlockCode=null}))},t}render(){const{code:e}=this.props;let t=Boolean(e),s=null;return e===R().ec.missingPost||e===R().ec.notFound?t=!1:s=e===R().ec.suspended?["Instagram has blocked this action, probably because it might think you are mass liking / following people.","Please re-login to Instagram.com to refresh the session and let your account rest for some time."]:e===R().ec.tooManyRequests?["Instagram has refused this action: too many like or follow actions were made recently.","Please give it some time to rest before trying again."]:e===R().ec.noNetwork?["Can not reach Instagram server. Please check Internet connection."]:e===R().ec.timedOut?["Server connection has timed out or Instagram server is not responding.","Please try again later or check or Internet connection."]:e===R().ec.redirectToLogin?["Instagram session expired. Please re-login to Instagram."]:e===R().ec.missingUser?["Liked or followed user account is no longer found on Instagram."]:e===R().ec.forbidden?["Instagram session expired. Please re-login to Instagram."]:e===R().ec.serverIsDown||e===R().ec.badGateway||e===R().ec.serviceUnavailable?["Instagram server is not responding. Please check Internet connection and try again later when Instagram is back online."]:["Instagram refused to perform this action. Please try again later."],Glamor.createElement(p().default.SnackbarItem,{id:"action-block-card-mediator",show:t},Glamor.createElement(g().default.InfoCard,{markerColor:g().default.color.error,title:"Oops… Action Blocked",content:s,onClose:this._onActionBlockCloseClick}))}}var Si=C().influx((e=>({code:e.igTask.actionBlockCode})))(wi);class _i extends g().default.Component{render(){return Glamor.createElement(p().default.Snackbar,null,Glamor.createElement(he,null),Glamor.createElement(Si,null),Glamor.createElement(on,null),Glamor.createElement(hn,null),Glamor.createElement(_e,null),Glamor.createElement(Qt,null),Glamor.createElement(dt,null))}}class yi extends g().default.Component{render(){return Glamor.createElement(g().default.Fragment,null,Glamor.createElement(p().default.Layout,{Sidebar:Xo,IgView:Fn,IgButtons:gi,Welcome:ei,Tips:ft,Tos:ni,IgtvUpload:Ee,AccountSwitcher:vi,Snackbar:_i,assistPanel:this._getAssistPanel(),isFullscreen:this.props.isFullscreen,isSidebarOpen:this.props.isSidebarOpen,isWelcomeShown:this.props.isWelcomeShown,isAssistPanelShown:this._isAssistPanelShown(),isExperimentsBarShown:this.props.isExperimentsBarShown,isIgtvUploadShown:this.props.isIgtvUploadShown,igViewFullscreenWidth:this.props.igViewFullscreenWidth,igViewWithBorder:this.props.igViewWithBorder,onBodyWheel:this._onBodyWheel}),Glamor.createElement(g().default.TooltipsContainer,null),Glamor.createElement(cn,null),Glamor.createElement(ki,null))}_getAssistPanel(){return this.props.isTagAssistShown?Glamor.createElement(Yt,null):this.props.isCoverAssistShown?Glamor.createElement(ro,null):null}_isAssistPanelShown(){return this.props.isTagAssistShown||this.props.isCoverAssistShown}_onBodyWheel(e){v().iframeBus.send("ig.broadcast-scroll",e.deltaY)}}var Ti=C().influx((e=>({isFullscreen:e.igView.fullscreen,isSidebarOpen:(e.authStatus.isLoggedIn||"logo"===e.sidebar.selectedTabId)&&e.sidebar.isOpen,isWelcomeShown:e.welcome.shown,isTagAssistShown:e.tagAssist.shown,isCoverAssistShown:e.coverAssist.shown,isExperimentsBarShown:e.experiments.enabled,isIgtvUploadShown:e.igtvUpload.shown,igViewFullscreenWidth:e.igView.fullscreenWidth,igViewWithBorder:e.igView.withBorder})))(yi);g().default.init({_:o().default,pathPrefix:"/img/",images:{"rate-us-heart":"ui-igswiss/rate-us-heart.png:40:40","hex-bug":"ui-igswiss/hex-bug.png:53.47:60.01","hex-zen":"ui-igswiss/hex-zen.png:53.47:60.01","hex-story":"ui-igswiss/hex-story.png:53.47:60.01","hex-carousel":"ui-igswiss/hex-carousel.png:53.47:60.01","hex-multiaccount":"ui-igswiss/hex-multiaccount.png:53.47:60.01","hex-analytics":"ui-igswiss/hex-analytics.png:53.47:60.01","hex-monitor":"ui-igswiss/hex-monitor.png:53.47:60.01","hex-tag":"ui-igswiss/hex-tag.png:53.47:60.01","hex-mentions":"ui-igswiss/hex-mentions.png:53.47:60.01","hex-marker":"ui-igswiss/hex-marker.png:53.47:60.01","hex-video":"ui-igswiss/hex-video.png:53.47:60.01","hex-igtv":"ui-igswiss/hex-igtv.png:53.47:60.01","hex-insights":"ui-igswiss/hex-insights.png:53.47:60.01","hex-igswiss":"ui-igswiss/hex-igswiss.png:53.47:60.01","hex-quality":"ui-igswiss/hex-quality.png:53.47:60.01","hex-update":"ui-igswiss/hex-update.png:53.47:60.01","hex-schedule":"ui-igswiss/hex-schedule.png:53.47:60.01","hex-moon":"ui-igswiss/hex-moon.png:53.47:60.01","hex-dm":"ui-igswiss/hex-dm.png:53.47:60.01","hex-engagement":"ui-igswiss/hex-engagement.png:53.47:60.01","hex-ghost":"ui-igswiss/hex-ghost.png:53.47:60.01","hex-ship":"ui-igswiss/hex-ship.png:53.47:60.01","hex-youtube":"ui-igswiss/hex-youtube.png:53.47:60.01","hex-caption":"ui-igswiss/hex-caption.png:53.47:60.01","hex-swipe-up":"ui-igswiss/hex-swipe-up.png:53.47:60.01","hex-repost":"ui-igswiss/hex-repost.png:53.47:60.01","hex-lifetime":"ui-igswiss/hex-lifetime.png:53.47:60.01","hex-mutual":"ui-igswiss/hex-mutual.png:53.47:60.01","hex-xmas":"ui-igswiss/hex-xmas.png:53.47:60.01","hex-pinterest":"ui-igswiss/hex-pinterest.png:53.47:60.01","hex-tag-ladder":"ui-igswiss/hex-tag-ladder.png:53.47:60.01","hex-reels":"ui-igswiss/hex-reels.png:53.47:60.01","hex-macos":"ui-igswiss/hex-macos.png:53.47:60.01","like-heart-empty":"ui-igswiss/like-heart-empty.svg:20:23","like-heart-full":"ui-igswiss/like-heart-full.svg:20:23","navigate.day":"ui-igswiss/navigate.day.svg:32:32","navigate.night":"ui-igswiss/navigate.night.svg:32:32","start-dm.day":"ui-igswiss/start-dm.day.svg:32:32","start-dm.night":"ui-igswiss/start-dm.night.svg:32:32","add-account-plus":"ui-igswiss/add-account-plus.png:30:30","pro-art-1":"ui-igswiss/pro-art-1.png:471:598"},icons:[]});const Ei=function(){le().render(Glamor.createElement(ce().Provider,{store:C().model.store},Glamor.createElement(Ti,null)),document.getElementById("app"))};var Pi={send:function(e,...t){const s=JSON.stringify({name:e,args:t});console.log(`electron-bus:${s}`)}};var Ai={init:function(){document.body.addEventListener("dblclick",(e=>{e.clientY>40||Pi.send("maximize")}))}};!async function(){window._=o().default,window.Glamor=n(),window.React=a,r().polyfillsController.init(),Io.init(),Ai.init(),await Mo.waitForBackground(),await No.init(),l().logController.init(),c().i18nController.init(),d().abTestingController.init(),u().sentryController.init({dsn:"https://bea0900834f541bca8157710f7fd31fe@sentry.io/1547551"}),Bn.init(),Se.init(),await h().synchController.init("popup",!1),await jn.cleanUpState(),Ro.init(),m().gaController.init().sendPageview(),me.init(),v().iframeBus.init(),fe.init(),Be.init(),es.init(),zo(),xn.init(),na.init(),Hn.init(),mn.init(),Yn.init(),Kn.init(),Xn.init(),ao.init(),lo.init(),Co.init(),wo.init(),ze.init(),Po.init(),On.init(),Fo.init(),Ei(),chrome.runtime.sendMessage({name:"update-user"}),S().chromeBus.send("popup.start"),S().chromeBus.on("popup.log",((...e)=>console.log(...e)))}()}();